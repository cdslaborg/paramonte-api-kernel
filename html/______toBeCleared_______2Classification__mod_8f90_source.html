<!-- HTML header for doxygen 1.8.20-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ParaMonte: D:/Dropbox/Projects/20180101_ParaMonte/git/src/kernel/___toBeCleared___/Classification_mod.f90 Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="html_extra_stylesheet.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><a href="https://www.cdslab.org/paramonte/" target="_blank"><img alt="Logo" src="logo.png"/></a></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ParaMonte
   &#160;<span id="projectnumber">1.5.1</span>
   </div>
   <div id="projectbrief">Plain Powerful Parallel Monte Carlo Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_dc43877d82dd332f9fb2071fcca799d6.html">kernel</a></li><li class="navelem"><a class="el" href="dir_200d6d2a7c1b6e12abae16aabaa5c3fe.html">___toBeCleared___</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle"><div class="title">Classification_mod.f90</div></div>
</div><!--header-->
<div class="contents">
<a href="______toBeCleared_______2Classification__mod_8f90.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno"><a class="line" href="namespaceclassification.html">    1</a></span><span class="keyword">module</span> <a class="code hl_namespace" href="namespaceclassification.html">classification</a></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span> </div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span>  <span class="keywordtype">use </span><a class="code hl_namespace" href="namespaceconstants__mod.html">constants_mod</a>, <span class="keywordtype">only</span>: rk</div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span>  </div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span>  <span class="keywordtype">implicit none</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span>  </div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno"><a class="line" href="namespaceclassification.html#ad55293d0c67cf38c3b75f2af15b2af2e">    7</a></span><span class="keywordtype">  real</span>(rk) :: <a class="code hl_variable" href="namespaceclassification.html#a2a692a4641e0e26b760f96a60b3b21e2">ndkuniform</a>, <a class="code hl_variable" href="namespaceclassification.html#ad55293d0c67cf38c3b75f2af15b2af2e">btfactor</a></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span> </div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span>  <span class="keyword">interface</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span> </div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span>    <span class="keyword">module</span> subroutine getminvolpartition( ncmax, nd, np, stabilizationrequested, maxkvolumelooprecursion &amp;</div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span>                                        , maxallowedkmeansfailure, maxallowedminvolfailure, mahalsqweightexponent &amp;</div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span>                                        , tightness, inclusionfraction, parlogvol, point, ncoptimal, ccenter, csize &amp;</div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span>                                        , cbeinvcovmat, cbecholcov, cbecholdiag, cbevolnormed, cmembership, pointindex &amp;</div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span>                                        , convergencefailurecounter )</div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span>      <span class="keywordtype">integer</span> , <span class="keywordtype">intent(in)</span>    :: ncmax,nd,np                 <span class="comment">! maximum number of clusters, number of dimensions, number of points</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span>      <span class="keywordtype">logical</span> , <span class="keywordtype">intent(in)</span>    :: stabilizationrequested</div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span>      <span class="keywordtype">integer</span> , <span class="keywordtype">intent(in)</span>    :: maxkvolumelooprecursion</div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span>      <span class="keywordtype">integer</span> , <span class="keywordtype">intent(in)</span>    :: maxallowedkmeansfailure</div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span>      <span class="keywordtype">integer</span> , <span class="keywordtype">intent(in)</span>    :: maxallowedminvolfailure</div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="keywordtype">      real</span>(rk), <span class="keywordtype">intent(in)</span>    :: mahalsqweightexponent</div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="keywordtype">      real</span>(rk), <span class="keywordtype">intent(in)</span>    :: tightness                   <span class="comment">! the factor deremining how large the bounding ellipsoid can be, compared to the true volume of the ellipsoid.</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="keywordtype">      real</span>(rk), <span class="keywordtype">intent(in)</span>    :: inclusionfraction           <span class="comment">! the fraction of non-cluster-member points that ARE inside the cluster, to be considered in the estimation of the true volume of the cluster.</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="keywordtype">      real</span>(rk), <span class="keywordtype">intent(in)</span>    :: parlogvol                   <span class="comment">! input log-estimate of the total volume of the points.</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="keywordtype">      real</span>(rk), <span class="keywordtype">intent(inout)</span> :: point(nd,np)                <span class="comment">! the input data (points) to be clustered. on output, it is ordered.</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="keywordtype">      real</span>(rk), <span class="keywordtype">intent(out)</span>   :: ccenter(nd,ncmax)           <span class="comment">! Centers of the clusters (nd,ncMax)</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="keywordtype">      real</span>(rk), <span class="keywordtype">intent(out)</span>   :: cbeinvcovmat(nd,nd,ncmax)   <span class="comment">! CBE: Cluster Bounding Ellipsoid - On output: Full symmetric Inverse Covariance Matrices of the Bounding Ellipsoids of all clusters.</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span><span class="keywordtype">      real</span>(rk), <span class="keywordtype">intent(out)</span>   :: cbecholcov(nd,nd,ncmax)     <span class="comment">! CBE: Cluster Bounding Ellipsoid - On output: The lower triangle contains the Cholesky factor of the covariance matrix of the input points, the upper triangle maybe the CovMat itself (not needed). On output contains in the lower triangle, the Cholesky factor of all clusters found.</span></div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span><span class="keywordtype">      real</span>(rk), <span class="keywordtype">intent(out)</span>   :: cbecholdiag(nd,ncmax)       <span class="comment">! CBE: Cluster Bounding Ellipsoid - On output: The diagonal elements of the Cholesky factor of the covariance matrix of the input points, on output, contains the cholesky factor of all found clusters.</span></div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="keywordtype">      real</span>(rk), <span class="keywordtype">intent(out)</span>   :: cbevolnormed(ncmax)         <span class="comment">! CBE: Cluster Bounding Ellipsoid - On output: Each element of the array contains the volume of the corresponding Cluster Bounding Ellipsoid.</span></div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span>      <span class="keywordtype">integer</span> , <span class="keywordtype">intent(out)</span>   :: ncoptimal                   <span class="comment">! this variable is saved throughout recursive iterations of subroutine</span></div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span>      <span class="keywordtype">integer</span> , <span class="keywordtype">intent(out)</span>   :: csize(ncmax)                <span class="comment">! cluster sizes (nCMax)</span></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span>      <span class="keywordtype">integer</span> , <span class="keywordtype">intent(out)</span>   :: cmembership(np)             <span class="comment">! the CMembership id of each point (representing the cluster number to which the point belongs)</span></div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span>      <span class="keywordtype">integer</span> , <span class="keywordtype">intent(out)</span>   :: pointindex(np)              <span class="comment">! Vector containing the scrambled indices of Point elements. It represent the mapping from the input Point elements to output scrambled Point vector.</span></div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span>      <span class="keywordtype">integer</span> , <span class="keywordtype">intent(inout)</span> :: convergencefailurecounter   <span class="comment">! number of times the algorithm failed to converge.</span></div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span>    <span class="keyword">end subroutine </span>getminvolpartition</div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span> </div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span>    <span class="keyword">module</span> subroutine runkmeans(kpp,nc,nd,np,point,ccenter,csize,cmembership,iteration,zcsiteration)</div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span>      <span class="keywordtype">logical</span> , <span class="keywordtype">intent(in)</span>    :: kpp                   <span class="comment">! if true, initialize kmeans Centers usig kpp algorithm</span></div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span>      <span class="keywordtype">integer</span> , <span class="keywordtype">intent(in)</span>    :: nc, nd, np            <span class="comment">! number of clusters, number of dimensions of each point, number of points</span></div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span><span class="keywordtype">      real</span>(rk), <span class="keywordtype">intent(in)</span>    :: point(nd,np)          <span class="comment">! the input data (points) to be clustered.</span></div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span><span class="keywordtype">      real</span>(rk), <span class="keywordtype">intent(inout)</span> :: ccenter(nd,nc)        <span class="comment">! initial Centers of the clusters</span></div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>      <span class="keywordtype">integer</span> , <span class="keywordtype">intent(out)</span>   :: cmembership(np)       <span class="comment">! the CMembership id of each point (representing the cluster number to which the point belongs)</span></div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>      <span class="keywordtype">integer</span> , <span class="keywordtype">intent(out)</span>   :: zcsiteration          <span class="comment">! Counts the number of times zero sized clusters are found, zcs stands for zero cluster size</span></div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>      <span class="keywordtype">integer</span> , <span class="keywordtype">intent(out)</span>   :: csize(nc)             <span class="comment">! cluster sizes</span></div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>      <span class="keywordtype">integer</span> , <span class="keywordtype">intent(out)</span>   :: iteration</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>    <span class="keyword">end subroutine </span>runkmeans</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span> </div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>  <span class="keyword">end interface</span></div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span> </div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span><span class="keyword">contains</span></div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span> </div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span><span class="comment">!****************************************************************************</span></div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span><span class="comment">!****************************************************************************</span></div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span> </div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span>  <span class="comment">!include &#39;mod_Classification@maxDenPartition.f90&#39;</span></div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>  <span class="comment">!include &#39;mod_Classification_maxDenPartition.f90&#39;</span></div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span> </div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span><span class="comment">!****************************************************************************</span></div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span><span class="comment">!****************************************************************************</span></div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span> </div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>  <span class="comment">!include &#39;mod_Classification_kvolume.f90&#39;</span></div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span> </div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span><span class="comment">!****************************************************************************</span></div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span><span class="comment">!****************************************************************************</span></div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span> </div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>  <span class="comment">!include &#39;mod_Classification_runKvolume.f90&#39;</span></div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span> </div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span><span class="comment">!****************************************************************************</span></div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span><span class="comment">!****************************************************************************</span></div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span> </div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>  <span class="comment">!include &#39;mod_Classification_kUniform.f90&#39;</span></div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span> </div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span><span class="comment">!****************************************************************************</span></div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span><span class="comment">!****************************************************************************</span></div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span> </div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>  <span class="comment">!include &#39;mod_Classification_xmeans.f90&#39;</span></div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span> </div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span><span class="comment">!****************************************************************************</span></div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span><span class="comment">!****************************************************************************</span></div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span> </div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span><span class="keyword">end module </span>Classification</div>
<div class="ttc" id="anamespaceclassification_html"><div class="ttname"><a href="namespaceclassification.html">classification</a></div><div class="ttdef"><b>Definition:</b> <a href="______toBeCleared_______2Classification__mod_8f90_source.html#l00001">Classification_mod.f90:1</a></div></div>
<div class="ttc" id="anamespaceclassification_html_a2a692a4641e0e26b760f96a60b3b21e2"><div class="ttname"><a href="namespaceclassification.html#a2a692a4641e0e26b760f96a60b3b21e2">classification::ndkuniform</a></div><div class="ttdeci">real(rk) ndkuniform</div><div class="ttdef"><b>Definition:</b> <a href="______toBeCleared_______2Classification__mod_8f90_source.html#l00007">Classification_mod.f90:7</a></div></div>
<div class="ttc" id="anamespaceclassification_html_ad55293d0c67cf38c3b75f2af15b2af2e"><div class="ttname"><a href="namespaceclassification.html#ad55293d0c67cf38c3b75f2af15b2af2e">classification::btfactor</a></div><div class="ttdeci">real(rk) btfactor</div><div class="ttdef"><b>Definition:</b> <a href="______toBeCleared_______2Classification__mod_8f90_source.html#l00007">Classification_mod.f90:7</a></div></div>
<div class="ttc" id="anamespaceconstants__mod_html"><div class="ttname"><a href="namespaceconstants__mod.html">constants_mod</a></div><div class="ttdoc">This module contains the mathematical and programming constants.</div><div class="ttdef"><b>Definition:</b> <a href="Constants__mod_8f90_source.html#l00046">Constants_mod.f90:46</a></div></div>
</div><!-- fragment --></div><!-- contents -->
    <!-- start footer part -->
    <hr class="footer"/>
    <div style="text-align:center">
        <p>
            <a href="https://www.cdslab.org/paramonte"><b>ParaMonte: Plain Powerful Parallel Monte Carlo Library</b></a>&nbsp;
            &copy; Copyright 2020, <a href="https://www.cdslab.org" target="_blank"><b>The Computational Data Science Lab</b></a>
            <br/>
        </p>
    </div>
    <address class="footer">
        <small>
            Generated on Thu Aug 19 2021 18:26:39 for ParaMonte by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a>
            <!--
            1.9.2
            -->
        </small>
    </address>
    <!-- Start of statc -->
    <div style="color: #ffffff; float: none; width: 100%;">
        <span style="font-size:0.8em">
        <!--visitor count: -->
            <script type="text/javascript">
                var sc_project=12178963; 
                var sc_invisible=1; 
                var sc_security="e0dfe0f9"; 
                var sc_text=3; 
                var scJsHost = "https://";
                document.write("<sc"+"ript type='text/javascript' src='" +
                scJsHost+
                "statcounter.com/counter/counter.js'></"+"script>");
            </script>
        </span>
    </div>
</body>
</html>
