\hypertarget{namespaceFitGeoCyclic__mod}{}\doxysection{Fit\+Geo\+Cyclic\+\_\+mod Module Reference}
\label{namespaceFitGeoCyclic__mod}\index{FitGeoCyclic\_mod@{FitGeoCyclic\_mod}}


This module contains the classes and procedures for fitting a Cyclic Geometric distribution.  


\doxysubsection*{Data Types}
\begin{DoxyCompactItemize}
\item 
type \mbox{\hyperlink{structFitGeoCyclic__mod_1_1FitGeoCyclic__type}{Fit\+Geo\+Cyclic\+\_\+type}}
\end{DoxyCompactItemize}
\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
type(\mbox{\hyperlink{structOptimization__mod_1_1PowellMinimum__type}{Powell\+Minimum\+\_\+type}}) function \mbox{\hyperlink{namespaceFitGeoCyclic__mod_a1c31498edcd69664be787f9942aaecea}{fit\+Geo\+Cyclic\+Log\+PDF}} (max\+Num\+Trial, num\+Trial, Success\+Step, Log\+Count)
\begin{DoxyCompactList}\small\item\em Return a fit of the Cyclic Geometric distribution PDF to the input natural logarithm of a sequence of Counts, the {\ttfamily i}th element of which represents the number of successes after {\ttfamily Success\+Step(i)} tries in a Bernoulli trail. \end{DoxyCompactList}\item 
pure real(RK) function \mbox{\hyperlink{namespaceFitGeoCyclic__mod_a2bc7f171d922a5311da63e9ea3ad1603}{get\+Sum\+Dist\+Sq}} (ndim, success\+Prob\+Fisher\+Trans\+Norm\+Fac)
\begin{DoxyCompactList}\small\item\em Return the sum of the distances squared from the current fit. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
character(len= $\ast$), parameter \mbox{\hyperlink{namespaceFitGeoCyclic__mod_aa7d34001ef02efd26e2f066962663d27}{MODULE\+\_\+\+NAME}} = \char`\"{}@Fit\+Geo\+Cyclic\+\_\+mod\char`\"{}
\item 
integer(IK) \mbox{\hyperlink{namespaceFitGeoCyclic__mod_ae82f9e8209f4d85363b28cd9ff3ccefb}{num\+Trial\+\_\+\+WSL}}
\begin{DoxyCompactList}\small\item\em This madness bypasses the Microsoft Subsystem for Linux Internal Function call GFortran Segmentation Fault error. \end{DoxyCompactList}\item 
integer(IK) \mbox{\hyperlink{namespaceFitGeoCyclic__mod_a00e2e200ce9f6f78003d98d869071d6a}{max\+Num\+Trial\+\_\+\+WSL}}
\begin{DoxyCompactList}\small\item\em This madness bypasses the Microsoft Subsystem for Linux Internal Function call GFortran Segmentation Fault error. \end{DoxyCompactList}\item 
integer(IK), dimension(\+:), allocatable \mbox{\hyperlink{namespaceFitGeoCyclic__mod_a98891b503c55b3755649964cf3174cbc}{Success\+Step\+\_\+\+WSL}}
\begin{DoxyCompactList}\small\item\em This madness bypasses the Microsoft Subsystem for Linux Internal Function call GFortran Segmentation Fault error. \end{DoxyCompactList}\item 
real(RK), dimension(\+:), allocatable \mbox{\hyperlink{namespaceFitGeoCyclic__mod_ac9b811c9b7c7af11cdb117e4577d8cba}{Log\+Count\+\_\+\+WSL}}
\begin{DoxyCompactList}\small\item\em This madness bypasses the Microsoft Subsystem for Linux Internal Function call GFortran Segmentation Fault error. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
This module contains the classes and procedures for fitting a Cyclic Geometric distribution. 

\begin{DoxyAuthor}{Author}
Amir Shahmoradi 
\end{DoxyAuthor}


\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespaceFitGeoCyclic__mod_a1c31498edcd69664be787f9942aaecea}\label{namespaceFitGeoCyclic__mod_a1c31498edcd69664be787f9942aaecea}} 
\index{FitGeoCyclic\_mod@{FitGeoCyclic\_mod}!fitGeoCyclicLogPDF@{fitGeoCyclicLogPDF}}
\index{fitGeoCyclicLogPDF@{fitGeoCyclicLogPDF}!FitGeoCyclic\_mod@{FitGeoCyclic\_mod}}
\doxysubsubsection{\texorpdfstring{fitGeoCyclicLogPDF()}{fitGeoCyclicLogPDF()}}
{\footnotesize\ttfamily type(\mbox{\hyperlink{structOptimization__mod_1_1PowellMinimum__type}{Powell\+Minimum\+\_\+type}}) function Fit\+Geo\+Cyclic\+\_\+mod\+::fit\+Geo\+Cyclic\+Log\+PDF (\begin{DoxyParamCaption}\item[{integer(IK)}]{max\+Num\+Trial,  }\item[{integer(IK)}]{num\+Trial,  }\item[{integer(IK)}]{Success\+Step,  }\item[{real(RK)}]{Log\+Count }\end{DoxyParamCaption})}



Return a fit of the Cyclic Geometric distribution PDF to the input natural logarithm of a sequence of Counts, the {\ttfamily i}th element of which represents the number of successes after {\ttfamily Success\+Step(i)} tries in a Bernoulli trail. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em max\+Num\+Trial} & \+: The maximum number of trails possible. After {\ttfamily max\+Num\+Trial} tries, \\
\hline
\mbox{\texttt{ in}}  & {\em num\+Trial} & \+: The length of the array {\ttfamily Success\+Step} and {\ttfamily Log\+Count}. Note that {\ttfamily num\+Trial \texorpdfstring{$<$}{<} max\+Num\+Trial} must hold. \\
\hline
\mbox{\texttt{ in}}  & {\em Success\+Step} & \+: A vector of length {\ttfamily (1\+:num\+Trial)} of integers that represent the steps at which the Bernoulli successes occur. \\
\hline
\mbox{\texttt{ in}}  & {\em Log\+Count} & \+: A real-\/valued vector of length {\ttfamily (1\+:num\+Trial)} representing the natural logarithms of the counts of success at the corresponding Bernoulli trials specified by elements of {\ttfamily Success\+Step}.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
{\ttfamily Powell\+Minimum} \+: An object of class \mbox{\hyperlink{structOptimization__mod_1_1PowellMinimum__type}{Powell\+Minimum\+\_\+type}} containing the best-\/fit success\+Prob and the normalization constant of the fit in the vector component {\ttfamily xmin}.
\end{DoxyReturn}
\begin{DoxyWarning}{Warning}
Any value of Success\+Step must be an integer numbers between {\ttfamily 1} and {\ttfamily max\+Num\+Trial}. The onus is on the user to ensure this condition holds.
\end{DoxyWarning}
\begin{DoxyRefDesc}{Todo}
\item[\mbox{\hyperlink{todo__todo000002}{Todo}}]Update\+: Amir Shahmoradi, Sunday Nov 29, 2020, 11\+:19 pm, Dallas, TX The current implementation of the objective function relies on the definitions of module variables. Although inefficient and ugly, this was necessary to resolve the viscous Segmentation Fault error that happens with internal function calls on Windows Subsystem for Linux Ubuntu with GFortran. Once this error of unknown origin is resolved, the external module function {\ttfamily \mbox{\hyperlink{namespaceFitGeoCyclic__mod_a2bc7f171d922a5311da63e9ea3ad1603}{get\+Sum\+Dist\+Sq()}}} must be converted back to an internal function within \mbox{\hyperlink{namespaceFitGeoCyclic__mod_a1c31498edcd69664be787f9942aaecea}{fit\+Geo\+Cyclic\+Log\+PDF}} and subsequently, all module variables must be removed. update (Dec 16, 2020)\+: ~\newline
 The source of the error was identified to be a bug in WSL1. This problem is now resolved in WSL2. However, the code will be kept intact for future compatibility with WSL1 and those who still use it.\end{DoxyRefDesc}


\begin{DoxyAuthor}{Author}
Amir Shahmoradi, Monday March 6, 2017, 3\+:22 pm, ICES, The University of Texas at Austin. 
\end{DoxyAuthor}


Definition at line \mbox{\hyperlink{FitGeoCyclic__mod_8f90_source_l00115}{115}} of file \mbox{\hyperlink{FitGeoCyclic__mod_8f90_source}{Fit\+Geo\+Cyclic\+\_\+mod.\+f90}}.

\mbox{\Hypertarget{namespaceFitGeoCyclic__mod_a2bc7f171d922a5311da63e9ea3ad1603}\label{namespaceFitGeoCyclic__mod_a2bc7f171d922a5311da63e9ea3ad1603}} 
\index{FitGeoCyclic\_mod@{FitGeoCyclic\_mod}!getSumDistSq@{getSumDistSq}}
\index{getSumDistSq@{getSumDistSq}!FitGeoCyclic\_mod@{FitGeoCyclic\_mod}}
\doxysubsubsection{\texorpdfstring{getSumDistSq()}{getSumDistSq()}}
{\footnotesize\ttfamily pure real(RK) function Fit\+Geo\+Cyclic\+\_\+mod\+::get\+Sum\+Dist\+Sq (\begin{DoxyParamCaption}\item[{integer(IK), intent(in)}]{ndim,  }\item[{real(RK)}]{success\+Prob\+Fisher\+Trans\+Norm\+Fac }\end{DoxyParamCaption})}



Return the sum of the distances squared from the current fit. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em ndim} & \+: The length of the input vector {\ttfamily success\+Prob\+Fisher\+Trans\+Norm\+Fac}. \\
\hline
\mbox{\texttt{ in}}  & {\em success\+Prob\+Fisher\+Trans\+Norm\+Fac} & \+: The length of the input vector {\ttfamily success\+Prob\+Fisher\+Trans\+Norm\+Fac}.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
{\ttfamily sum\+Dist\+Sq} \+: The sum of distances squared.
\end{DoxyReturn}
\begin{DoxyRemark}{Remarks}
Although {\ttfamily success\+Prob\+Fisher\+Trans\+Norm\+Fac} is a vector on input, it is expected to have a length of one at all times. This is solely to fullfile the interface restrictions of \mbox{\hyperlink{structOptimization__mod_1_1PowellMinimum__type}{Powell\+Minimum\+\_\+type}}. 
\end{DoxyRemark}


Definition at line \mbox{\hyperlink{FitGeoCyclic__mod_8f90_source_l00200}{200}} of file \mbox{\hyperlink{FitGeoCyclic__mod_8f90_source}{Fit\+Geo\+Cyclic\+\_\+mod.\+f90}}.



\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{namespaceFitGeoCyclic__mod_ac9b811c9b7c7af11cdb117e4577d8cba}\label{namespaceFitGeoCyclic__mod_ac9b811c9b7c7af11cdb117e4577d8cba}} 
\index{FitGeoCyclic\_mod@{FitGeoCyclic\_mod}!LogCount\_WSL@{LogCount\_WSL}}
\index{LogCount\_WSL@{LogCount\_WSL}!FitGeoCyclic\_mod@{FitGeoCyclic\_mod}}
\doxysubsubsection{\texorpdfstring{LogCount\_WSL}{LogCount\_WSL}}
{\footnotesize\ttfamily real(RK), dimension(\+:), allocatable Fit\+Geo\+Cyclic\+\_\+mod\+::\+Log\+Count\+\_\+\+WSL}



This madness bypasses the Microsoft Subsystem for Linux Internal Function call GFortran Segmentation Fault error. 



Definition at line \mbox{\hyperlink{FitGeoCyclic__mod_8f90_source_l00064}{64}} of file \mbox{\hyperlink{FitGeoCyclic__mod_8f90_source}{Fit\+Geo\+Cyclic\+\_\+mod.\+f90}}.

\mbox{\Hypertarget{namespaceFitGeoCyclic__mod_a00e2e200ce9f6f78003d98d869071d6a}\label{namespaceFitGeoCyclic__mod_a00e2e200ce9f6f78003d98d869071d6a}} 
\index{FitGeoCyclic\_mod@{FitGeoCyclic\_mod}!maxNumTrial\_WSL@{maxNumTrial\_WSL}}
\index{maxNumTrial\_WSL@{maxNumTrial\_WSL}!FitGeoCyclic\_mod@{FitGeoCyclic\_mod}}
\doxysubsubsection{\texorpdfstring{maxNumTrial\_WSL}{maxNumTrial\_WSL}}
{\footnotesize\ttfamily integer(IK) Fit\+Geo\+Cyclic\+\_\+mod\+::max\+Num\+Trial\+\_\+\+WSL}



This madness bypasses the Microsoft Subsystem for Linux Internal Function call GFortran Segmentation Fault error. 



Definition at line \mbox{\hyperlink{FitGeoCyclic__mod_8f90_source_l00062}{62}} of file \mbox{\hyperlink{FitGeoCyclic__mod_8f90_source}{Fit\+Geo\+Cyclic\+\_\+mod.\+f90}}.

\mbox{\Hypertarget{namespaceFitGeoCyclic__mod_aa7d34001ef02efd26e2f066962663d27}\label{namespaceFitGeoCyclic__mod_aa7d34001ef02efd26e2f066962663d27}} 
\index{FitGeoCyclic\_mod@{FitGeoCyclic\_mod}!MODULE\_NAME@{MODULE\_NAME}}
\index{MODULE\_NAME@{MODULE\_NAME}!FitGeoCyclic\_mod@{FitGeoCyclic\_mod}}
\doxysubsubsection{\texorpdfstring{MODULE\_NAME}{MODULE\_NAME}}
{\footnotesize\ttfamily character(len=$\ast$), parameter Fit\+Geo\+Cyclic\+\_\+mod\+::\+MODULE\+\_\+\+NAME = \char`\"{}@Fit\+Geo\+Cyclic\+\_\+mod\char`\"{}}



Definition at line \mbox{\hyperlink{FitGeoCyclic__mod_8f90_source_l00057}{57}} of file \mbox{\hyperlink{FitGeoCyclic__mod_8f90_source}{Fit\+Geo\+Cyclic\+\_\+mod.\+f90}}.

\mbox{\Hypertarget{namespaceFitGeoCyclic__mod_ae82f9e8209f4d85363b28cd9ff3ccefb}\label{namespaceFitGeoCyclic__mod_ae82f9e8209f4d85363b28cd9ff3ccefb}} 
\index{FitGeoCyclic\_mod@{FitGeoCyclic\_mod}!numTrial\_WSL@{numTrial\_WSL}}
\index{numTrial\_WSL@{numTrial\_WSL}!FitGeoCyclic\_mod@{FitGeoCyclic\_mod}}
\doxysubsubsection{\texorpdfstring{numTrial\_WSL}{numTrial\_WSL}}
{\footnotesize\ttfamily integer(IK) Fit\+Geo\+Cyclic\+\_\+mod\+::num\+Trial\+\_\+\+WSL}



This madness bypasses the Microsoft Subsystem for Linux Internal Function call GFortran Segmentation Fault error. 



Definition at line \mbox{\hyperlink{FitGeoCyclic__mod_8f90_source_l00061}{61}} of file \mbox{\hyperlink{FitGeoCyclic__mod_8f90_source}{Fit\+Geo\+Cyclic\+\_\+mod.\+f90}}.

\mbox{\Hypertarget{namespaceFitGeoCyclic__mod_a98891b503c55b3755649964cf3174cbc}\label{namespaceFitGeoCyclic__mod_a98891b503c55b3755649964cf3174cbc}} 
\index{FitGeoCyclic\_mod@{FitGeoCyclic\_mod}!SuccessStep\_WSL@{SuccessStep\_WSL}}
\index{SuccessStep\_WSL@{SuccessStep\_WSL}!FitGeoCyclic\_mod@{FitGeoCyclic\_mod}}
\doxysubsubsection{\texorpdfstring{SuccessStep\_WSL}{SuccessStep\_WSL}}
{\footnotesize\ttfamily integer(IK), dimension(\+:), allocatable Fit\+Geo\+Cyclic\+\_\+mod\+::\+Success\+Step\+\_\+\+WSL}



This madness bypasses the Microsoft Subsystem for Linux Internal Function call GFortran Segmentation Fault error. 



Definition at line \mbox{\hyperlink{FitGeoCyclic__mod_8f90_source_l00063}{63}} of file \mbox{\hyperlink{FitGeoCyclic__mod_8f90_source}{Fit\+Geo\+Cyclic\+\_\+mod.\+f90}}.

