\hypertarget{Classification__mod_0dKmeans_8f90_source}{}\doxysection{Classification\+\_\+mod@Kmeans.\+f90}
\label{Classification__mod_0dKmeans_8f90_source}\index{D:/Dropbox/Projects/20180101\_ParaMonte/git/src/kernel/\_\_\_toBeCleared\_\_\_/Classification\_mod"@Kmeans.f90@{D:/Dropbox/Projects/20180101\_ParaMonte/git/src/kernel/\_\_\_toBeCleared\_\_\_/Classification\_mod"@Kmeans.f90}}
\mbox{\hyperlink{Classification__mod_0dKmeans_8f90}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00001}00001 submodule(\mbox{\hyperlink{namespaceclassification}{classification}}) kmeans}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00002}00002 }
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00003}00003   \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00004}00004 }
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00005}00005 \textcolor{keyword}{contains}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00006}00006 }
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00007}00007 \textcolor{comment}{!****************************************************************************}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00008}00008 \textcolor{comment}{!****************************************************************************}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00009}00009 }
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00010}00010   \textcolor{comment}{! Amir Shahmoradi, April 03, 2017, 2:16 PM, ICES, UTEXAS}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00011}00011   \textcolor{keyword}{module} subroutine runkmeans(kpp,nc,nd,np,point,ccenter,csize,cmembership,iteration,zcsiteration)}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00012}00012   }
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00013}00013     \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00014}00014     \textcolor{keywordtype}{logical} , \textcolor{keywordtype}{intent(in)}    :: kpp                   \textcolor{comment}{! if true, initialize kmeans Centers usig kpp algorithm}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00015}00015     \textcolor{keywordtype}{integer} , \textcolor{keywordtype}{intent(in)}    :: nc, nd, np            \textcolor{comment}{! number of clusters, number of dimensions of each point, number of points}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00016}00016 \textcolor{keywordtype}{    real}(RK), \textcolor{keywordtype}{intent(in)}    :: Point(nd,np)          \textcolor{comment}{! the input data (points) to be clustered.}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00017}00017 \textcolor{keywordtype}{    real}(RK), \textcolor{keywordtype}{intent(inout)} :: CCenter(nd,nc)        \textcolor{comment}{! initial Centers of the clusters}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00018}00018     \textcolor{keywordtype}{integer} , \textcolor{keywordtype}{intent(out)}   :: CSize(nc)             \textcolor{comment}{! cluster sizes}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00019}00019     \textcolor{keywordtype}{integer} , \textcolor{keywordtype}{intent(out)}   :: CMembership(np)       \textcolor{comment}{! the CMembership id of each point (representing the cluster number to which the point belongs)}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00020}00020     \textcolor{keywordtype}{integer} , \textcolor{keywordtype}{intent(out)}   :: zcsIteration          \textcolor{comment}{! Counts the number of times zero sized clusters are found, zcs stands for zero cluster size}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00021}00021     \textcolor{keywordtype}{integer} , \textcolor{keywordtype}{intent(out)}   :: iteration}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00022}00022 }
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00023}00023 \textcolor{keywordtype}{    real}(RK)                :: DistanceMatrix(nc,np) \textcolor{comment}{! distance of each point ip from cluster ic}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00024}00024 \textcolor{keywordtype}{    real}(RK)                :: NewCenter(nd,nc)      \textcolor{comment}{! new updated Centers of the clusters}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00025}00025 \textcolor{keywordtype}{    real}(RK)                :: CenterDiff(nc)        \textcolor{comment}{! difference between new and old Centers (used as a stopping criterion)}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00026}00026 \textcolor{keywordtype}{    real}(RK), \textcolor{keywordtype}{parameter}     :: tolerance = 1.e-\/6\_rk  \textcolor{comment}{! if the change in all Centers is less than this value, then the algorithm goal is accomplished.}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00027}00027     }
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00028}00028     \textcolor{keywordtype}{integer}                 :: i,j,ip,ic   \textcolor{comment}{! ,minClusterSize}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00029}00029     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{parameter}      :: iterationMax = 1e4    \textcolor{comment}{! maximum number of iterations for kmeans to converge.}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00030}00030     \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{parameter}      :: zcsIterationMax = 1e4 \textcolor{comment}{! maximum number of iterations for kmeans to converge.}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00031}00031     }
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00032}00032     iteration = 0}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00033}00033     zcsiteration = 0}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00034}00034     \textcolor{comment}{!minClusterSize = nd + 1}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00035}00035     }
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00036}00036     \textcolor{keywordflow}{if}(kpp) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00037}00037       \textcolor{keyword}{call }getkppcenter(nc,nd,np,point,ccenter,distancematrix)}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00038}00038       distancematrix = sqrt(distancematrix)}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00039}00039     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00040}00040       \textcolor{keywordflow}{do} ip=1,np}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00041}00041         \textcolor{keywordflow}{do} ic=1,nc}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00042}00042           distancematrix(ic,ip) = norm2( ccenter(1:nd,ic) -\/ point(1:nd,ip) ) \textcolor{comment}{! find distance of point to all cluster Centers.}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00043}00043 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00044}00044 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00045}00045 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00046}00046     }
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00047}00047     centerrefinement: \textcolor{keywordflow}{do} \textcolor{comment}{! until no cluster CCenter changes anymore upon iteration (comparing CMembership ids would be another way worth looking into)}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00048}00048       }
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00049}00049       \textcolor{keywordflow}{if} (iteration>iterationmax) \textcolor{keywordflow}{then}  \textcolor{comment}{! this need improvement for efficiency and function purity.}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00050}00050         \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'iterationMax reached, yet kmeans did not converge'}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00051}00051         \textcolor{keyword}{read}(*,*)}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00052}00052         \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00053}00053 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00054}00054       \textcolor{keywordflow}{if} (zcsiteration>zcsiterationmax) \textcolor{keywordflow}{then}  \textcolor{comment}{! this need improvement for efficiency and function purity.}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00055}00055         \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'zcsIterationMax reached, yet kmeans did not converge'}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00056}00056         \textcolor{keyword}{read}(*,*)}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00057}00057         \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00058}00058 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00059}00059       }
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00060}00060       csize = 0 \textcolor{comment}{! initialize all cluster sizes to zero}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00061}00061       newcenter = 0.\_rk}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00062}00062       }
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00063}00063       \textcolor{keywordflow}{do} ip=1,np    \textcolor{comment}{! update memberships and get the new centers}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00064}00064         cmembership(ip) = minloc( distancematrix(1:nc,ip) , 1 )  \textcolor{comment}{! find the cluster to which the point belongs.}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00065}00065         csize( cmembership(ip) ) = csize( cmembership(ip) ) + 1}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00066}00066         \textcolor{comment}{!write(*,*) CSize( CMembership(ip) )}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00067}00067         newcenter(:,cmembership(ip)) = newcenter(:,cmembership(ip)) + point(:,ip)}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00068}00068 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00069}00069       }
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00070}00070       \textcolor{keywordflow}{if} (any(csize==0)) \textcolor{keywordflow}{then} \textcolor{comment}{! This error handling block has to improved greatly}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00071}00071         zcsiteration = zcsiteration + 1}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00072}00072         \textcolor{keyword}{call }getkppcenter(nc,nd,np,point,ccenter,distancematrix)     \textcolor{comment}{! find new random Centers}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00073}00073         distancematrix = sqrt(distancematrix)}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00074}00074         iteration = 0}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00075}00075         cycle centerrefinement}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00076}00076         \textcolor{comment}{!write(*,*) 'a cluster size is zero!'}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00077}00077         \textcolor{comment}{!write(*,*) CSize}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00078}00078         \textcolor{comment}{!stop}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00079}00079 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00080}00080 }
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00081}00081       \textcolor{keywordflow}{do} ic=1,nc    \textcolor{comment}{! normalize NewCenter values to the cluster sizes, to get the cluster centers.}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00082}00082         newcenter(:,ic) = newcenter(:,ic) / real( csize(ic) , kind=rk )}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00083}00083         centerdiff(ic) = norm2( newcenter(:,ic) -\/ ccenter(:,ic) )}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00084}00084 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00085}00085       }
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00086}00086       ccenter = newcenter}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00087}00087       }
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00088}00088       \textcolor{keywordflow}{if} (any( centerdiff > tolerance )) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00089}00089         iteration = iteration + 1}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00090}00090         \textcolor{keywordflow}{do} ip=1,np  \textcolor{comment}{! get the new distances of each point from all centers}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00091}00091           \textcolor{keywordflow}{do} ic=1,nc}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00092}00092             distancematrix(ic,ip) = norm2( ccenter(:,ic) -\/ point(:,ip) ) \textcolor{comment}{! find distance of Point to all cluster centers.}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00093}00093 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00094}00094 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00095}00095         cycle centerrefinement}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00096}00096       \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00097}00097         \textcolor{keywordflow}{exit} centerrefinement}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00098}00098 \textcolor{keywordflow}{      end if}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00099}00099     }
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00100}00100 \textcolor{keywordflow}{    end do} centerrefinement}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00101}00101 }
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00102}00102   \textcolor{keyword}{end subroutine }runkmeans}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00103}00103 }
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00104}00104 \textcolor{comment}{!****************************************************************************}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00105}00105 \textcolor{comment}{!****************************************************************************}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00106}00106 }
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00107}00107   \textcolor{comment}{! Find nc initial cluster centers for the Kmeans algorithm, using Kmeans++ recipe. }}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00108}00108   \textcolor{keyword}{subroutine }getkppcenter(nc,nd,np,Point,CCenter,distanceSqMatrix)}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00109}00109     \textcolor{keywordtype}{use }\mbox{\hyperlink{namespacestatistics__mod}{statistics\_mod}}, \textcolor{keywordtype}{only}: \mbox{\hyperlink{namespacestatistics__mod_a32bc1c64c03179a6cf9ce25a7fe250da}{getrandint}}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00110}00110     \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00111}00111     \textcolor{keywordtype}{integer}               :: ic, ip, i}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00112}00112     \textcolor{keywordtype}{integer}               :: randomInteger           \textcolor{comment}{! random integer number}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00113}00113     \textcolor{keywordtype}{integer} , \textcolor{keywordtype}{intent(in)}  :: np, nd, nc              \textcolor{comment}{! number of points, number of dimensions of each point, number of clusters}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00114}00114 \textcolor{keywordtype}{    real}(RK), \textcolor{keywordtype}{intent(in)}  :: Point(nd,np)            \textcolor{comment}{! the input data (points) to be clustered.}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00115}00115 \textcolor{keywordtype}{    real}(RK), \textcolor{keywordtype}{intent(out)} :: CCenter(nd,nc)          \textcolor{comment}{! initial centers of the clusters}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00116}00116 \textcolor{keywordtype}{    real}(RK), \textcolor{keywordtype}{intent(out)} :: distanceSqMatrix(nc,np) \textcolor{comment}{! distance squared of each point ip from cluster ic}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00117}00117 \textcolor{keywordtype}{    real}(RK)              :: cumDsq(0:np)            \textcolor{comment}{! sum of distance squared of points up to the given index of the vector.}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00118}00118 \textcolor{keywordtype}{    real}(RK)              :: dummy}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00119}00119     }
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00120}00120     }
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00121}00121     distancesqmatrix = 0.\_rk}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00122}00122     cumdsq(0) = 0.\_rk   \textcolor{comment}{! this is needed for the cumulative addition below. This element must always remain zero.}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00123}00123     }
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00124}00124     ic = 1}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00125}00125     ccenter(1:nd,ic) = point( 1:nd , \mbox{\hyperlink{namespacestatistics__mod_a32bc1c64c03179a6cf9ce25a7fe250da}{getrandint}}(1,np) )   \textcolor{comment}{! perhaps this random assignment is unnecessary}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00126}00126     \textcolor{keywordflow}{do} ip = 1,np}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00127}00127       \textcolor{keywordflow}{do} i = 1,nd}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00128}00128         distancesqmatrix(ic,ip) = distancesqmatrix(ic,ip) + (ccenter(i,ic) -\/ point(i,ip))**2     \textcolor{comment}{! find distance squared of point to \# ic cluster CCenter.}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00129}00129 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00130}00130       cumdsq(ip) = cumdsq(ip-\/1) + distancesqmatrix(ic,ip)}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00131}00131 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00132}00132     cumdsq = cumdsq/cumdsq(np)}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00133}00133     }
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00134}00134     ic = 2}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00135}00135     \textcolor{keyword}{call }random\_number(dummy)}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00136}00136     }
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00137}00137     \textcolor{comment}{! For degbugging:}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00138}00138     ip = minloc(cumdsq,1,mask=cumdsq>dummy) -\/ 1}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00139}00139     \textcolor{keywordflow}{if} (ip>np) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00140}00140       \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Line 673: In subroutine getKppCenter(), ip>np: '}, ip, np}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00141}00141       \textcolor{keyword}{read}(*,*)}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00142}00142 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00143}00143     }
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00144}00144     ccenter(1:nd,ic) = point( 1:nd , minloc(cumdsq,1,mask=cumdsq>dummy)-\/1 )}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00145}00145     \textcolor{keywordflow}{do} ip = 1,np    \textcolor{comment}{! get the distance squares of the second CCenter for output}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00146}00146       \textcolor{keywordflow}{do} i = 1,nd}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00147}00147         distancesqmatrix(ic,ip) = distancesqmatrix(ic,ip) + (ccenter(i,ic) -\/ point(i,ip))**2     \textcolor{comment}{! find distance squared of point to \# ic cluster CCenter.}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00148}00148 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00149}00149 \textcolor{keywordflow}{    end do}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00150}00150     }
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00151}00151     }
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00152}00152     \textcolor{keywordflow}{if} (nc > 2) \textcolor{keywordflow}{then}    \textcolor{comment}{! find the rest of cluster centers}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00153}00153       }
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00154}00154       \textcolor{keywordflow}{do} ic = 3,nc}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00155}00155         \textcolor{keywordflow}{do} ip = 1,np}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00156}00156           cumdsq(ip) = cumdsq(ip-\/1) + minval( distancesqmatrix(1:ic-\/1,ip) )}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00157}00157 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00158}00158         cumdsq = cumdsq/cumdsq(np)}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00159}00159         \textcolor{keyword}{call }random\_number(dummy)}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00160}00160         ip = minloc(cumdsq,1,mask=cumdsq>dummy)-\/1}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00161}00161         \textcolor{comment}{! For degbugging:}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00162}00162         \textcolor{keywordflow}{if} (ip>np) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00163}00163           \textcolor{keyword}{write}(*,*) \textcolor{stringliteral}{'Line 695: In subroutine getKppCenter(), ip>np: '}, ip, np}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00164}00164           \textcolor{keyword}{read}(*,*)}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00165}00165 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00166}00166         ccenter(1:nd,ic) = point( 1:nd , minloc(cumdsq,1,mask=cumdsq>dummy)-\/1 )   \textcolor{comment}{! perhaps this random assignment is unnecessary}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00167}00167         \textcolor{keywordflow}{do} ip = 1,np    \textcolor{comment}{! get the distance squares of the second CCenter for output}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00168}00168           \textcolor{keywordflow}{do} i = 1,nd}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00169}00169               distancesqmatrix(ic,ip) = distancesqmatrix(ic,ip) + (ccenter(i,ic) -\/ point(i,ip))**2     \textcolor{comment}{! find distance squared of point to \# ic cluster CCenter.}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00170}00170 \textcolor{keywordflow}{          end do}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00171}00171 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00172}00172 \textcolor{keywordflow}{      end do}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00173}00173 }
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00174}00174 \textcolor{keywordflow}{    end if}}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00175}00175 }
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00176}00176   \textcolor{keyword}{end subroutine }getkppcenter}
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00177}00177 }
\DoxyCodeLine{\Hypertarget{Classification__mod_0dKmeans_8f90_source_l00178}00178 \textcolor{keyword}{end }submodule Kmeans}

\end{DoxyCode}
