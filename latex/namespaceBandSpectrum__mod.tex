\hypertarget{namespaceBandSpectrum__mod}{}\doxysection{Band\+Spectrum\+\_\+mod Module Reference}
\label{namespaceBandSpectrum__mod}\index{BandSpectrum\_mod@{BandSpectrum\_mod}}


This module contains the procedures for computing the various Band Spectrum properties of GRBs. See Eqn. A6 of \href{https://www.cdslab.org/pubs/2015_Shahmoradi_I.pdf}{\texttt{ Shahmoradi and Nemiroff, 2015, MNRAS, 451\+:4645-\/4662}}.  


\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
pure real(RK) function \mbox{\hyperlink{namespaceBandSpectrum__mod_aacdf6105c20ff72b59c401a5e3de2a5c}{get\+Ebreak}} (epk, alpha, beta)
\begin{DoxyCompactList}\small\item\em Return {\ttfamily epk$\ast$(alpha-\/beta)/(alpha+2)}, which is the normalization factor in the exponent of the first component of the Band model. \end{DoxyCompactList}\item 
pure subroutine \mbox{\hyperlink{namespaceBandSpectrum__mod_ad4f321f7f5a9a79b9dc27ceefe754623}{get\+Band\+Param}} (epk, alpha, beta, ebrk, coef, alpha\+Plus\+Two)
\begin{DoxyCompactList}\small\item\em Compute the break energy {\ttfamily ebrk} of the Band model, as well as the coefficient by which the high energy component of the Band model must be multiplied in order to get a smooth function (assuming the normalization coefficient of the lower energy component is unity). \end{DoxyCompactList}\item 
pure real(RK) function \mbox{\hyperlink{namespaceBandSpectrum__mod_a3b894a1fd2110b1f9009d08d153a4524}{get\+Photon\+Flux}} (energy, epk, alpha, beta, ebrk, coef, alpha\+Plus\+Two)
\begin{DoxyCompactList}\small\item\em Compute the differential photon flux according to the Band differential spectrum at the given input {\ttfamily energy} value. \end{DoxyCompactList}\item 
pure real(RK) function \mbox{\hyperlink{namespaceBandSpectrum__mod_aaddc0780d391a46158e66d33b2d2e7b8}{get\+Photon\+Flux\+Lower}} (energy, alpha, alpha\+Plus\+Two\+Over\+Epk)
\begin{DoxyCompactList}\small\item\em Compute the differential photon flux according to the lower component of the Band spectrum at the given input {\ttfamily energy} value. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceBandSpectrum__mod_ad1fb81977b81a97aca16e68c58337c60}{get\+Photon\+Fluence\+From\+Energy\+Fluence}} (energy\+Fluence, lower\+Lim, upper\+Lim, epk, alpha, beta, tolerance, photon\+Fluence, Err, lower\+Lim\+New, upper\+Lim\+New)
\begin{DoxyCompactList}\small\item\em Convert an {\bfseries{input energy fluence}} in {\ttfamily \mbox{[}lower\+Lim, upper\+Lim\mbox{]}} energy window, all in units of keV (or ALL in some other units), {\bfseries{to photon fluence}}, within the same energy range, or if {\ttfamily \mbox{[}lower\+Lim\+New, upper\+Lim\+New\mbox{]}} is provided, then in that range. The input {\ttfamily tolerance} is passed to integrators as a measure of the desired accuracy for the computation of {\ttfamily photon\+Fluence}. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
character($\ast$), parameter \mbox{\hyperlink{namespaceBandSpectrum__mod_a5f3e1f97e93886d63ee7b5401116497a}{MODULE\+\_\+\+NAME}} = \char`\"{}@Band\+Spectrum\+\_\+mod\char`\"{}
\item 
real(RK), parameter \mbox{\hyperlink{namespaceBandSpectrum__mod_acb4d7db921d9df54a69dd37b058abe3d}{AMPLITUDE\+\_\+\+DEFAULT}} = 1.\+\_\+\+RK
\item 
real(RK), parameter \mbox{\hyperlink{namespaceBandSpectrum__mod_a273925620de54bd626fb2e9810a289b0}{ALPHA\+\_\+\+DEFAULT}} = -\/1.\+1\+\_\+\+RK
\item 
real(RK), parameter \mbox{\hyperlink{namespaceBandSpectrum__mod_a2bff3bf84c2280fc748e04fba6d29d62}{BETA\+\_\+\+DEFAULT}} = -\/2.\+3\+\_\+\+RK
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
This module contains the procedures for computing the various Band Spectrum properties of GRBs. See Eqn. A6 of \href{https://www.cdslab.org/pubs/2015_Shahmoradi_I.pdf}{\texttt{ Shahmoradi and Nemiroff, 2015, MNRAS, 451\+:4645-\/4662}}. 

\begin{DoxyAuthor}{Author}
Amir Shahmoradi, Tuesday April 30, 2019, 12\+:58 PM, SEIR, UTA 
\end{DoxyAuthor}


\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespaceBandSpectrum__mod_ad4f321f7f5a9a79b9dc27ceefe754623}\label{namespaceBandSpectrum__mod_ad4f321f7f5a9a79b9dc27ceefe754623}} 
\index{BandSpectrum\_mod@{BandSpectrum\_mod}!getBandParam@{getBandParam}}
\index{getBandParam@{getBandParam}!BandSpectrum\_mod@{BandSpectrum\_mod}}
\doxysubsubsection{\texorpdfstring{getBandParam()}{getBandParam()}}
{\footnotesize\ttfamily pure subroutine Band\+Spectrum\+\_\+mod\+::get\+Band\+Param (\begin{DoxyParamCaption}\item[{real(RK), intent(in)}]{epk,  }\item[{real(RK), intent(in)}]{alpha,  }\item[{real(RK), intent(in)}]{beta,  }\item[{real(RK), intent(out)}]{ebrk,  }\item[{real(RK), intent(out)}]{coef,  }\item[{real(RK)}]{alpha\+Plus\+Two }\end{DoxyParamCaption})}



Compute the break energy {\ttfamily ebrk} of the Band model, as well as the coefficient by which the high energy component of the Band model must be multiplied in order to get a smooth function (assuming the normalization coefficient of the lower energy component is unity). 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em epk} & \+: The spectral peak energy in units of \mbox{[}keV\mbox{]}. \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & \+: The lower spectral exponent of the Band model. \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & \+: The upper spectral exponent of the Band model. \\
\hline
\mbox{\texttt{ out}}  & {\em ebrk} & \+: The spectral break energy in units of \mbox{[}keV\mbox{]}. \\
\hline
\mbox{\texttt{ out}}  & {\em coef} & \+: The spectral continuity coefficient. \\
\hline
\mbox{\texttt{ out}}  & {\em alpha\+Plus\+Two} & \+: The lower spectral exponent of the Band model plus two. \\
\hline
\end{DoxyParams}


Definition at line \mbox{\hyperlink{BandSpectrum__mod_8f90_source_l00138}{138}} of file \mbox{\hyperlink{BandSpectrum__mod_8f90_source}{Band\+Spectrum\+\_\+mod.\+f90}}.

\mbox{\Hypertarget{namespaceBandSpectrum__mod_aacdf6105c20ff72b59c401a5e3de2a5c}\label{namespaceBandSpectrum__mod_aacdf6105c20ff72b59c401a5e3de2a5c}} 
\index{BandSpectrum\_mod@{BandSpectrum\_mod}!getEbreak@{getEbreak}}
\index{getEbreak@{getEbreak}!BandSpectrum\_mod@{BandSpectrum\_mod}}
\doxysubsubsection{\texorpdfstring{getEbreak()}{getEbreak()}}
{\footnotesize\ttfamily pure real(RK) function Band\+Spectrum\+\_\+mod\+::get\+Ebreak (\begin{DoxyParamCaption}\item[{real(RK), intent(in)}]{epk,  }\item[{real(RK), intent(in), optional}]{alpha,  }\item[{real(RK), intent(in), optional}]{beta }\end{DoxyParamCaption})}



Return {\ttfamily epk$\ast$(alpha-\/beta)/(alpha+2)}, which is the normalization factor in the exponent of the first component of the Band model. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em epk} & \+: The spectral peak energy in units of \mbox{[}keV\mbox{]}. \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & \+: The lower spectral exponent of the Band model. \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & \+: The upper spectral exponent of the Band model.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
{\ttfamily ebrk} \+: The spectral break energy in units of \mbox{[}keV\mbox{]}. 
\end{DoxyReturn}


Definition at line \mbox{\hyperlink{BandSpectrum__mod_8f90_source_l00113}{113}} of file \mbox{\hyperlink{BandSpectrum__mod_8f90_source}{Band\+Spectrum\+\_\+mod.\+f90}}.

\mbox{\Hypertarget{namespaceBandSpectrum__mod_ad1fb81977b81a97aca16e68c58337c60}\label{namespaceBandSpectrum__mod_ad1fb81977b81a97aca16e68c58337c60}} 
\index{BandSpectrum\_mod@{BandSpectrum\_mod}!getPhotonFluenceFromEnergyFluence@{getPhotonFluenceFromEnergyFluence}}
\index{getPhotonFluenceFromEnergyFluence@{getPhotonFluenceFromEnergyFluence}!BandSpectrum\_mod@{BandSpectrum\_mod}}
\doxysubsubsection{\texorpdfstring{getPhotonFluenceFromEnergyFluence()}{getPhotonFluenceFromEnergyFluence()}}
{\footnotesize\ttfamily subroutine Band\+Spectrum\+\_\+mod\+::get\+Photon\+Fluence\+From\+Energy\+Fluence (\begin{DoxyParamCaption}\item[{real(RK)}]{energy\+Fluence,  }\item[{real(RK)}]{lower\+Lim,  }\item[{real(RK)}]{upper\+Lim,  }\item[{real(RK), intent(in)}]{epk,  }\item[{real(RK), intent(in)}]{alpha,  }\item[{real(RK), intent(in)}]{beta,  }\item[{real(RK), intent(in)}]{tolerance,  }\item[{real(RK)}]{photon\+Fluence,  }\item[{type(\mbox{\hyperlink{structErr__mod_1_1Err__type}{Err\+\_\+type}})}]{Err,  }\item[{real(RK)}]{lower\+Lim\+New,  }\item[{real(RK)}]{upper\+Lim\+New }\end{DoxyParamCaption})}



Convert an {\bfseries{input energy fluence}} in {\ttfamily \mbox{[}lower\+Lim, upper\+Lim\mbox{]}} energy window, all in units of keV (or ALL in some other units), {\bfseries{to photon fluence}}, within the same energy range, or if {\ttfamily \mbox{[}lower\+Lim\+New, upper\+Lim\+New\mbox{]}} is provided, then in that range. The input {\ttfamily tolerance} is passed to integrators as a measure of the desired accuracy for the computation of {\ttfamily photon\+Fluence}. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em energy\+Fluence} & \+: The input energy fluence (in units of \mbox{[}keV\mbox{]}) to be converted to the output photon fluence. \\
\hline
\mbox{\texttt{ in}}  & {\em lower\+Lim} & \+: The lower limit energy (in units of \mbox{[}keV\mbox{]}) of the integration. \\
\hline
\mbox{\texttt{ in}}  & {\em upper\+Lim} & \+: The upper limit energy (in units of \mbox{[}keV\mbox{]}) of the integration. \\
\hline
\mbox{\texttt{ in}}  & {\em epk} & \+: The spectral peak energy in units of \mbox{[}keV\mbox{]}. \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & \+: The lower spectral exponent of the Band model. \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & \+: The upper spectral exponent of the Band model. \\
\hline
\mbox{\texttt{ in}}  & {\em tolerance} & \+: The relative accuracy tolerance of the integration. \\
\hline
\mbox{\texttt{ out}}  & {\em photon\+Fluence} & \+: The output fluence in units of photon counts. \\
\hline
\mbox{\texttt{ out}}  & {\em Err} & \+: An object of class \mbox{\hyperlink{structErr__mod_1_1Err__type}{Err\+\_\+type}} containing error-\/handling information. \\
\hline
\mbox{\texttt{ in}}  & {\em lower\+Lim\+New} & \+: The lower limit of energy windows (in keV) to be used for the computation of {\ttfamily photon\+Fluence} ({\bfseries{optional}}). \\
\hline
\mbox{\texttt{ in}}  & {\em upper\+Lim\+New} & \+: The upper limit of energy windows (in keV) to be used for the computation of {\ttfamily photon\+Fluence} ({\bfseries{optional}}).\\
\hline
\end{DoxyParams}
\begin{DoxyRemark}{Remarks}
If the optional {\ttfamily \mbox{[}lower\+Lim\+New, upper\+Lim\+New\mbox{]}} are provided, each will replace the corresponding input {\ttfamily \mbox{[}lower\+Lim, upper\+Lim\mbox{]}} in the computation of the output {\ttfamily photon\+Fluence}. 
\end{DoxyRemark}


Definition at line \mbox{\hyperlink{BandSpectrum__mod_8f90_source_l00511}{511}} of file \mbox{\hyperlink{BandSpectrum__mod_8f90_source}{Band\+Spectrum\+\_\+mod.\+f90}}.

\mbox{\Hypertarget{namespaceBandSpectrum__mod_a3b894a1fd2110b1f9009d08d153a4524}\label{namespaceBandSpectrum__mod_a3b894a1fd2110b1f9009d08d153a4524}} 
\index{BandSpectrum\_mod@{BandSpectrum\_mod}!getPhotonFlux@{getPhotonFlux}}
\index{getPhotonFlux@{getPhotonFlux}!BandSpectrum\_mod@{BandSpectrum\_mod}}
\doxysubsubsection{\texorpdfstring{getPhotonFlux()}{getPhotonFlux()}}
{\footnotesize\ttfamily pure real(RK) function Band\+Spectrum\+\_\+mod\+::get\+Photon\+Flux (\begin{DoxyParamCaption}\item[{real(RK), intent(in)}]{energy,  }\item[{real(RK), intent(in)}]{epk,  }\item[{real(RK), intent(in)}]{alpha,  }\item[{real(RK), intent(in)}]{beta,  }\item[{real(RK), intent(in)}]{ebrk,  }\item[{real(RK), intent(in)}]{coef,  }\item[{real(RK)}]{alpha\+Plus\+Two }\end{DoxyParamCaption})}



Compute the differential photon flux according to the Band differential spectrum at the given input {\ttfamily energy} value. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em energy} & \+: The energy (in units of \mbox{[}keV\mbox{]}) at which the differential photon flux must be computed. \\
\hline
\mbox{\texttt{ in}}  & {\em epk} & \+: The spectral peak energy in units of \mbox{[}keV\mbox{]}. \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & \+: The lower spectral exponent of the Band model. \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & \+: The upper spectral exponent of the Band model. \\
\hline
\mbox{\texttt{ in}}  & {\em ebrk} & \+: The spectral break energy in units of \mbox{[}keV\mbox{]}. \\
\hline
\mbox{\texttt{ in}}  & {\em coef} & \+: The spectral continuity coefficient. \\
\hline
\mbox{\texttt{ in}}  & {\em alpha\+Plus\+Two} & \+: The lower spectral exponent of the Band model plus two.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
{\ttfamily photon\+Flux} \+: The energy flux in units of photon counts.
\end{DoxyReturn}
\begin{DoxyWarning}{Warning}
A negative huge output value is used to signal error has occurred. Under normal conditions, the output is always positive.

The input energy values {\ttfamily energy}, {\ttfamily epk}, {\ttfamily ebrk}, must all have the same units. It is expected that the input energy is in units of keV, although it does not affect the accuracy of the results. 
\end{DoxyWarning}


Definition at line \mbox{\hyperlink{BandSpectrum__mod_8f90_source_l00175}{175}} of file \mbox{\hyperlink{BandSpectrum__mod_8f90_source}{Band\+Spectrum\+\_\+mod.\+f90}}.

\mbox{\Hypertarget{namespaceBandSpectrum__mod_aaddc0780d391a46158e66d33b2d2e7b8}\label{namespaceBandSpectrum__mod_aaddc0780d391a46158e66d33b2d2e7b8}} 
\index{BandSpectrum\_mod@{BandSpectrum\_mod}!getPhotonFluxLower@{getPhotonFluxLower}}
\index{getPhotonFluxLower@{getPhotonFluxLower}!BandSpectrum\_mod@{BandSpectrum\_mod}}
\doxysubsubsection{\texorpdfstring{getPhotonFluxLower()}{getPhotonFluxLower()}}
{\footnotesize\ttfamily pure real(RK) function Band\+Spectrum\+\_\+mod\+::get\+Photon\+Flux\+Lower (\begin{DoxyParamCaption}\item[{real(RK), intent(in)}]{energy,  }\item[{real(RK), intent(in)}]{alpha,  }\item[{real(RK)}]{alpha\+Plus\+Two\+Over\+Epk }\end{DoxyParamCaption})}



Compute the differential photon flux according to the lower component of the Band spectrum at the given input {\ttfamily energy} value. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em energy} & \+: The energy (in units of \mbox{[}keV\mbox{]}) at which the differential photon flux must be computed. \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & \+: The lower spectral exponent of the Band model. \\
\hline
\mbox{\texttt{ in}}  & {\em alpha\+Plus\+Two\+Over\+Epk} & \+: The lower spectral exponent of the Band model plus two.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
{\ttfamily photon\+Flux\+Lower} \+: The energy flux in units of photon counts.
\end{DoxyReturn}
\begin{DoxyWarning}{Warning}
The input {\ttfamily energy} values must be less than {\ttfamily ebrk}. 
\end{DoxyWarning}


Definition at line \mbox{\hyperlink{BandSpectrum__mod_8f90_source_l00210}{210}} of file \mbox{\hyperlink{BandSpectrum__mod_8f90_source}{Band\+Spectrum\+\_\+mod.\+f90}}.



\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{namespaceBandSpectrum__mod_a273925620de54bd626fb2e9810a289b0}\label{namespaceBandSpectrum__mod_a273925620de54bd626fb2e9810a289b0}} 
\index{BandSpectrum\_mod@{BandSpectrum\_mod}!ALPHA\_DEFAULT@{ALPHA\_DEFAULT}}
\index{ALPHA\_DEFAULT@{ALPHA\_DEFAULT}!BandSpectrum\_mod@{BandSpectrum\_mod}}
\doxysubsubsection{\texorpdfstring{ALPHA\_DEFAULT}{ALPHA\_DEFAULT}}
{\footnotesize\ttfamily real(RK), parameter Band\+Spectrum\+\_\+mod\+::\+ALPHA\+\_\+\+DEFAULT = -\/1.\+1\+\_\+\+RK}



Definition at line \mbox{\hyperlink{BandSpectrum__mod_8f90_source_l00059}{59}} of file \mbox{\hyperlink{BandSpectrum__mod_8f90_source}{Band\+Spectrum\+\_\+mod.\+f90}}.

\mbox{\Hypertarget{namespaceBandSpectrum__mod_acb4d7db921d9df54a69dd37b058abe3d}\label{namespaceBandSpectrum__mod_acb4d7db921d9df54a69dd37b058abe3d}} 
\index{BandSpectrum\_mod@{BandSpectrum\_mod}!AMPLITUDE\_DEFAULT@{AMPLITUDE\_DEFAULT}}
\index{AMPLITUDE\_DEFAULT@{AMPLITUDE\_DEFAULT}!BandSpectrum\_mod@{BandSpectrum\_mod}}
\doxysubsubsection{\texorpdfstring{AMPLITUDE\_DEFAULT}{AMPLITUDE\_DEFAULT}}
{\footnotesize\ttfamily real(RK), parameter Band\+Spectrum\+\_\+mod\+::\+AMPLITUDE\+\_\+\+DEFAULT = 1.\+\_\+\+RK}



Definition at line \mbox{\hyperlink{BandSpectrum__mod_8f90_source_l00058}{58}} of file \mbox{\hyperlink{BandSpectrum__mod_8f90_source}{Band\+Spectrum\+\_\+mod.\+f90}}.

\mbox{\Hypertarget{namespaceBandSpectrum__mod_a2bff3bf84c2280fc748e04fba6d29d62}\label{namespaceBandSpectrum__mod_a2bff3bf84c2280fc748e04fba6d29d62}} 
\index{BandSpectrum\_mod@{BandSpectrum\_mod}!BETA\_DEFAULT@{BETA\_DEFAULT}}
\index{BETA\_DEFAULT@{BETA\_DEFAULT}!BandSpectrum\_mod@{BandSpectrum\_mod}}
\doxysubsubsection{\texorpdfstring{BETA\_DEFAULT}{BETA\_DEFAULT}}
{\footnotesize\ttfamily real(RK), parameter Band\+Spectrum\+\_\+mod\+::\+BETA\+\_\+\+DEFAULT = -\/2.\+3\+\_\+\+RK}



Definition at line \mbox{\hyperlink{BandSpectrum__mod_8f90_source_l00060}{60}} of file \mbox{\hyperlink{BandSpectrum__mod_8f90_source}{Band\+Spectrum\+\_\+mod.\+f90}}.

\mbox{\Hypertarget{namespaceBandSpectrum__mod_a5f3e1f97e93886d63ee7b5401116497a}\label{namespaceBandSpectrum__mod_a5f3e1f97e93886d63ee7b5401116497a}} 
\index{BandSpectrum\_mod@{BandSpectrum\_mod}!MODULE\_NAME@{MODULE\_NAME}}
\index{MODULE\_NAME@{MODULE\_NAME}!BandSpectrum\_mod@{BandSpectrum\_mod}}
\doxysubsubsection{\texorpdfstring{MODULE\_NAME}{MODULE\_NAME}}
{\footnotesize\ttfamily character($\ast$), parameter Band\+Spectrum\+\_\+mod\+::\+MODULE\+\_\+\+NAME = \char`\"{}@Band\+Spectrum\+\_\+mod\char`\"{}}



Definition at line \mbox{\hyperlink{BandSpectrum__mod_8f90_source_l00056}{56}} of file \mbox{\hyperlink{BandSpectrum__mod_8f90_source}{Band\+Spectrum\+\_\+mod.\+f90}}.

