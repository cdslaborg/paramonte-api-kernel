\hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source}{}\doxysection{Partition\+Recursive\+\_\+mod.\+inc.\+prop.\+inc.\+f90}
\label{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source}\index{/home/amir/git/paramonte/src/kernel/PartitionRecursive\_mod.inc.prop.inc.f90@{/home/amir/git/paramonte/src/kernel/PartitionRecursive\_mod.inc.prop.inc.f90}}
\mbox{\hyperlink{PartitionRecursive__mod_8inc_8prop_8inc_8f90}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00001}00001 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00002}00002         \textcolor{fortran_comment}{! Compute the cumulative sum of the cluster Size array.}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00003}00003 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00004}00004         Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}CumSumSize(\textcolor{fortran_numeric_literal}{0})\textcolor{fortran_operator_symbols}{ = }nps\textcolor{fortran_operator_symbols}{ -\/ }\textcolor{fortran_numeric_literal}{1}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00005}00005         \textcolor{fortran_keywordflow}{do} ic\textcolor{fortran_operator_symbols}{ = }\textcolor{fortran_numeric_literal}{1}, nc \textcolor{fortran_comment}{! loopDetermineClusterBoundaries}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00006}00006             KmeansMemberCounter(ic)\textcolor{fortran_operator_symbols}{ = }Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}CumSumSize(ic\textcolor{fortran_operator_symbols}{-\/}\textcolor{fortran_numeric_literal}{1})}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00007}00007             Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}CumSumSize(ic)\textcolor{fortran_operator_symbols}{ = }KmeansMemberCounter(ic)\textcolor{fortran_operator_symbols}{ + }Kmeans\textcolor{fortran_operator_symbols}{\%}\textcolor{fortran_function}{Size}\textcolor{fortran_comment}{(ic)}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00008}00008 \textcolor{fortran_comment}{}\textcolor{fortran_keywordflow}{        end do} \textcolor{fortran_comment}{! loopDetermineClusterBoundaries}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00009}00009 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00010}00010         \textcolor{fortran_keywordflow}{do} ip\textcolor{fortran_operator_symbols}{ = }nps, npe}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00011}00011             jp\textcolor{fortran_operator_symbols}{ = }ip\textcolor{fortran_operator_symbols}{ -\/ }nps\textcolor{fortran_operator_symbols}{ + }\textcolor{fortran_numeric_literal}{1}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00012}00012             KmeansMemberCounter(Kmeans\textcolor{fortran_operator_symbols}{\%}Membership(jp))\textcolor{fortran_operator_symbols}{ = }KmeansMemberCounter\textcolor{fortran_comment}{(Kmeans}\textcolor{fortran_operator_symbols}{\%}Membership\textcolor{fortran_comment}{(jp))}\textcolor{fortran_operator_symbols}{ + }\textcolor{fortran_numeric_literal}{1\_IK}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00013}00013             StanPoint(\textcolor{fortran_numeric_literal}{1}:nd,KmeansMemberCounter(Kmeans\textcolor{fortran_operator_symbols}{\%}Membership(jp)))\textcolor{fortran_operator_symbols}{ = }Point\textcolor{fortran_comment}{(}\textcolor{fortran_numeric_literal}{1}\textcolor{fortran_comment}{:nd,ip)}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00014}00014 \textcolor{fortran_comment}{}            Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}\textcolor{fortran_function}{Index}(KmeansMemberCounter(Kmeans\textcolor{fortran_operator_symbols}{\%}Membership(jp))\textcolor{fortran_comment}{)}\textcolor{fortran_operator_symbols}{ = }PointIndex\textcolor{fortran_comment}{(ip)}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00015}00015 \textcolor{fortran_comment}{}\textcolor{fortran_keywordflow}{        end do}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00016}00016         PointIndex(nps:npe)\textcolor{fortran_operator_symbols}{ = }Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}Index}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00017}00017         Point(\textcolor{fortran_numeric_literal}{1}:nd,nps:npe)\textcolor{fortran_operator_symbols}{ = }StanPoint}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00018}00018 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00019}00019         \textcolor{fortran_comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00020}00020         \textcolor{fortran_comment}{! Compute the properties of non-\/singular clusters.}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00021}00021         \textcolor{fortran_comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00022}00022 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00023}00023         maxLogVolNormed\textcolor{fortran_operator_symbols}{ = }NEGINF\_RK}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00024}00024         pointLogVolNormedDefault\textcolor{fortran_operator_symbols}{ = }\textcolor{fortran_operator_symbols}{-\/}\textcolor{fortran_numeric_literal}{1.\_RK} \textcolor{fortran_comment}{! indicator: no singular cluster detected.}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00025}00025         Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}logSumVolNormed\textcolor{fortran_operator_symbols}{ = }NEGINF\_RK}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00026}00026         \textcolor{fortran_keywordflow}{do} ic\textcolor{fortran_operator_symbols}{ = }\textcolor{fortran_numeric_literal}{1}, nc \textcolor{fortran_comment}{! loopComputeClusterProperties}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00027}00027 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00028}00028             \textcolor{fortran_keywordflow}{if} (Kmeans\textcolor{fortran_operator_symbols}{\%}\textcolor{fortran_function}{Size}(ic)\textcolor{fortran_operator_symbols}{ > }nd) \textcolor{fortran_keywordflow}{then} \textcolor{fortran_comment}{! blockMinimumClusterSize}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00029}00029 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00030}00030                 ipstart\textcolor{fortran_operator_symbols}{ = }Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}CumSumSize(ic\textcolor{fortran_operator_symbols}{-\/}\textcolor{fortran_numeric_literal}{1})\textcolor{fortran_operator_symbols}{ + }\textcolor{fortran_numeric_literal}{1\_IK}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00031}00031                 ipend\textcolor{fortran_operator_symbols}{ = }Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}CumSumSize(ic)}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00032}00032 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00033}00033                 \textcolor{fortran_comment}{! Correct the cluster memberships.}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00034}00034 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00035}00035                 Kmeans\textcolor{fortran_operator_symbols}{\%}Membership(ipstart\textcolor{fortran_operator_symbols}{-\/}nps\textcolor{fortran_operator_symbols}{+}\textcolor{fortran_numeric_literal}{1}:ipend\textcolor{fortran_operator_symbols}{-\/}nps\textcolor{fortran_operator_symbols}{+}\textcolor{fortran_numeric_literal}{1})\textcolor{fortran_operator_symbols}{ = }ic}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00036}00036 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00037}00037                 \textcolor{fortran_comment}{! Normalize points.}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00038}00038 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00039}00039                 \textcolor{fortran_keywordflow}{do concurrent}(ip\textcolor{fortran_operator_symbols}{ = }nps:npe)}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00040}00040                     StanPoint(\textcolor{fortran_numeric_literal}{1}:nd,ip)\textcolor{fortran_operator_symbols}{ = }Point(\textcolor{fortran_numeric_literal}{1}:nd,ip)\textcolor{fortran_operator_symbols}{ -\/ }Kmeans\textcolor{fortran_operator_symbols}{\%}Center(\textcolor{fortran_numeric_literal}{1}\textcolor{fortran_comment}{:nd,ic)}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00041}00041 \textcolor{fortran_comment}{}\textcolor{fortran_keywordflow}{                end do}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00042}00042 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00043}00043                 \textcolor{fortran_comment}{! Compute the upper covariance matrix of the cluster covariance matrices.}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00044}00044 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00045}00045                 Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}ChoLowCovUpp(\textcolor{fortran_numeric_literal}{1}:nd,\textcolor{fortran_numeric_literal}{1}:nd,ic)\textcolor{fortran_operator_symbols}{ = }\textcolor{fortran_numeric_literal}{0.\_RK}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00046}00046                 \textcolor{fortran_keywordflow}{do} ip\textcolor{fortran_operator_symbols}{ = }ipstart, ipend}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00047}00047                     \textcolor{fortran_keywordflow}{do} j\textcolor{fortran_operator_symbols}{ = }\textcolor{fortran_numeric_literal}{1}, nd}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00048}00048                         Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}ChoLowCovUpp(\textcolor{fortran_numeric_literal}{1}:j,j,ic)\textcolor{fortran_operator_symbols}{ = }Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}ChoLowCovUpp\textcolor{fortran_comment}{(}\textcolor{fortran_numeric_literal}{1}\textcolor{fortran_comment}{:j,j,ic)}\textcolor{fortran_operator_symbols}{ + }StanPoint\textcolor{fortran_comment}{(}\textcolor{fortran_numeric_literal}{1}\textcolor{fortran_comment}{:j,ip)}\textcolor{fortran_operator_symbols}{ * }StanPoint\textcolor{fortran_comment}{(j,ip)}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00049}00049 \textcolor{fortran_comment}{}\textcolor{fortran_keywordflow}{                    end do}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00050}00050 \textcolor{fortran_keywordflow}{                end do}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00051}00051                 Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}ChoLowCovUpp(\textcolor{fortran_numeric_literal}{1}:nd,\textcolor{fortran_numeric_literal}{1}:nd,ic)\textcolor{fortran_operator_symbols}{ = }Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}ChoLowCovUpp\textcolor{fortran_comment}{(}\textcolor{fortran_numeric_literal}{1}\textcolor{fortran_comment}{:nd,}\textcolor{fortran_numeric_literal}{1}\textcolor{fortran_comment}{:nd,ic)}\textcolor{fortran_operator_symbols}{ / }\textcolor{fortran_function}{real}\textcolor{fortran_comment}{(Kmeans}\textcolor{fortran_operator_symbols}{\%}\textcolor{fortran_function}{Size}\textcolor{fortran_comment}{(ic)}\textcolor{fortran_operator_symbols}{-\/}\textcolor{fortran_numeric_literal}{1\_IK}\textcolor{fortran_comment}{,}\textcolor{fortran_spcifier}{ kind}\textcolor{fortran_operator_symbols}{ = }RK\textcolor{fortran_comment}{)}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00052}00052 \textcolor{fortran_comment}{}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00053}00053                 \textcolor{fortran_comment}{! Compute the Cholesky Factor of the cluster covariance matrices.}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00054}00054 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00055}00055 \textcolor{fortran_statement}{                call} getChoLow(nd, Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}ChoLowCovUpp(\textcolor{fortran_numeric_literal}{1}:nd,\textcolor{fortran_numeric_literal}{1}:nd,ic\textcolor{fortran_comment}{), Kmeans}\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}ChoDia\textcolor{fortran_comment}{(}\textcolor{fortran_numeric_literal}{1}\textcolor{fortran_comment}{:nd,ic))}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00056}00056 \textcolor{fortran_comment}{}                \textcolor{fortran_keywordflow}{if} (Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}ChoDia(\textcolor{fortran_numeric_literal}{1},ic)\textcolor{fortran_operator_symbols}{ < }\textcolor{fortran_numeric_literal}{0.\_RK}) \textcolor{fortran_keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00057}00057                     \textcolor{fortran_comment}{! LCOV\_EXCL\_START}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00058}00058                     \textcolor{fortran_comment}{!Kmeans\%Err\%msg = PROCEDURE\_NAME//"{}Cholesky factorization failed."{}}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00059}00059                     \textcolor{fortran_comment}{!Kmeans\%Err\%occurred = .true.}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00060}00060                     PartitionSize(\textcolor{fortran_numeric_literal}{1})\textcolor{fortran_operator_symbols}{ = }npc}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00061}00061                     ne\textcolor{fortran_operator_symbols}{ = }\textcolor{fortran_numeric_literal}{1}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00062}00062 \textcolor{fortran_statement}{                    return}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00063}00063                     \textcolor{fortran_comment}{! LCOV\_EXCL\_STOP}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00064}00064 \textcolor{fortran_keywordflow}{                end if}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00065}00065 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00066}00066                 \textcolor{fortran_comment}{! Compute the inverse of the cluster covariance matrices.}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00067}00067 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00068}00068                 Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}InvCovMat(\textcolor{fortran_numeric_literal}{1}:nd,\textcolor{fortran_numeric_literal}{1}:nd,ic)\textcolor{fortran_operator_symbols}{ = }genInvMatFromChoLow\textcolor{fortran_comment}{( nd, Kmeans}\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}ChoLowCovUpp\textcolor{fortran_comment}{(}\textcolor{fortran_numeric_literal}{1}\textcolor{fortran_comment}{:nd,}\textcolor{fortran_numeric_literal}{1}\textcolor{fortran_comment}{:nd,ic), Kmeans}\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}ChoDia\textcolor{fortran_comment}{(}\textcolor{fortran_numeric_literal}{1}\textcolor{fortran_comment}{:nd,ic) )}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00069}00069 \textcolor{fortran_comment}{}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00070}00070                 \textcolor{fortran_comment}{! Compute the MahalSq of as many points as needed.}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00071}00071 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00072}00072                 \textcolor{fortran_keywordflow}{do concurrent}(ip\textcolor{fortran_operator_symbols}{ = }\textcolor{fortran_numeric_literal}{1}:nps\textcolor{fortran_operator_symbols}{-\/}\textcolor{fortran_numeric_literal}{1})}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00073}00073                     NormedPoint(\textcolor{fortran_numeric_literal}{1}:nd)\textcolor{fortran_operator_symbols}{ = }Point(\textcolor{fortran_numeric_literal}{1}:nd,ip)\textcolor{fortran_operator_symbols}{ -\/ }Kmeans\textcolor{fortran_operator_symbols}{\%}Center(\textcolor{fortran_numeric_literal}{1}\textcolor{fortran_comment}{:nd,ic)}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00074}00074 \textcolor{fortran_comment}{}                    Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}MahalSq(ip,ic)\textcolor{fortran_operator_symbols}{ = }\textcolor{fortran_function}{dot\_product}( NormedPoint\textcolor{fortran_comment}{(}\textcolor{fortran_numeric_literal}{1}\textcolor{fortran_comment}{:nd) ,}\textcolor{fortran_function}{ matmul}\textcolor{fortran_comment}{(Kmeans}\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}InvCovMat\textcolor{fortran_comment}{(}\textcolor{fortran_numeric_literal}{1}\textcolor{fortran_comment}{:nd,}\textcolor{fortran_numeric_literal}{1}\textcolor{fortran_comment}{:nd,ic), NormedPoint(}\textcolor{fortran_numeric_literal}{1}\textcolor{fortran_comment}{:nd)) )}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00075}00075 \textcolor{fortran_comment}{}\textcolor{fortran_keywordflow}{                end do}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00076}00076 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00077}00077                 \textcolor{fortran_keywordflow}{do concurrent}(ip\textcolor{fortran_operator_symbols}{ = }nps:npe)}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00078}00078                     Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}MahalSq(ip,ic)\textcolor{fortran_operator_symbols}{ = }\textcolor{fortran_function}{dot\_product}( StanPoint(\textcolor{fortran_numeric_literal}{1}\textcolor{fortran_comment}{:nd,ip) ,}\textcolor{fortran_function}{ matmul}\textcolor{fortran_comment}{(Kmeans}\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}InvCovMat\textcolor{fortran_comment}{(}\textcolor{fortran_numeric_literal}{1}\textcolor{fortran_comment}{:nd,}\textcolor{fortran_numeric_literal}{1}\textcolor{fortran_comment}{:nd,ic), StanPoint(}\textcolor{fortran_numeric_literal}{1}\textcolor{fortran_comment}{:nd,ip)) )}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00079}00079 \textcolor{fortran_comment}{}\textcolor{fortran_keywordflow}{                end do}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00080}00080 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00081}00081                 \textcolor{fortran_keywordflow}{do concurrent}(ip\textcolor{fortran_operator_symbols}{ = }npe\textcolor{fortran_operator_symbols}{+}\textcolor{fortran_numeric_literal}{1}:np)}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00082}00082                     NormedPoint(\textcolor{fortran_numeric_literal}{1}:nd)\textcolor{fortran_operator_symbols}{ = }Point(\textcolor{fortran_numeric_literal}{1}:nd,ip)\textcolor{fortran_operator_symbols}{ -\/ }Kmeans\textcolor{fortran_operator_symbols}{\%}Center(\textcolor{fortran_numeric_literal}{1}\textcolor{fortran_comment}{:nd,ic)}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00083}00083 \textcolor{fortran_comment}{}                    Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}MahalSq(ip,ic)\textcolor{fortran_operator_symbols}{ = }\textcolor{fortran_function}{dot\_product}( NormedPoint\textcolor{fortran_comment}{(}\textcolor{fortran_numeric_literal}{1}\textcolor{fortran_comment}{:nd) ,}\textcolor{fortran_function}{ matmul}\textcolor{fortran_comment}{(Kmeans}\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}InvCovMat\textcolor{fortran_comment}{(}\textcolor{fortran_numeric_literal}{1}\textcolor{fortran_comment}{:nd,}\textcolor{fortran_numeric_literal}{1}\textcolor{fortran_comment}{:nd,ic), NormedPoint(}\textcolor{fortran_numeric_literal}{1}\textcolor{fortran_comment}{:nd)) )}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00084}00084 \textcolor{fortran_comment}{}\textcolor{fortran_keywordflow}{                end do}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00085}00085 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00086}00086                 \textcolor{fortran_comment}{! Compute the scaleFcator of the bounding region and scale the properties to form the bounded regions.}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00087}00087 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00088}00088                 Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}ScaleFactorSq(ic)\textcolor{fortran_operator_symbols}{ = }\textcolor{fortran_function}{maxval}(Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}MahalSq\textcolor{fortran_comment}{(ipstart:ipend,ic))}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00089}00089 \textcolor{fortran_comment}{}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00090}00090                 scaleFactorSqInverse\textcolor{fortran_operator_symbols}{ = }\textcolor{fortran_numeric_literal}{1.\_RK}\textcolor{fortran_operator_symbols}{ / }Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}ScaleFactorSq\textcolor{fortran_comment}{(ic)}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00091}00091 \textcolor{fortran_comment}{}                scaleFactor\textcolor{fortran_operator_symbols}{ = }\textcolor{fortran_function}{sqrt}(Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}ScaleFactorSq(ic))}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00092}00092                 Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}ChoDia(\textcolor{fortran_numeric_literal}{1}:nd,ic)\textcolor{fortran_operator_symbols}{ = }Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}ChoDia(\textcolor{fortran_numeric_literal}{1}:nd,ic\textcolor{fortran_comment}{)}\textcolor{fortran_operator_symbols}{ * }scaleFactor}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00093}00093                 Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}InvCovMat(\textcolor{fortran_numeric_literal}{1}:nd,\textcolor{fortran_numeric_literal}{1}:nd,ic)\textcolor{fortran_operator_symbols}{ = }Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}InvCovMat\textcolor{fortran_comment}{(}\textcolor{fortran_numeric_literal}{1}\textcolor{fortran_comment}{:nd,}\textcolor{fortran_numeric_literal}{1}\textcolor{fortran_comment}{:nd,ic)}\textcolor{fortran_operator_symbols}{ * }scaleFactorSqInverse}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00094}00094                 \textcolor{fortran_keywordflow}{do} j\textcolor{fortran_operator_symbols}{ = }\textcolor{fortran_numeric_literal}{1}, nd}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00095}00095                     \textcolor{fortran_keywordflow}{do} i\textcolor{fortran_operator_symbols}{ = }j\textcolor{fortran_operator_symbols}{ + }\textcolor{fortran_numeric_literal}{1}, nd}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00096}00096                         Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}ChoLowCovUpp(i,j,ic)\textcolor{fortran_operator_symbols}{ = }Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}ChoLowCovUpp\textcolor{fortran_comment}{(i,j,ic)}\textcolor{fortran_operator_symbols}{ * }scaleFactor}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00097}00097 \textcolor{fortran_keywordflow}{                    end do}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00098}00098 \textcolor{fortran_keywordflow}{                end do}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00099}00099 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00100}00100                 \textcolor{fortran_comment}{! Rescale the MahalSq to the bounding regions}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00101}00101 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00102}00102                 \textcolor{fortran_comment}{!Kmeans\%Prop\%MahalSq(1:np,ic) = Kmeans\%Prop\%MahalSq(1:np,ic) * scaleFactorSqInverse}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00103}00103 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00104}00104                 \textcolor{fortran_comment}{! Compute the effective fraction of points inside the bounded region.}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00105}00105 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00106}00106                 \textcolor{fortran_keywordflow}{if} (inclusionFraction\textcolor{fortran_operator_symbols}{ > }\textcolor{fortran_numeric_literal}{0.\_RK}) \textcolor{fortran_keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00107}00107                     Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}EffectiveSize(ic)\textcolor{fortran_operator_symbols}{   = }Kmeans\textcolor{fortran_operator_symbols}{\%}\textcolor{fortran_function}{Size}(ic)\textcolor{fortran_operator_symbols}{ \& }\textcolor{fortran_comment}{! LCOV\_EXCL\_LINE}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00108}00108 \textcolor{fortran_operator_symbols}{                                                    + }\textcolor{fortran_function}{nint}(inclusionFraction\textcolor{fortran_operator_symbols}{ * }\textcolor{fortran_operator_symbols}{\& }\textcolor{fortran_comment}{! LCOV\_EXCL\_LINE}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00109}00109                                                     (\textcolor{fortran_function}{ count}(Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}MahalSq\textcolor{fortran_comment}{(}\textcolor{fortran_numeric_literal}{1}\textcolor{fortran_comment}{:Kmeans}\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}CumSumSize\textcolor{fortran_comment}{(ic}\textcolor{fortran_operator_symbols}{-\/}\textcolor{fortran_numeric_literal}{1}\textcolor{fortran_comment}{),ic)}\textcolor{fortran_operator_symbols}{<}\textcolor{fortran_operator_symbols}{=}Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}ScaleFactorSq\textcolor{fortran_comment}{(ic))}\textcolor{fortran_operator_symbols}{ \& }\textcolor{fortran_comment}{! LCOV\_EXCL\_LINE}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00110}00110 \textcolor{fortran_operator_symbols}{                                                    + }\textcolor{fortran_function}{count}(Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}MahalSq\textcolor{fortran_comment}{(Kmeans}\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}CumSumSize\textcolor{fortran_comment}{(ic)}\textcolor{fortran_operator_symbols}{+}\textcolor{fortran_numeric_literal}{1}\textcolor{fortran_comment}{:np,ic)}\textcolor{fortran_operator_symbols}{<}\textcolor{fortran_operator_symbols}{=}Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}ScaleFactorSq\textcolor{fortran_comment}{(ic))}\textcolor{fortran_operator_symbols}{ \& }\textcolor{fortran_comment}{! LCOV\_EXCL\_LINE}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00111}00111                                                     ) )}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00112}00112                 \textcolor{fortran_keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00113}00113                     Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}EffectiveSize(ic)\textcolor{fortran_operator_symbols}{ = }Kmeans\textcolor{fortran_operator_symbols}{\%}\textcolor{fortran_function}{Size}(ic)}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00114}00114 \textcolor{fortran_keywordflow}{                end if}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00115}00115 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00116}00116                 Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}LogVolNormed(ic)\textcolor{fortran_operator_symbols}{ = }\textcolor{fortran_function}{sum}(\textcolor{fortran_function}{ log}(Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}ChoDia\textcolor{fortran_comment}{(}\textcolor{fortran_numeric_literal}{1}\textcolor{fortran_comment}{:nd,ic)) )}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00117}00117 \textcolor{fortran_comment}{}                maxLogVolNormed\textcolor{fortran_operator_symbols}{ = }\textcolor{fortran_function}{max}( maxLogVolNormed, Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}LogVolNormed\textcolor{fortran_comment}{(ic) )}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00118}00118 \textcolor{fortran_comment}{}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00119}00119             \textcolor{fortran_keywordflow}{else} \textcolor{fortran_comment}{! blockMinimumClusterSize}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00120}00120 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00121}00121                 pointLogVolNormedDefault\textcolor{fortran_operator_symbols}{ = }\textcolor{fortran_numeric_literal}{1.\_RK} \textcolor{fortran_comment}{! This is an indicator}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00122}00122                 Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}LogVolNormed(ic)\textcolor{fortran_operator_symbols}{ = }NEGINF\_RK \textcolor{fortran_comment}{! This initialization is essential in dependent procedures.}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00123}00123                 Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}EffectiveSize(ic)\textcolor{fortran_operator_symbols}{ = }\textcolor{fortran_numeric_literal}{0\_IK}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00124}00124 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00125}00125 \textcolor{fortran_keywordflow}{            end if} \textcolor{fortran_comment}{! blockMinimumClusterSize}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00126}00126 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00127}00127 \textcolor{fortran_keywordflow}{        end do} \textcolor{fortran_comment}{! loopComputeClusterProperties}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00128}00128 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00129}00129         \textcolor{fortran_keywordflow}{if} (maxLogVolNormed\textcolor{fortran_operator_symbols}{ /}\textcolor{fortran_operator_symbols}{= }NEGINF\_RK) Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}logSumVolNormed\textcolor{fortran_operator_symbols}{ = }getLogSumExp\textcolor{fortran_comment}{(Kmeans}\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}LogVolNormed\textcolor{fortran_comment}{, maxLogVolNormed)}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00130}00130 \textcolor{fortran_comment}{}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00131}00131         \textcolor{fortran_comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00132}00132         \textcolor{fortran_comment}{! Compute the properties of singular clusters.}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00133}00133         \textcolor{fortran_comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00134}00134 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00135}00135         \textcolor{fortran_keywordflow}{if} (pointLogVolNormedDefault\textcolor{fortran_operator_symbols}{ > }\textcolor{fortran_numeric_literal}{0.\_RK}) \textcolor{fortran_keywordflow}{then} \textcolor{fortran_comment}{! blockSingularClusterDetected}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00136}00136 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00137}00137             \textcolor{fortran_keywordflow}{if} (pointLogVolNormed\textcolor{fortran_operator_symbols}{ > }NEGINF\_RK) \textcolor{fortran_keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00138}00138                 pointLogVolNormedDefault\textcolor{fortran_operator_symbols}{ = }pointLogVolNormed}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00139}00139             \textcolor{fortran_keywordflow}{elseif} (maxLogVolNormed\textcolor{fortran_operator_symbols}{ /}\textcolor{fortran_operator_symbols}{= }NEGINF\_RK) \textcolor{fortran_keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00140}00140                 pointLogVolNormedDefault\textcolor{fortran_operator_symbols}{ = }\textcolor{fortran_numeric_literal}{0.\_RK}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00141}00141                 \textcolor{fortran_keywordflow}{do} ic\textcolor{fortran_operator_symbols}{ = }\textcolor{fortran_numeric_literal}{1}, nc \textcolor{fortran_comment}{! add all points.}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00142}00142                     \textcolor{fortran_keywordflow}{if} (Kmeans\textcolor{fortran_operator_symbols}{\%}\textcolor{fortran_function}{Size}(ic)\textcolor{fortran_operator_symbols}{ > }nd) pointLogVolNormedDefault\textcolor{fortran_operator_symbols}{ = }pointLogVolNormedDefault\textcolor{fortran_operator_symbols}{ + }\textcolor{fortran_function}{real}\textcolor{fortran_comment}{(Kmeans}\textcolor{fortran_operator_symbols}{\%}\textcolor{fortran_function}{Size}\textcolor{fortran_comment}{(ic),RK)}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00143}00143 \textcolor{fortran_comment}{}\textcolor{fortran_keywordflow}{                end do}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00144}00144                 pointLogVolNormedDefault\textcolor{fortran_operator_symbols}{ = }Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}logSumVolNormed\textcolor{fortran_operator_symbols}{ -\/ }\textcolor{fortran_function}{log}\textcolor{fortran_comment}{(pointLogVolNormedDefault)}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00145}00145 \textcolor{fortran_comment}{}            \textcolor{fortran_keywordflow}{else} \textcolor{fortran_comment}{! There is not any non-\/singular cluster for which to compute the properties.}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00146}00146                 \textcolor{fortran_comment}{! LCOV\_EXCL\_START}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00147}00147                 PartitionSize(\textcolor{fortran_numeric_literal}{1})\textcolor{fortran_operator_symbols}{ = }npc}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00148}00148                 ne\textcolor{fortran_operator_symbols}{ = }\textcolor{fortran_numeric_literal}{1}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00149}00149 \textcolor{fortran_statement}{                return}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00150}00150                 \textcolor{fortran_comment}{! LCOV\_EXCL\_STOP}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00151}00151 \textcolor{fortran_keywordflow}{            end if}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00152}00152 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00153}00153             \textcolor{fortran_keywordflow}{if} (maxLogVolNormed\textcolor{fortran_operator_symbols}{ /}\textcolor{fortran_operator_symbols}{= }NEGINF\_RK) \textcolor{fortran_keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00154}00154                 Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}logSumVolNormed\textcolor{fortran_operator_symbols}{ = }\textcolor{fortran_function}{exp}(Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}logSumVolNormed\textcolor{fortran_operator_symbols}{ -\/ }maxLogVolNormed\textcolor{fortran_comment}{)}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00155}00155 \textcolor{fortran_comment}{}            \textcolor{fortran_keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00156}00156                 Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}logSumVolNormed\textcolor{fortran_operator_symbols}{ = }\textcolor{fortran_numeric_literal}{0.\_RK}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00157}00157                 maxLogVolNormed\textcolor{fortran_operator_symbols}{ = }pointLogVolNormedDefault}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00158}00158 \textcolor{fortran_keywordflow}{            end if}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00159}00159 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00160}00160             \textcolor{fortran_comment}{! Assume a hyper-\/spherical ellipsoid as the bounding region of the points.}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00161}00161 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00162}00162             \textcolor{fortran_keywordflow}{do} ic\textcolor{fortran_operator_symbols}{ = }\textcolor{fortran_numeric_literal}{1}, nc \textcolor{fortran_comment}{! loopComputeSingularClusterProperties}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00163}00163 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00164}00164                 \textcolor{fortran_keywordflow}{if} (Kmeans\textcolor{fortran_operator_symbols}{\%}\textcolor{fortran_function}{Size}(ic)\textcolor{fortran_operator_symbols}{ <}\textcolor{fortran_operator_symbols}{= }nd \textcolor{fortran_operator_logical}{.and.} Kmeans\textcolor{fortran_operator_symbols}{\%}\textcolor{fortran_function}{Size}(ic)\textcolor{fortran_operator_symbols}{ > }\textcolor{fortran_numeric_literal}{0\_IK}) \textcolor{fortran_keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00165}00165 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00166}00166                     ipstart\textcolor{fortran_operator_symbols}{ = }Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}CumSumSize(ic\textcolor{fortran_operator_symbols}{-\/}\textcolor{fortran_numeric_literal}{1})\textcolor{fortran_operator_symbols}{ + }\textcolor{fortran_numeric_literal}{1\_IK}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00167}00167                     ipend\textcolor{fortran_operator_symbols}{ = }Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}CumSumSize(ic)}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00168}00168 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00169}00169                     \textcolor{fortran_comment}{! Correct the cluster memberships.}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00170}00170 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00171}00171                     Kmeans\textcolor{fortran_operator_symbols}{\%}Membership(ipstart\textcolor{fortran_operator_symbols}{-\/}nps\textcolor{fortran_operator_symbols}{+}\textcolor{fortran_numeric_literal}{1}:ipend\textcolor{fortran_operator_symbols}{-\/}nps\textcolor{fortran_operator_symbols}{+}\textcolor{fortran_numeric_literal}{1})\textcolor{fortran_operator_symbols}{ = }ic}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00172}00172 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00173}00173                     \textcolor{fortran_comment}{! Compute the scale factor and other properties.}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00174}00174 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00175}00175                     \textcolor{fortran_keywordflow}{do concurrent}(ip\textcolor{fortran_operator_symbols}{ = }\textcolor{fortran_numeric_literal}{1}:np)}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00176}00176                         Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}MahalSq(ip,ic)\textcolor{fortran_operator_symbols}{ = }\textcolor{fortran_function}{sum}( ( Point(\textcolor{fortran_numeric_literal}{1}:nd,ip\textcolor{fortran_comment}{)}\textcolor{fortran_operator_symbols}{ -\/ }Kmeans\textcolor{fortran_operator_symbols}{\%}Center\textcolor{fortran_comment}{(}\textcolor{fortran_numeric_literal}{1}\textcolor{fortran_comment}{:nd,ic) )}\textcolor{fortran_operator_symbols}{*}\textcolor{fortran_operator_symbols}{*}\textcolor{fortran_numeric_literal}{2}\textcolor{fortran_comment}{ )}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00177}00177 \textcolor{fortran_comment}{}\textcolor{fortran_keywordflow}{                    end do}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00178}00178 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00179}00179                     Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}ScaleFactorSq(ic)\textcolor{fortran_operator_symbols}{ = }\textcolor{fortran_function}{max}(\textcolor{fortran_function}{exp}(\textcolor{fortran_numeric_literal}{2}\textcolor{fortran_operator_symbols}{*}pointLogVolNormedDefault\textcolor{fortran_operator_symbols}{/}nd\textcolor{fortran_comment}{),}\textcolor{fortran_function}{ maxval}\textcolor{fortran_comment}{(Kmeans}\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}MahalSq\textcolor{fortran_comment}{(ipstart:ipend,ic))) ! xxx this is likely wrong. maximization will be done later.}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00180}00180                     scaleFactorSqInverse\textcolor{fortran_operator_symbols}{ = }\textcolor{fortran_numeric_literal}{1.\_RK}\textcolor{fortran_operator_symbols}{ / }Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}ScaleFactorSq\textcolor{fortran_comment}{(ic)}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00181}00181 \textcolor{fortran_comment}{}                    scaleFactor\textcolor{fortran_operator_symbols}{ = }\textcolor{fortran_function}{sqrt}(Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}ScaleFactorSq(ic))}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00182}00182 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00183}00183                     \textcolor{fortran_comment}{!Kmeans\%Prop\%MahalSq(ip,ic) = Kmeans\%Prop\%MahalSq(ip,ic) * scaleFactorSqInverse}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00184}00184 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00185}00185                     Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}ChoDia(\textcolor{fortran_numeric_literal}{1}:nd,ic)\textcolor{fortran_operator_symbols}{ = }scaleFactor}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00186}00186                     Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}LogVolNormed(ic)\textcolor{fortran_operator_symbols}{ = }nd\textcolor{fortran_operator_symbols}{ * }\textcolor{fortran_function}{log}(scaleFactor)}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00187}00187                     Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}ChoLowCovUpp(\textcolor{fortran_numeric_literal}{1}:nd,\textcolor{fortran_numeric_literal}{1}:nd,ic)\textcolor{fortran_operator_symbols}{ = }genEye(nd, nd\textcolor{fortran_comment}{, Kmeans}\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}ScaleFactorSq\textcolor{fortran_comment}{(ic))}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00188}00188 \textcolor{fortran_comment}{}                    Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}InvCovMat(\textcolor{fortran_numeric_literal}{1}:nd,\textcolor{fortran_numeric_literal}{1}:nd,ic)\textcolor{fortran_operator_symbols}{ = }genEye(nd, nd,\textcolor{fortran_comment}{ scaleFactorSqInverse)}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00189}00189 \textcolor{fortran_comment}{}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00190}00190                     \textcolor{fortran_comment}{! Compute the effective fraction of points inside the bounded region.}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00191}00191 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00192}00192                     \textcolor{fortran_keywordflow}{if} (inclusionFraction\textcolor{fortran_operator_symbols}{ > }\textcolor{fortran_numeric_literal}{0.\_RK}) \textcolor{fortran_keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00193}00193                         Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}EffectiveSize(ic)\textcolor{fortran_operator_symbols}{   = }Kmeans\textcolor{fortran_operator_symbols}{\%}\textcolor{fortran_function}{Size}(ic\textcolor{fortran_comment}{)}\textcolor{fortran_operator_symbols}{ \& }\textcolor{fortran_comment}{! LCOV\_EXCL\_LINE}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00194}00194 \textcolor{fortran_operator_symbols}{                                                        + }\textcolor{fortran_function}{nint}(inclusionFraction\textcolor{fortran_operator_symbols}{ * }\textcolor{fortran_operator_symbols}{\& }\textcolor{fortran_comment}{! LCOV\_EXCL\_LINE}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00195}00195                                                         (\textcolor{fortran_function}{ count}(Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}MahalSq\textcolor{fortran_comment}{(}\textcolor{fortran_numeric_literal}{1}\textcolor{fortran_comment}{:Kmeans}\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}CumSumSize\textcolor{fortran_comment}{(ic}\textcolor{fortran_operator_symbols}{-\/}\textcolor{fortran_numeric_literal}{1}\textcolor{fortran_comment}{),ic)}\textcolor{fortran_operator_symbols}{<}\textcolor{fortran_operator_symbols}{=}Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}ScaleFactorSq\textcolor{fortran_comment}{(ic))}\textcolor{fortran_operator_symbols}{ \& }\textcolor{fortran_comment}{! LCOV\_EXCL\_LINE}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00196}00196 \textcolor{fortran_operator_symbols}{                                                        + }\textcolor{fortran_function}{count}(Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}MahalSq\textcolor{fortran_comment}{(Kmeans}\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}CumSumSize\textcolor{fortran_comment}{(ic)}\textcolor{fortran_operator_symbols}{+}\textcolor{fortran_numeric_literal}{1}\textcolor{fortran_comment}{:np,ic)}\textcolor{fortran_operator_symbols}{<}\textcolor{fortran_operator_symbols}{=}Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}ScaleFactorSq\textcolor{fortran_comment}{(ic))}\textcolor{fortran_operator_symbols}{ \& }\textcolor{fortran_comment}{! LCOV\_EXCL\_LINE}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00197}00197                                                         ),\textcolor{fortran_spcifier}{ kind}\textcolor{fortran_operator_symbols}{ = }IK)}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00198}00198                     \textcolor{fortran_keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00199}00199                         Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}EffectiveSize(ic)\textcolor{fortran_operator_symbols}{ = }Kmeans\textcolor{fortran_operator_symbols}{\%}\textcolor{fortran_function}{Size}(ic)}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00200}00200 \textcolor{fortran_keywordflow}{                    end if}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00201}00201 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00202}00202                     Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}logSumVolNormed\textcolor{fortran_operator_symbols}{ = }Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}logSumVolNormed\textcolor{fortran_operator_symbols}{ + }\textcolor{fortran_function}{exp}\textcolor{fortran_comment}{(Kmeans}\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}LogVolNormed\textcolor{fortran_comment}{(ic)}\textcolor{fortran_operator_symbols}{ -\/ }maxLogVolNormed\textcolor{fortran_comment}{)}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00203}00203 \textcolor{fortran_comment}{}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00204}00204 \textcolor{fortran_keywordflow}{                end if}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00205}00205 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00206}00206 \textcolor{fortran_keywordflow}{            end do} \textcolor{fortran_comment}{! loopComputeSingularClusterProperties}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00207}00207 }
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00208}00208             Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}logSumVolNormed\textcolor{fortran_operator_symbols}{ = }maxLogVolNormed\textcolor{fortran_operator_symbols}{ + }\textcolor{fortran_function}{log}(Kmeans\textcolor{fortran_operator_symbols}{\%}Prop\textcolor{fortran_operator_symbols}{\%}logSumVolNormed\textcolor{fortran_comment}{)}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00209}00209 \textcolor{fortran_comment}{}}
\DoxyCodeLine{\Hypertarget{PartitionRecursive__mod_8inc_8prop_8inc_8f90_source_l00210}00210 \textcolor{fortran_keywordflow}{        end if} \textcolor{fortran_comment}{! blockSingularClusterDetected}}

\end{DoxyCode}
