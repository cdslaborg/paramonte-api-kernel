\hypertarget{PRNG__mod_8f90_source}{}\doxysection{PRNG\+\_\+mod.\+f90}
\label{PRNG__mod_8f90_source}\index{D:/Dropbox/Projects/20180101\_ParaMonte/git/src/kernel/\_\_\_toBeCleared\_\_\_/PRNG\_mod.f90@{D:/Dropbox/Projects/20180101\_ParaMonte/git/src/kernel/\_\_\_toBeCleared\_\_\_/PRNG\_mod.f90}}
\mbox{\hyperlink{PRNG__mod_8f90}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00001}\mbox{\hyperlink{namespaceprng}{00001}} \textcolor{keyword}{module} \mbox{\hyperlink{namespaceprng}{prng}}}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00002}00002 }
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00003}00003     \textcolor{keywordtype}{use }iso\_fortran\_env, \textcolor{keywordtype}{only}: int32}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00004}00004     \textcolor{keywordtype}{private}}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00005}00005     \textcolor{keywordtype}{integer(int32)}, \textcolor{keywordtype}{parameter} :: a = 16807\_int32}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00006}00006     \textcolor{keywordtype}{integer(int32)}, \textcolor{keywordtype}{parameter} :: m = 2147483647\_int32}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00007}00007     \textcolor{keywordtype}{integer(int32)}, \textcolor{keywordtype}{parameter} :: q = m/a}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00008}00008     \textcolor{keywordtype}{integer(int32)}, \textcolor{keywordtype}{parameter} :: r = mod(m, a)}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00009}00009     \textcolor{keywordtype}{integer} :: seed}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00010}00010     \textcolor{keywordtype}{integer} :: init\_count = 0}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00011}00011     \textcolor{keywordtype}{public} :: random\_number, random\_seed}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00012}00012     \textcolor{keyword}{interface} random\_number}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00013}00013         \textcolor{keyword}{module procedure} :: random\_number\_r, random\_number\_d}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00014}00014     \textcolor{keyword}{end interface}}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00015}00015     \textcolor{keyword}{interface} random\_seed}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00016}00016         \textcolor{keyword}{module procedure} :: random\_seed\_specific}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00017}00017     \textcolor{keyword}{end interface}}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00018}00018 }
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00019}00019 \textcolor{keyword}{contains}}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00020}00020 }
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00021}00021     \textcolor{keyword}{subroutine }init\_random\_number}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00022}00022         \textcolor{keywordtype}{integer} :: values(8)}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00023}00023         \textcolor{keyword}{call }date\_and\_time(values=values)}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00024}00024         seed = init\_count + sum(values)}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00025}00025         \textcolor{keywordflow}{if} (seed<=0 .or. seed>m) seed = 25058 \textcolor{comment}{! Must be in range 1-\/m.}}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00026}00026         init\_count = init\_count + 1}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00027}00027     \textcolor{keyword}{end subroutine}}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00028}00028 }
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00029}00029     \textcolor{keyword}{subroutine }advance\_generator}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00030}00030         \textcolor{keywordtype}{integer(int32)} :: hi, lo, test}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00031}00031         \textcolor{keywordflow}{if} (init\_count==0) \textcolor{keyword}{call }init\_random\_number}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00032}00032         \textcolor{comment}{!}}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00033}00033         \textcolor{comment}{! Calculate seed = mod(a*seed, m),}}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00034}00034         \textcolor{comment}{! without overflow or higher-\/precision arithmetic.}}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00035}00035         \textcolor{comment}{!}}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00036}00036         hi = seed/q}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00037}00037         lo = mod(seed, q)}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00038}00038         solutions to exercises 473}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00039}00039         test = a*lo -\/ r*hi}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00040}00040         seed = merge(test, test+m, test>0)}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00041}00041     \textcolor{keyword}{end subroutine}}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00042}00042 }
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00043}00043     \textcolor{keywordtype}{impure} \textcolor{keywordtype}{elemental} \textcolor{keyword}{subroutine }random\_number\_r(harvest)}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00044}00044 \textcolor{keywordtype}{        real}, \textcolor{keywordtype}{intent(out)} :: harvest}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00045}00045         \textcolor{keyword}{call }advance\_generator}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00046}00046         \textcolor{comment}{!}}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00047}00047         \textcolor{comment}{! Multiply by the reciprocal of m,}}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00048}00048         \textcolor{comment}{! to put the result in the range (0.0,1.0).}}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00049}00049         \textcolor{comment}{!}}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00050}00050         harvest = seed*(1.0/m)}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00051}00051     \textcolor{keyword}{end subroutine}}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00052}00052 }
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00053}00053     \textcolor{keywordtype}{impure} \textcolor{keywordtype}{elemental} \textcolor{keyword}{subroutine }random\_number\_d(harvest)}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00054}00054         \textcolor{keywordtype}{double precision}, \textcolor{keywordtype}{intent(out)} :: harvest}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00055}00055         \textcolor{keyword}{call }advance\_generator}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00056}00056         \textcolor{comment}{!}}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00057}00057         \textcolor{comment}{! Multiply by the reciprocal of m,}}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00058}00058         \textcolor{comment}{! to put the result in the range (0.0,1.0).}}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00059}00059         \textcolor{comment}{!}}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00060}00060         harvest = seed*(1.0d0/m)}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00061}00061     \textcolor{keyword}{end subroutine}}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00062}00062 }
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00063}00063     \textcolor{keyword}{subroutine }random\_seed\_specific(size, put, get)}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00064}00064         \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: size}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00065}00065         \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional} :: put(:)}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00066}00066         \textcolor{keywordtype}{integer}, \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional} :: get(:)}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00067}00067         \textcolor{keywordflow}{if} (count([\textcolor{keyword}{present}(size), \textcolor{keyword}{present}(put), \textcolor{keyword}{present}(get)])>1) \&}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00068}00068         stop ’?too many arguments to random\_seed’}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00069}00069         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(size)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00070}00070         \textcolor{keyword}{size} = 1}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00071}00071         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(put)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00072}00072         \textcolor{keywordflow}{if} (ubound(put)<1) stop ’?random\_number: put is too small’}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00073}00073         seed = sum(put)}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00074}00074         \textcolor{keywordflow}{if} (seed<=0 .or. seed>m) \textcolor{keyword}{call }init\_random}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00075}00075         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(get)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00076}00076         \textcolor{keywordflow}{if} (ubound(get)<1) stop ’?random\_number: get is too small’}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00077}00077         get(1) = seed}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00078}00078         get(2:) = 0}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00079}00079         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00080}00080         \textcolor{keyword}{call }init\_random}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00081}00081 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00082}00082     \textcolor{keyword}{end subroutine}}
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00083}00083 }
\DoxyCodeLine{\Hypertarget{PRNG__mod_8f90_source_l00084}00084 \textcolor{keyword}{end module}}

\end{DoxyCode}
