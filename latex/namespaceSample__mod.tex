\hypertarget{namespaceSample__mod}{}\doxysection{Sample\+\_\+mod Module Reference}
\label{namespaceSample__mod}\index{Sample\_mod@{Sample\_mod}}


This module contains the classes and procedures for computing various statistical properties of data samples.  


\doxysubsection*{Data Types}
\begin{DoxyCompactItemize}
\item 
interface \mbox{\hyperlink{interfaceSample__mod_1_1genCovUpp}{gen\+Cov\+Upp}}
\begin{DoxyCompactList}\small\item\em Return the {\bfseries{upper triangle}} covariance matrix of the input shifted, optionally-\/weighted, sample {\ttfamily Shifted\+Sample} whose shape is by default assumed to be {\ttfamily (nd,np)} or {\ttfamily (nd,np)} such that {\ttfamily nd \texorpdfstring{$<$}{<} np} always holds, where {\ttfamily nd} represents the number of attributes (dimensions) of the sample and {\ttfamily np} represents the number of data points in the sample. Note that by definition, {\ttfamily np \texorpdfstring{$>$}{>} nd} must hold. The input sample must be normalized in the sense that its mean is zero. \end{DoxyCompactList}\item 
interface \mbox{\hyperlink{interfaceSample__mod_1_1genMean}{gen\+Mean}}
\begin{DoxyCompactList}\small\item\em Generate and return the (weighted) mean of the input {\ttfamily Sample}, optionally weighted by the input {\ttfamily Weight}. \end{DoxyCompactList}\item 
interface \mbox{\hyperlink{interfaceSample__mod_1_1genShifted}{gen\+Shifted}}
\begin{DoxyCompactList}\small\item\em Generate a sample of shape {\ttfamily (np)}, or {\ttfamily (nd,np)} or {\ttfamily (np,nd)} that is shifted by the specified input {\ttfamily Amount} along the (optionally) specified axis {\ttfamily dim}. Here, {\ttfamily nd} stands for the number of dimensions (data attributes) of the input {\ttfamily Sample} and {\ttfamily np} represents the number of data points in the {\ttfamily Sample}. If the input {\ttfamily Amount} is the negative of the mean of the sample, then the returned sample will have a mean of zero. \end{DoxyCompactList}\item 
interface \mbox{\hyperlink{interfaceSample__mod_1_1genVariance}{gen\+Variance}}
\begin{DoxyCompactList}\small\item\em Generate and return the variance of the input array of shape {\ttfamily (np)} or {\ttfamily (nd,np)} or {\ttfamily (np,nd)} where {\ttfamily nd} is the number of data dimensions (the number of data attributes) and {\ttfamily np} is the number of data points. \end{DoxyCompactList}\item 
interface \mbox{\hyperlink{interfaceSample__mod_1_1getShifted}{get\+Shifted}}
\begin{DoxyCompactList}\small\item\em Return a sample of shape {\ttfamily (np)}, or {\ttfamily (nd,np)} or {\ttfamily (np,nd)} that is shifted by the specified input {\ttfamily Amount} along the (optionally) specified axis {\ttfamily dim}. Here, {\ttfamily nd} stands for the number of dimensions (data attributes) of the input {\ttfamily Sample} and {\ttfamily np} represents the number of data points in the {\ttfamily Sample}. If the input {\ttfamily Amount} is the negative of the mean of the sample, then the returned sample will have a mean of zero. \end{DoxyCompactList}\item 
interface \mbox{\hyperlink{interfaceSample__mod_1_1transform}{transform}}
\end{DoxyCompactItemize}
\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
real(RK) function, dimension(\+:,\+:), allocatable \mbox{\hyperlink{namespaceSample__mod_ad81590c5ba27d04d70741fb7af3f94d0}{gen\+Inv\+Cov\+Mat}} (Shifted\+Sample, Weight, failed)
\begin{DoxyCompactList}\small\item\em Return the full inverse covariance matrix of the input {\ttfamily Shifted\+Sample} sample (whose mean is shifted to the origin) whose shape is assumed to be {\ttfamily (nd,np)} or {\ttfamily (nd,np)} such that {\ttfamily nd \texorpdfstring{$<$}{<} np} always holds, where {\ttfamily nd} represents the number of attributes (dimensions) of the sample and {\ttfamily np} represents the number of data points in the sample. Note that by definition, {\ttfamily np \texorpdfstring{$>$}{>} nd} must hold. The input sample must be normalized in the sense that its mean is zero. \end{DoxyCompactList}\item 
PURE subroutine \mbox{\hyperlink{namespaceSample__mod_af9dafbc79f11fc37f384877e49f3bf27}{get\+Cho\+Low\+Cov\+Upp}} (nd, np, Mean, Sample, Cho\+Low\+Cov\+Upp, Cho\+Dia)
\begin{DoxyCompactList}\small\item\em Return the lower triangle Cholesky Factor of the covariance matrix of a set of points in the lower part of {\ttfamily Cho\+Low\+Cov\+Upp}. The upper part of {\ttfamily Cho\+Low\+Cov\+Upp}, including the diagonal elements of it, will contain the covariance matrix of the sample. The output argument {\ttfamily Cho\+Dia}, contains the diagonal terms of Cholesky Factor. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceSample__mod_a1e5daab49859d9c21c4ec3c916ec963d}{get\+Cho\+Low\+Cov\+Upp\+High\+Dim}} (nd, np, Mean, Sample, Cho\+Low\+Cov\+Upp, Cho\+Dia)
\begin{DoxyCompactList}\small\item\em Return the lower triangle Cholesky Factor of the covariance matrix of a set of points in the lower part of {\ttfamily Cho\+Low\+Cov\+Upp}. The upper part of {\ttfamily Cho\+Low\+Cov\+Upp}, including the diagonal elements of it, will contain the covariance matrix of the sample. The output argument {\ttfamily Cho\+Dia}, contains the diagonal terms of Cholesky Factor. This routine delivers the same functionality of \mbox{\hyperlink{namespaceSample__mod_af9dafbc79f11fc37f384877e49f3bf27}{get\+Cho\+Low\+Cov\+Upp()}}. However, it is considerably faster, by a few factors, for {\ttfamily nd \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} 10}. Furthermore, it requires significantly less runtime memory, by about half. The exact amount of speedup depends heavily on the architecture and memory layout of the runtime system. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceSample__mod_a5f2a3ba527c41a88f8afefabf3385a9e}{get\+Mean\+Cov}} (np, nd, Sample, Cov\+Mat, Mean, Mahal\+Sq, Inv\+Cov\+Mat, sqrt\+Det\+Inv\+Cov\+Mat)
\begin{DoxyCompactList}\small\item\em Return the sample mean, covariance matrix, the Mahalanobis distances squared of the points with respect to the sample, and the square root of the determinant of the inverse covariance matrix of the sample. \end{DoxyCompactList}\item 
PURE subroutine \mbox{\hyperlink{namespaceSample__mod_ab54f1da8d61065ad511b74648331cdab}{get\+Mean\+Cov\+Trans}} (np, nd, Sample, Cov\+Mat, Mean, Mahal\+Sq, Inv\+Cov\+Mat, sqrt\+Det\+Inv\+Cov\+Mat)
\begin{DoxyCompactList}\small\item\em Return the sample mean, covariance matrix, the Mahalanobis distances squared of the points with respect to the sample, and the square root of the determinant of the inverse covariance matrix of the sample. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceSample__mod_ae9487a1bd8fb8e417b2ad4b193e63c41}{get\+Mean\+Cov\+Upp\+Trans}} (nd, np, Sample, Cov\+Upp, Mean)
\begin{DoxyCompactList}\small\item\em Return the sample mean and the upper triangle of the covariance matrix of the input sample. \end{DoxyCompactList}\item 
PURE subroutine \mbox{\hyperlink{namespaceSample__mod_a69fe9bd0741ff89ecef392e6c4df1308}{get\+Mean\+Cov\+Upp\+Trans\+Weighted}} (nd, np, Sample, Cov\+Upp, Mean, Weight, sum\+Weight)
\begin{DoxyCompactList}\small\item\em Return the mean and the upper triangle of the covariance matrix of the input {\itshape weighted} sample. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceSample__mod_a64b836f780040d4b71c0a63c77ea5231}{merge\+Mean\+Cov}} (nd, npA, MeanA, Cov\+MatA, npB, MeanB, Cov\+MatB, Mean\+AB, Cov\+Mat\+AB)
\begin{DoxyCompactList}\small\item\em Given two input sample means and covariance matrices, return the combination of them as a single mean and covariance matrix. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceSample__mod_ab6c8a951bf35c59402a30d6d17a6d193}{merge\+Mean\+Cov\+Upp}} (nd, npA, MeanA, Cov\+UppA, npB, MeanB, Cov\+UppB, Mean\+AB, Cov\+Upp\+AB)
\begin{DoxyCompactList}\small\item\em Given two input sample means and covariance matrices, return the combination of them as a single mean and covariance matrix. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespaceSample__mod_a81524ddc27a48db65744d80cfad9b348}{merge\+Mean\+Cov\+Upp\+Dense}} (nd, npA, MeanA, Cov\+UppA, npB, MeanB, Cov\+UppB)
\begin{DoxyCompactList}\small\item\em Given two input sample means and covariance matrices, return the combination of them as a single mean and covariance matrix. \end{DoxyCompactList}\item 
PURE real(RK) function, dimension(nd, nd) \mbox{\hyperlink{namespaceSample__mod_a44441497c46d27639eb9b422d1d4251d}{get\+Cor\+Upp\+From\+Cov\+Upp}} (nd, Cov\+Upp)
\begin{DoxyCompactList}\small\item\em Convert the upper-\/triangle covariance matrix to the upper-\/triangle correlation matrix. \end{DoxyCompactList}\item 
PURE real(RK) function, dimension(nd, nd) \mbox{\hyperlink{namespaceSample__mod_a006be94969ee33fe9d9ad6c2a438a9c6}{gen\+Cov\+Upp\+From\+Cor\+Upp}} (nd, Std\+Vec, Cor\+Upp)
\begin{DoxyCompactList}\small\item\em Convert the upper-\/triangle correlation matrix to the upper-\/triangle covariance matrix. \end{DoxyCompactList}\item 
PURE real(RK) function, dimension(nd, nd) \mbox{\hyperlink{namespaceSample__mod_aaa488173222177596255901083dbc639}{gen\+Cov\+Upp\+From\+Cor\+Low}} (nd, Std\+Vec, Cor\+Low)
\begin{DoxyCompactList}\small\item\em Convert the lower-\/triangle correlation matrix to the upper-\/triangle covariance matrix. \end{DoxyCompactList}\item 
PURE real(RK) function, dimension(nd, nd) \mbox{\hyperlink{namespaceSample__mod_afb2e3c5d56a87f0cadd6304ffee5d823}{get\+Cov\+Low\+From\+Cor\+Upp}} (nd, Std\+Vec, Cor\+Upp)
\begin{DoxyCompactList}\small\item\em Convert the upper-\/triangle correlation matrix to the lower-\/triangle covariance matrix. \end{DoxyCompactList}\item 
PURE real(RK) function, dimension(nd, nd) \mbox{\hyperlink{namespaceSample__mod_ad9a218dda4eed8c4d86cdc9513621d56}{get\+Cov\+Low\+From\+Cor\+Low}} (nd, Std\+Vec, Cor\+Low)
\begin{DoxyCompactList}\small\item\em Convert the lower-\/triangle correlation matrix to the lower-\/triangle covariance matrix. \end{DoxyCompactList}\item 
PURE real(RK) function, dimension(nd, nd) \mbox{\hyperlink{namespaceSample__mod_a9a540e0c59a19fedbcc311a5530617eb}{get\+Cov\+Mat\+From\+Cor\+Upp}} (nd, Std\+Vec, Cor\+Upp)
\begin{DoxyCompactList}\small\item\em Convert the input correlation matrix to the output covariance matrix. \end{DoxyCompactList}\item 
PURE real(RK) function, dimension(\+:,\+:), allocatable \mbox{\hyperlink{namespaceSample__mod_a864d7c57c9dbfac5186cdc337985d48e}{transform\+\_\+2D}} (Sample, Cho\+Low, Cho\+Dia, dim, tenabled)
\begin{DoxyCompactList}\small\item\em Return the transformed sample according to the input Cholesky factorization. \end{DoxyCompactList}\item 
pure real(RK) function, dimension(\+:), allocatable \mbox{\hyperlink{namespaceSample__mod_ae3f7288e349a6a7f5150a35a96194361}{transform\+\_\+1D}} (Point, Cho\+Low, Cho\+Dia)
\begin{DoxyCompactList}\small\item\em Return the transformed sample according to the input Cholesky factorization. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
character(len= $\ast$), parameter \mbox{\hyperlink{namespaceSample__mod_a09a467371587c98f96236755496f7f13}{MODULE\+\_\+\+NAME}} = \char`\"{}@Sample\+\_\+mod\char`\"{}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
This module contains the classes and procedures for computing various statistical properties of data samples. 

\begin{DoxyAuthor}{Author}
Amir Shahmoradi, Thursday 12\+:45 AM, August 20, 2021, Dallas, TX 
\end{DoxyAuthor}


\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespaceSample__mod_aaa488173222177596255901083dbc639}\label{namespaceSample__mod_aaa488173222177596255901083dbc639}} 
\index{Sample\_mod@{Sample\_mod}!genCovUppFromCorLow@{genCovUppFromCorLow}}
\index{genCovUppFromCorLow@{genCovUppFromCorLow}!Sample\_mod@{Sample\_mod}}
\doxysubsubsection{\texorpdfstring{genCovUppFromCorLow()}{genCovUppFromCorLow()}}
{\footnotesize\ttfamily PURE real(RK) function, dimension(nd,nd) Sample\+\_\+mod\+::gen\+Cov\+Upp\+From\+Cor\+Low (\begin{DoxyParamCaption}\item[{integer(IK), intent(in)}]{nd,  }\item[{real(RK)}]{Std\+Vec,  }\item[{real(RK)}]{Cor\+Low }\end{DoxyParamCaption})}



Convert the lower-\/triangle correlation matrix to the upper-\/triangle covariance matrix. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em nd} & \+: The rank of the correlation matrix. \\
\hline
\mbox{\texttt{ in}}  & {\em Std\+Vec} & \+: The input standard deviation vector of length {\ttfamily nd}. \\
\hline
\mbox{\texttt{ in}}  & {\em Cor\+Low} & \+: The lower-\/triangle correlation matrix. The upper-\/triangle will not be used.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
{\ttfamily Cov\+Upp} \+: The upper triangle of the covariance matrix. The lower-\/triangle will NOT be set.
\end{DoxyReturn}
\begin{DoxyAuthor}{Author}
Amir Shahmoradi, Monday March 6, 2017, 3\+:22 pm, ICES, The University of Texas at Austin.
\end{DoxyAuthor}
\begin{DoxyWarning}{Warning}
This procedure is {\ttfamily impure} when the library is compiled with macro {\ttfamily CHECK\+\_\+\+ENABLED=1}. By default, it is {\ttfamily pure} in {\ttfamily release} build and {\ttfamily impure} in {\ttfamily debug} and {\ttfamily testing} builds. 
\end{DoxyWarning}


Definition at line \mbox{\hyperlink{Sample__mod_8f90_source_l02993}{2993}} of file \mbox{\hyperlink{Sample__mod_8f90_source}{Sample\+\_\+mod.\+f90}}.

\mbox{\Hypertarget{namespaceSample__mod_a006be94969ee33fe9d9ad6c2a438a9c6}\label{namespaceSample__mod_a006be94969ee33fe9d9ad6c2a438a9c6}} 
\index{Sample\_mod@{Sample\_mod}!genCovUppFromCorUpp@{genCovUppFromCorUpp}}
\index{genCovUppFromCorUpp@{genCovUppFromCorUpp}!Sample\_mod@{Sample\_mod}}
\doxysubsubsection{\texorpdfstring{genCovUppFromCorUpp()}{genCovUppFromCorUpp()}}
{\footnotesize\ttfamily PURE real(RK) function, dimension(nd,nd) Sample\+\_\+mod\+::gen\+Cov\+Upp\+From\+Cor\+Upp (\begin{DoxyParamCaption}\item[{integer(IK), intent(in)}]{nd,  }\item[{real(RK)}]{Std\+Vec,  }\item[{real(RK)}]{Cor\+Upp }\end{DoxyParamCaption})}



Convert the upper-\/triangle correlation matrix to the upper-\/triangle covariance matrix. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em nd} & \+: The rank of the correlation matrix. \\
\hline
\mbox{\texttt{ in}}  & {\em Std\+Vec} & \+: The input standard deviation vector of length {\ttfamily nd}. \\
\hline
\mbox{\texttt{ in}}  & {\em Cor\+Upp} & \+: The upper-\/triangle correlation matrix. The lower-\/triangle will not be used.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
{\ttfamily Cov\+Upp} \+: The upper triangle of the covariance matrix. The lower-\/triangle will NOT be set.
\end{DoxyReturn}
\begin{DoxyAuthor}{Author}
Amir Shahmoradi, Monday March 6, 2017, 3\+:22 pm, ICES, The University of Texas at Austin.
\end{DoxyAuthor}
\begin{DoxyWarning}{Warning}
This procedure is {\ttfamily impure} when the library is compiled with macro {\ttfamily CHECK\+\_\+\+ENABLED=1}. By default, it is {\ttfamily pure} in {\ttfamily release} build and {\ttfamily impure} in {\ttfamily debug} and {\ttfamily testing} builds. 
\end{DoxyWarning}


Definition at line \mbox{\hyperlink{Sample__mod_8f90_source_l02958}{2958}} of file \mbox{\hyperlink{Sample__mod_8f90_source}{Sample\+\_\+mod.\+f90}}.

\mbox{\Hypertarget{namespaceSample__mod_ad81590c5ba27d04d70741fb7af3f94d0}\label{namespaceSample__mod_ad81590c5ba27d04d70741fb7af3f94d0}} 
\index{Sample\_mod@{Sample\_mod}!genInvCovMat@{genInvCovMat}}
\index{genInvCovMat@{genInvCovMat}!Sample\_mod@{Sample\_mod}}
\doxysubsubsection{\texorpdfstring{genInvCovMat()}{genInvCovMat()}}
{\footnotesize\ttfamily real(RK) function, dimension(\+:,\+:), allocatable Sample\+\_\+mod\+::gen\+Inv\+Cov\+Mat (\begin{DoxyParamCaption}\item[{real(RK)}]{Shifted\+Sample,  }\item[{real(RK)}]{Weight,  }\item[{logical, intent(out), optional}]{failed }\end{DoxyParamCaption})}



Return the full inverse covariance matrix of the input {\ttfamily Shifted\+Sample} sample (whose mean is shifted to the origin) whose shape is assumed to be {\ttfamily (nd,np)} or {\ttfamily (nd,np)} such that {\ttfamily nd \texorpdfstring{$<$}{<} np} always holds, where {\ttfamily nd} represents the number of attributes (dimensions) of the sample and {\ttfamily np} represents the number of data points in the sample. Note that by definition, {\ttfamily np \texorpdfstring{$>$}{>} nd} must hold. The input sample must be normalized in the sense that its mean is zero. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em Shifted\+Sample} & \+: The contiguous array of shape {\ttfamily (\+:,\+:)} containing the sample. \\
\hline
\mbox{\texttt{ in}}  & {\em Weight} & \+: The contiguous array of shape {\ttfamily (\+:,\+:)} containing the sample. \\
\hline
\mbox{\texttt{ out}}  & {\em failed} & \+: An output logical that is {\ttfamily .true.}, it implies that the Cholesky factorization has failed. If missing among the dummy arguments, the procedure will end the program upon encountering a Cholesky factorization failure.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
{\ttfamily Inv\+Cov\+Mat} \+: The full inverse covariance matrix of shape {\ttfamily (nd,nd)} of the input normalized sample.
\end{DoxyReturn}
\begin{DoxyNote}{Note}
If needed, the sample normalization before passing it to this procedure can be done by calling the appropriate function under the generic interface \mbox{\hyperlink{interfaceSample__mod_1_1genShifted}{Sample\+\_\+mod\+::gen\+Shifted()}}.
\end{DoxyNote}
\begin{DoxyAuthor}{Author}
Amir Shahmoradi, Sunday 8\+:48 PM, August 22, 2021, Dallas, TX 
\end{DoxyAuthor}


Definition at line \mbox{\hyperlink{Sample__mod_8f90_source_l02221}{2221}} of file \mbox{\hyperlink{Sample__mod_8f90_source}{Sample\+\_\+mod.\+f90}}.

\mbox{\Hypertarget{namespaceSample__mod_af9dafbc79f11fc37f384877e49f3bf27}\label{namespaceSample__mod_af9dafbc79f11fc37f384877e49f3bf27}} 
\index{Sample\_mod@{Sample\_mod}!getChoLowCovUpp@{getChoLowCovUpp}}
\index{getChoLowCovUpp@{getChoLowCovUpp}!Sample\_mod@{Sample\_mod}}
\doxysubsubsection{\texorpdfstring{getChoLowCovUpp()}{getChoLowCovUpp()}}
{\footnotesize\ttfamily PURE subroutine Sample\+\_\+mod\+::get\+Cho\+Low\+Cov\+Upp (\begin{DoxyParamCaption}\item[{integer(IK), intent(in)}]{nd,  }\item[{integer(IK), intent(in)}]{np,  }\item[{real(RK)}]{Mean,  }\item[{real(RK)}]{Sample,  }\item[{real(RK)}]{Cho\+Low\+Cov\+Upp,  }\item[{real(RK)}]{Cho\+Dia }\end{DoxyParamCaption})}



Return the lower triangle Cholesky Factor of the covariance matrix of a set of points in the lower part of {\ttfamily Cho\+Low\+Cov\+Upp}. The upper part of {\ttfamily Cho\+Low\+Cov\+Upp}, including the diagonal elements of it, will contain the covariance matrix of the sample. The output argument {\ttfamily Cho\+Dia}, contains the diagonal terms of Cholesky Factor. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em nd} & \+: The number of dimensions of the input sample. \\
\hline
\mbox{\texttt{ in}}  & {\em np} & \+: The number of points in the sample. \\
\hline
\mbox{\texttt{ in}}  & {\em Mean} & \+: The mean vector of the sample. \\
\hline
\mbox{\texttt{ in}}  & {\em Sample} & \+: The array of shape {\ttfamily (nd,np)} containing the sample. \\
\hline
\mbox{\texttt{ out}}  & {\em Cho\+Low\+Cov\+Upp} & \+: The output matrix of shape {\ttfamily (nd,nd)} whose lower triangle contains elements of the Cholesky factor. The upper triangle of the matrix contains the covariance matrix of the sample. \\
\hline
\mbox{\texttt{ out}}  & {\em Cho\+Dia} & \+: The diagonal elements of the Cholesky factor.\\
\hline
\end{DoxyParams}
\begin{DoxyWarning}{Warning}
If Cholesky factorization fails, {\ttfamily Cho\+Dia(1)} will be set to {\ttfamily -\/1} to indicate an error on return. This is necessary to maintain the purity of the procedure. However, if the library is built with the preprocessor macro {\ttfamily CHECK\+\_\+\+ENABLED} set to true, then the occurrence of an error will halt the program by executing the {\ttfamily error stop} statement.

This procedure is {\ttfamily impure} when the library is compiled with macro {\ttfamily CHECK\+\_\+\+ENABLED=1}. By default, it is {\ttfamily pure} in {\ttfamily release} build and {\ttfamily impure} in {\ttfamily debug} and {\ttfamily testing} builds.
\end{DoxyWarning}
\begin{DoxyRemark}{Remarks}
For details of naming abbreviations, see \mbox{\hyperlink{index_ParaMonteAbbreviationGuidlines}{this page}}. 

For details of the naming conventions, see \mbox{\hyperlink{index_ParaMonteNamingConventions}{this page}}. 

This software is distributed under the MIT-\/license. If you use any parts or concepts originated from this library, please acknowledge the usage by citing the \href{https://www.cdslab.org/paramonte/notes/overview/preface/\#how-to-acknowledge-the-use-of-the-paramonte-library-in-your-work}{\texttt{ {\bfseries{publications of the Para\+Monte library}}}}.~\newline

\end{DoxyRemark}
\begin{DoxyRefDesc}{Todo}
\item[\mbox{\hyperlink{todo__todo000018}{Todo}}]The efficiency of this code can be further improved.\end{DoxyRefDesc}


\begin{DoxyAuthor}{Author}
Amir Shahmoradi, April 23, 2017, 1\+:36 AM, ICES, University of Texas at Austin 
\end{DoxyAuthor}


Definition at line \mbox{\hyperlink{Sample__mod_8f90_source_l02319}{2319}} of file \mbox{\hyperlink{Sample__mod_8f90_source}{Sample\+\_\+mod.\+f90}}.

\mbox{\Hypertarget{namespaceSample__mod_a1e5daab49859d9c21c4ec3c916ec963d}\label{namespaceSample__mod_a1e5daab49859d9c21c4ec3c916ec963d}} 
\index{Sample\_mod@{Sample\_mod}!getChoLowCovUppHighDim@{getChoLowCovUppHighDim}}
\index{getChoLowCovUppHighDim@{getChoLowCovUppHighDim}!Sample\_mod@{Sample\_mod}}
\doxysubsubsection{\texorpdfstring{getChoLowCovUppHighDim()}{getChoLowCovUppHighDim()}}
{\footnotesize\ttfamily subroutine Sample\+\_\+mod\+::get\+Cho\+Low\+Cov\+Upp\+High\+Dim (\begin{DoxyParamCaption}\item[{integer(IK), intent(in)}]{nd,  }\item[{integer(IK), intent(in)}]{np,  }\item[{real(RK)}]{Mean,  }\item[{real(RK)}]{Sample,  }\item[{real(RK)}]{Cho\+Low\+Cov\+Upp,  }\item[{real(RK)}]{Cho\+Dia }\end{DoxyParamCaption})}



Return the lower triangle Cholesky Factor of the covariance matrix of a set of points in the lower part of {\ttfamily Cho\+Low\+Cov\+Upp}. The upper part of {\ttfamily Cho\+Low\+Cov\+Upp}, including the diagonal elements of it, will contain the covariance matrix of the sample. The output argument {\ttfamily Cho\+Dia}, contains the diagonal terms of Cholesky Factor. This routine delivers the same functionality of \mbox{\hyperlink{namespaceSample__mod_af9dafbc79f11fc37f384877e49f3bf27}{get\+Cho\+Low\+Cov\+Upp()}}. However, it is considerably faster, by a few factors, for {\ttfamily nd \texorpdfstring{$>$}{>}\texorpdfstring{$>$}{>} 10}. Furthermore, it requires significantly less runtime memory, by about half. The exact amount of speedup depends heavily on the architecture and memory layout of the runtime system. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em nd} & \+: The number of dimensions of the input sample. \\
\hline
\mbox{\texttt{ in}}  & {\em np} & \+: The number of points in the sample. \\
\hline
\mbox{\texttt{ in}}  & {\em Mean} & \+: The mean vector of the sample. \\
\hline
\mbox{\texttt{ in}}  & {\em Sample} & \+: The array of shape {\ttfamily (nd,np)} containing the sample. \\
\hline
\mbox{\texttt{ out}}  & {\em Cho\+Low\+Cov\+Upp} & \+: The output matrix of shape {\ttfamily (nd,nd)} whose lower triangle contains elements of the Cholesky factor. The upper triangle of the matrix contains the covariance matrix of the sample. \\
\hline
\mbox{\texttt{ out}}  & {\em Cho\+Dia} & \+: The diagonal elements of the Cholesky factor.\\
\hline
\end{DoxyParams}
\begin{DoxyRefDesc}{Todo}
\item[\mbox{\hyperlink{todo__todo000019}{Todo}}]The efficiency of this code can be further improved.\end{DoxyRefDesc}


\begin{DoxyAuthor}{Author}
Amir Shahmoradi, Oct 16, 2009, 11\+:14 AM, Michigan 
\end{DoxyAuthor}


Definition at line \mbox{\hyperlink{Sample__mod_8f90_source_l02376}{2376}} of file \mbox{\hyperlink{Sample__mod_8f90_source}{Sample\+\_\+mod.\+f90}}.

\mbox{\Hypertarget{namespaceSample__mod_a44441497c46d27639eb9b422d1d4251d}\label{namespaceSample__mod_a44441497c46d27639eb9b422d1d4251d}} 
\index{Sample\_mod@{Sample\_mod}!getCorUppFromCovUpp@{getCorUppFromCovUpp}}
\index{getCorUppFromCovUpp@{getCorUppFromCovUpp}!Sample\_mod@{Sample\_mod}}
\doxysubsubsection{\texorpdfstring{getCorUppFromCovUpp()}{getCorUppFromCovUpp()}}
{\footnotesize\ttfamily PURE real(RK) function, dimension(nd,nd) Sample\+\_\+mod\+::get\+Cor\+Upp\+From\+Cov\+Upp (\begin{DoxyParamCaption}\item[{integer(IK), intent(in)}]{nd,  }\item[{real(RK)}]{Cov\+Upp }\end{DoxyParamCaption})}



Convert the upper-\/triangle covariance matrix to the upper-\/triangle correlation matrix. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em nd} & \+: The rank of the covariance matrix. \\
\hline
\mbox{\texttt{ in}}  & {\em Cov\+Upp} & \+: The upper-\/triangle covariance matrix. The lower-\/triangle will not be used.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
{\ttfamily Cor\+Upp} \+: The upper triangle of the correlation matrix. The lower-\/triangle will NOT be set.
\end{DoxyReturn}
\begin{DoxyAuthor}{Author}
Amir Shahmoradi, Monday March 6, 2017, 3\+:22 pm, ICES, The University of Texas at Austin.
\end{DoxyAuthor}
\begin{DoxyWarning}{Warning}
This procedure is {\ttfamily impure} when the library is compiled with macro {\ttfamily CHECK\+\_\+\+ENABLED=1}. By default, it is {\ttfamily pure} in {\ttfamily release} build and {\ttfamily impure} in {\ttfamily debug} and {\ttfamily testing} builds. 
\end{DoxyWarning}


Definition at line \mbox{\hyperlink{Sample__mod_8f90_source_l02920}{2920}} of file \mbox{\hyperlink{Sample__mod_8f90_source}{Sample\+\_\+mod.\+f90}}.

\mbox{\Hypertarget{namespaceSample__mod_ad9a218dda4eed8c4d86cdc9513621d56}\label{namespaceSample__mod_ad9a218dda4eed8c4d86cdc9513621d56}} 
\index{Sample\_mod@{Sample\_mod}!getCovLowFromCorLow@{getCovLowFromCorLow}}
\index{getCovLowFromCorLow@{getCovLowFromCorLow}!Sample\_mod@{Sample\_mod}}
\doxysubsubsection{\texorpdfstring{getCovLowFromCorLow()}{getCovLowFromCorLow()}}
{\footnotesize\ttfamily PURE real(RK) function, dimension(nd,nd) Sample\+\_\+mod\+::get\+Cov\+Low\+From\+Cor\+Low (\begin{DoxyParamCaption}\item[{integer(IK), intent(in)}]{nd,  }\item[{real(RK)}]{Std\+Vec,  }\item[{real(RK)}]{Cor\+Low }\end{DoxyParamCaption})}



Convert the lower-\/triangle correlation matrix to the lower-\/triangle covariance matrix. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em nd} & \+: The rank of the correlation matrix. \\
\hline
\mbox{\texttt{ in}}  & {\em Std\+Vec} & \+: The input standard deviation vector of length {\ttfamily nd}. \\
\hline
\mbox{\texttt{ in}}  & {\em Cor\+Low} & \+: The lower-\/triangle correlation matrix. The upper-\/triangle will not be used.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
{\ttfamily Cov\+Low} \+: The lower triangle of the covariance matrix. The upper-\/triangle will NOT be set.
\end{DoxyReturn}
\begin{DoxyAuthor}{Author}
Amir Shahmoradi, Monday March 6, 2017, 3\+:22 pm, ICES, The University of Texas at Austin.
\end{DoxyAuthor}
\begin{DoxyWarning}{Warning}
This procedure is {\ttfamily impure} when the library is compiled with macro {\ttfamily CHECK\+\_\+\+ENABLED=1}. By default, it is {\ttfamily pure} in {\ttfamily release} build and {\ttfamily impure} in {\ttfamily debug} and {\ttfamily testing} builds. 
\end{DoxyWarning}


Definition at line \mbox{\hyperlink{Sample__mod_8f90_source_l03063}{3063}} of file \mbox{\hyperlink{Sample__mod_8f90_source}{Sample\+\_\+mod.\+f90}}.

\mbox{\Hypertarget{namespaceSample__mod_afb2e3c5d56a87f0cadd6304ffee5d823}\label{namespaceSample__mod_afb2e3c5d56a87f0cadd6304ffee5d823}} 
\index{Sample\_mod@{Sample\_mod}!getCovLowFromCorUpp@{getCovLowFromCorUpp}}
\index{getCovLowFromCorUpp@{getCovLowFromCorUpp}!Sample\_mod@{Sample\_mod}}
\doxysubsubsection{\texorpdfstring{getCovLowFromCorUpp()}{getCovLowFromCorUpp()}}
{\footnotesize\ttfamily PURE real(RK) function, dimension(nd,nd) Sample\+\_\+mod\+::get\+Cov\+Low\+From\+Cor\+Upp (\begin{DoxyParamCaption}\item[{integer(IK), intent(in)}]{nd,  }\item[{real(RK)}]{Std\+Vec,  }\item[{real(RK)}]{Cor\+Upp }\end{DoxyParamCaption})}



Convert the upper-\/triangle correlation matrix to the lower-\/triangle covariance matrix. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em nd} & \+: The rank of the correlation matrix. \\
\hline
\mbox{\texttt{ in}}  & {\em Std\+Vec} & \+: The input standard deviation vector of length {\ttfamily nd}. \\
\hline
\mbox{\texttt{ in}}  & {\em Cor\+Upp} & \+: The upper-\/triangle correlation matrix. The lower-\/triangle will not be used.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
{\ttfamily Cov\+Low} \+: The lower triangle of the covariance matrix. The upper-\/triangle will NOT be set.
\end{DoxyReturn}
\begin{DoxyAuthor}{Author}
Amir Shahmoradi, Monday March 6, 2017, 3\+:22 pm, ICES, The University of Texas at Austin.
\end{DoxyAuthor}
\begin{DoxyWarning}{Warning}
This procedure is {\ttfamily impure} when the library is compiled with macro {\ttfamily CHECK\+\_\+\+ENABLED=1}. By default, it is {\ttfamily pure} in {\ttfamily release} build and {\ttfamily impure} in {\ttfamily debug} and {\ttfamily testing} builds. 
\end{DoxyWarning}


Definition at line \mbox{\hyperlink{Sample__mod_8f90_source_l03028}{3028}} of file \mbox{\hyperlink{Sample__mod_8f90_source}{Sample\+\_\+mod.\+f90}}.

\mbox{\Hypertarget{namespaceSample__mod_a9a540e0c59a19fedbcc311a5530617eb}\label{namespaceSample__mod_a9a540e0c59a19fedbcc311a5530617eb}} 
\index{Sample\_mod@{Sample\_mod}!getCovMatFromCorUpp@{getCovMatFromCorUpp}}
\index{getCovMatFromCorUpp@{getCovMatFromCorUpp}!Sample\_mod@{Sample\_mod}}
\doxysubsubsection{\texorpdfstring{getCovMatFromCorUpp()}{getCovMatFromCorUpp()}}
{\footnotesize\ttfamily PURE real(RK) function, dimension(nd,nd) Sample\+\_\+mod\+::get\+Cov\+Mat\+From\+Cor\+Upp (\begin{DoxyParamCaption}\item[{integer(IK), intent(in)}]{nd,  }\item[{real(RK)}]{Std\+Vec,  }\item[{real(RK)}]{Cor\+Upp }\end{DoxyParamCaption})}



Convert the input correlation matrix to the output covariance matrix. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em nd} & \+: The rank of the correlation matrix. \\
\hline
\mbox{\texttt{ in}}  & {\em Std\+Vec} & \+: The input standard deviation vector of length {\ttfamily nd}. \\
\hline
\mbox{\texttt{ in}}  & {\em Cor\+Upp} & \+: The upper-\/triangle correlation matrix. The lower-\/triangle will not be used.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
{\ttfamily Cov\+Mat\+Full} \+: The full covariance matrix.
\end{DoxyReturn}
\begin{DoxyAuthor}{Author}
Amir Shahmoradi, Monday March 6, 2017, 3\+:22 pm, ICES, The University of Texas at Austin.
\end{DoxyAuthor}
\begin{DoxyWarning}{Warning}
This procedure is {\ttfamily impure} when the library is compiled with macro {\ttfamily CHECK\+\_\+\+ENABLED=1}. By default, it is {\ttfamily pure} in {\ttfamily release} build and {\ttfamily impure} in {\ttfamily debug} and {\ttfamily testing} builds. 
\end{DoxyWarning}


Definition at line \mbox{\hyperlink{Sample__mod_8f90_source_l03098}{3098}} of file \mbox{\hyperlink{Sample__mod_8f90_source}{Sample\+\_\+mod.\+f90}}.

\mbox{\Hypertarget{namespaceSample__mod_a5f2a3ba527c41a88f8afefabf3385a9e}\label{namespaceSample__mod_a5f2a3ba527c41a88f8afefabf3385a9e}} 
\index{Sample\_mod@{Sample\_mod}!getMeanCov@{getMeanCov}}
\index{getMeanCov@{getMeanCov}!Sample\_mod@{Sample\_mod}}
\doxysubsubsection{\texorpdfstring{getMeanCov()}{getMeanCov()}}
{\footnotesize\ttfamily subroutine Sample\+\_\+mod\+::get\+Mean\+Cov (\begin{DoxyParamCaption}\item[{integer(IK), intent(in)}]{np,  }\item[{integer(IK), intent(in)}]{nd,  }\item[{real(RK)}]{Sample,  }\item[{real(RK)}]{Cov\+Mat,  }\item[{real(RK)}]{Mean,  }\item[{real(RK)}]{Mahal\+Sq,  }\item[{real(RK)}]{Inv\+Cov\+Mat,  }\item[{real(RK)}]{sqrt\+Det\+Inv\+Cov\+Mat }\end{DoxyParamCaption})}



Return the sample mean, covariance matrix, the Mahalanobis distances squared of the points with respect to the sample, and the square root of the determinant of the inverse covariance matrix of the sample. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em nd} & \+: The number of dimensions of the input sample. \\
\hline
\mbox{\texttt{ in}}  & {\em np} & \+: The number of points in the sample. \\
\hline
\mbox{\texttt{ in}}  & {\em Sample} & \+: The array of shape {\ttfamily (np,nd)} containing the sample. \\
\hline
\mbox{\texttt{ out}}  & {\em Cov\+Mat} & \+: The output matrix of shape {\ttfamily (nd,nd)} representing the covariance matrix of the input data. \\
\hline
\mbox{\texttt{ out}}  & {\em Mean} & \+: The output mean vector of the sample. \\
\hline
\mbox{\texttt{ out}}  & {\em Mahal\+Sq} & \+: The output Mahalanobis distances squared of the points with respect to the sample ({\bfseries{optional}}). \\
\hline
\mbox{\texttt{ out}}  & {\em Inv\+Cov\+Mat} & \+: The output inverse covariance matrix of the input data ({\bfseries{optional}}). \\
\hline
\mbox{\texttt{ out}}  & {\em sqrt\+Det\+Inv\+Cov\+Mat} & \+: The output square root of the determinant of the inverse covariance matrix of the sample ({\bfseries{optional}}).\\
\hline
\end{DoxyParams}
\begin{DoxyWarning}{Warning}
If {\ttfamily sqrt\+Det\+Inv\+Cov\+Mat} is present, then {\ttfamily Mahal\+Sq} and {\ttfamily Inv\+Cov\+Mat} must be also present.
\end{DoxyWarning}
\begin{DoxyRemark}{Remarks}
Note the shape of the input {\ttfamily Sample(np,nd)}.
\end{DoxyRemark}
\begin{DoxyNote}{Note}
For more information, see Geisser \& Cornfield (1963) \char`\"{}\+Posterior distributions for multivariate normal parameters\char`\"{}. Also, Box and Tiao (1973), \char`\"{}\+Bayesian Inference in Statistical Analysis\char`\"{} Page 421.
\end{DoxyNote}
\begin{DoxySeeAlso}{See also}
\mbox{\hyperlink{namespaceSample__mod_ab54f1da8d61065ad511b74648331cdab}{get\+Mean\+Cov\+Trans}}
\end{DoxySeeAlso}
\begin{DoxyRemark}{Remarks}
For details of naming abbreviations, see \mbox{\hyperlink{index_ParaMonteAbbreviationGuidlines}{this page}}. 

For details of the naming conventions, see \mbox{\hyperlink{index_ParaMonteNamingConventions}{this page}}. 

This software is distributed under the MIT-\/license. If you use any parts or concepts originated from this library, please acknowledge the usage by citing the \href{https://www.cdslab.org/paramonte/notes/overview/preface/\#how-to-acknowledge-the-use-of-the-paramonte-library-in-your-work}{\texttt{ {\bfseries{publications of the Para\+Monte library}}}}.~\newline

\end{DoxyRemark}
\begin{DoxyAuthor}{Author}
Amir Shahmoradi, Oct 16, 2009, 11\+:14 AM, Michigan 
\end{DoxyAuthor}


Definition at line \mbox{\hyperlink{Sample__mod_8f90_source_l02440}{2440}} of file \mbox{\hyperlink{Sample__mod_8f90_source}{Sample\+\_\+mod.\+f90}}.

\mbox{\Hypertarget{namespaceSample__mod_ab54f1da8d61065ad511b74648331cdab}\label{namespaceSample__mod_ab54f1da8d61065ad511b74648331cdab}} 
\index{Sample\_mod@{Sample\_mod}!getMeanCovTrans@{getMeanCovTrans}}
\index{getMeanCovTrans@{getMeanCovTrans}!Sample\_mod@{Sample\_mod}}
\doxysubsubsection{\texorpdfstring{getMeanCovTrans()}{getMeanCovTrans()}}
{\footnotesize\ttfamily PURE subroutine Sample\+\_\+mod\+::get\+Mean\+Cov\+Trans (\begin{DoxyParamCaption}\item[{integer(IK), intent(in)}]{np,  }\item[{integer(IK), intent(in)}]{nd,  }\item[{real(RK)}]{Sample,  }\item[{real(RK)}]{Cov\+Mat,  }\item[{real(RK)}]{Mean,  }\item[{real(RK)}]{Mahal\+Sq,  }\item[{real(RK)}]{Inv\+Cov\+Mat,  }\item[{real(RK)}]{sqrt\+Det\+Inv\+Cov\+Mat }\end{DoxyParamCaption})}



Return the sample mean, covariance matrix, the Mahalanobis distances squared of the points with respect to the sample, and the square root of the determinant of the inverse covariance matrix of the sample. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em nd} & \+: The number of dimensions of the input sample. \\
\hline
\mbox{\texttt{ in}}  & {\em np} & \+: The number of points in the sample. \\
\hline
\mbox{\texttt{ in}}  & {\em Sample} & \+: The array of shape {\ttfamily (nd,np)} containing the sample. \\
\hline
\mbox{\texttt{ out}}  & {\em Cov\+Mat} & \+: The output matrix of shape {\ttfamily (nd,nd)} representing the covariance matrix of the input data. \\
\hline
\mbox{\texttt{ out}}  & {\em Mean} & \+: The output mean vector of the sample. \\
\hline
\mbox{\texttt{ out}}  & {\em Mahal\+Sq} & \+: The output Mahalanobis distances squared of the points with respect to the sample ({\bfseries{optional}}). \\
\hline
\mbox{\texttt{ out}}  & {\em Inv\+Cov\+Mat} & \+: The output inverse covariance matrix of the input data ({\bfseries{optional}}). \\
\hline
\mbox{\texttt{ out}}  & {\em sqrt\+Det\+Inv\+Cov\+Mat} & \+: The output square root of the determinant of the inverse covariance matrix of the sample ({\bfseries{optional}}).\\
\hline
\end{DoxyParams}
\begin{DoxyWarning}{Warning}
If {\ttfamily sqrt\+Det\+Inv\+Cov\+Mat} is present, then {\ttfamily Mahal\+Sq} and {\ttfamily Inv\+Cov\+Mat} must be also present.
\end{DoxyWarning}
\begin{DoxyRemark}{Remarks}
Note the shape of the input {\ttfamily Sample(nd,np)}.

This subroutine has the same functionality as \mbox{\hyperlink{namespaceSample__mod_a5f2a3ba527c41a88f8afefabf3385a9e}{get\+Mean\+Cov}}, with the only difference that input data is transposed here on input. Based on the preliminary benchmarks with Intel 2017 ifort, {\ttfamily \mbox{\hyperlink{namespaceSample__mod_a5f2a3ba527c41a88f8afefabf3385a9e}{get\+Mean\+Cov()}}} is slightly faster than {\ttfamily \mbox{\hyperlink{namespaceSample__mod_ab54f1da8d61065ad511b74648331cdab}{get\+Mean\+Cov\+Trans()}}}.
\end{DoxyRemark}
\begin{DoxyNote}{Note}
For more information, see Geisser \& Cornfield (1963) \char`\"{}\+Posterior distributions for multivariate normal parameters\char`\"{}. Also, Box and Tiao (1973), \char`\"{}\+Bayesian Inference in Statistical Analysis\char`\"{} Page 421.
\end{DoxyNote}
\begin{DoxyAuthor}{Author}
Amir Shahmoradi, Oct 16, 2009, 11\+:14 AM, Michigan
\end{DoxyAuthor}
\begin{DoxyWarning}{Warning}
This procedure is {\ttfamily impure} when the library is compiled with macro {\ttfamily CHECK\+\_\+\+ENABLED=1}. By default, it is {\ttfamily pure} in {\ttfamily release} build and {\ttfamily impure} in {\ttfamily debug} and {\ttfamily testing} builds. 
\end{DoxyWarning}


Definition at line \mbox{\hyperlink{Sample__mod_8f90_source_l02525}{2525}} of file \mbox{\hyperlink{Sample__mod_8f90_source}{Sample\+\_\+mod.\+f90}}.

\mbox{\Hypertarget{namespaceSample__mod_ae9487a1bd8fb8e417b2ad4b193e63c41}\label{namespaceSample__mod_ae9487a1bd8fb8e417b2ad4b193e63c41}} 
\index{Sample\_mod@{Sample\_mod}!getMeanCovUppTrans@{getMeanCovUppTrans}}
\index{getMeanCovUppTrans@{getMeanCovUppTrans}!Sample\_mod@{Sample\_mod}}
\doxysubsubsection{\texorpdfstring{getMeanCovUppTrans()}{getMeanCovUppTrans()}}
{\footnotesize\ttfamily subroutine Sample\+\_\+mod\+::get\+Mean\+Cov\+Upp\+Trans (\begin{DoxyParamCaption}\item[{integer(IK), intent(in)}]{nd,  }\item[{integer(IK), intent(in)}]{np,  }\item[{real(RK)}]{Sample,  }\item[{real(RK)}]{Cov\+Upp,  }\item[{real(RK)}]{Mean }\end{DoxyParamCaption})}



Return the sample mean and the upper triangle of the covariance matrix of the input sample. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em nd} & \+: The number of dimensions of the input sample. \\
\hline
\mbox{\texttt{ in}}  & {\em np} & \+: The number of points in the sample. \\
\hline
\mbox{\texttt{ in}}  & {\em Sample} & \+: The array of shape {\ttfamily (nd,np)} containing the sample. \\
\hline
\mbox{\texttt{ out}}  & {\em Cov\+Upp} & \+: The output matrix of shape {\ttfamily (nd,nd)} whose upper triangle represents the covariance matrix of the input data. \\
\hline
\mbox{\texttt{ out}}  & {\em Mean} & \+: The output mean vector of the sample.\\
\hline
\end{DoxyParams}
\begin{DoxyRemark}{Remarks}
Note the shape of the input {\ttfamily Sample(nd,np)}.

This subroutine has the same functionality as \mbox{\hyperlink{namespaceSample__mod_ab54f1da8d61065ad511b74648331cdab}{get\+Mean\+Cov\+Trans}}, with the only difference only the upper triangle of the covariance matrix is returned. Also, optional arguments are not available. This subroutine is specifically optimized for use in the Para\+Monte samplers.
\end{DoxyRemark}
\begin{DoxyNote}{Note}
For more information, see Geisser \& Cornfield (1963) \char`\"{}\+Posterior distributions for multivariate normal parameters\char`\"{}. Also, Box and Tiao (1973), \char`\"{}\+Bayesian Inference in Statistical Analysis\char`\"{} Page 421.
\end{DoxyNote}
\begin{DoxyAuthor}{Author}
Amir Shahmoradi, Oct 16, 2009, 11\+:14 AM, Michigan 
\end{DoxyAuthor}


Definition at line \mbox{\hyperlink{Sample__mod_8f90_source_l02601}{2601}} of file \mbox{\hyperlink{Sample__mod_8f90_source}{Sample\+\_\+mod.\+f90}}.

\mbox{\Hypertarget{namespaceSample__mod_a69fe9bd0741ff89ecef392e6c4df1308}\label{namespaceSample__mod_a69fe9bd0741ff89ecef392e6c4df1308}} 
\index{Sample\_mod@{Sample\_mod}!getMeanCovUppTransWeighted@{getMeanCovUppTransWeighted}}
\index{getMeanCovUppTransWeighted@{getMeanCovUppTransWeighted}!Sample\_mod@{Sample\_mod}}
\doxysubsubsection{\texorpdfstring{getMeanCovUppTransWeighted()}{getMeanCovUppTransWeighted()}}
{\footnotesize\ttfamily PURE subroutine Sample\+\_\+mod\+::get\+Mean\+Cov\+Upp\+Trans\+Weighted (\begin{DoxyParamCaption}\item[{integer(IK), intent(in)}]{nd,  }\item[{integer(IK), intent(in)}]{np,  }\item[{real(RK)}]{Sample,  }\item[{real(RK)}]{Cov\+Upp,  }\item[{real(RK)}]{Mean,  }\item[{integer(IK)}]{Weight,  }\item[{integer(IK)}]{sum\+Weight }\end{DoxyParamCaption})}



Return the mean and the upper triangle of the covariance matrix of the input {\itshape weighted} sample. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em nd} & \+: The number of dimensions of the input sample. \\
\hline
\mbox{\texttt{ in}}  & {\em np} & \+: The number of points in the sample. \\
\hline
\mbox{\texttt{ in}}  & {\em Sample} & \+: The array of shape {\ttfamily (nd,np)} containing the sample. \\
\hline
\mbox{\texttt{ out}}  & {\em Cov\+Upp} & \+: The output matrix of shape {\ttfamily (nd,nd)} whose upper triangle represents the covariance matrix of the input data. \\
\hline
\mbox{\texttt{ out}}  & {\em Mean} & \+: The output mean vector of the sample. \\
\hline
\mbox{\texttt{ in}}  & {\em Weight} & \+: The integer array of length {\ttfamily np}, representing the weights of individual points in the sample. \\
\hline
\mbox{\texttt{ in}}  & {\em sum\+Weight} & \+: The sum of all sample weights.\\
\hline
\end{DoxyParams}
\begin{DoxyWarning}{Warning}
Note the shape of the input argument {\ttfamily Sample(nd,np)}.
\end{DoxyWarning}
\begin{DoxyRemark}{Remarks}
This subroutine has the same functionality as \mbox{\hyperlink{namespaceSample__mod_ae9487a1bd8fb8e417b2ad4b193e63c41}{get\+Mean\+Cov\+Upp\+Trans}}, with the only difference only the upper triangle of the covariance matrix is returned. Also, optional arguments are not available. This subroutine is specifically optimized for use in the Para\+Monte samplers.
\end{DoxyRemark}
\begin{DoxyNote}{Note}
For more information, see Geisser \& Cornfield (1963) \char`\"{}\+Posterior distributions for multivariate normal parameters\char`\"{}. Also, Box and Tiao (1973), \char`\"{}\+Bayesian Inference in Statistical Analysis\char`\"{} Page 421.
\end{DoxyNote}
\begin{DoxyAuthor}{Author}
Amir Shahmoradi, Oct 16, 2009, 11\+:14 AM, Michigan
\end{DoxyAuthor}
\begin{DoxyWarning}{Warning}
This procedure is {\ttfamily impure} when the library is compiled with macro {\ttfamily CHECK\+\_\+\+ENABLED=1}. By default, it is {\ttfamily pure} in {\ttfamily release} build and {\ttfamily impure} in {\ttfamily debug} and {\ttfamily testing} builds. 
\end{DoxyWarning}


Definition at line \mbox{\hyperlink{Sample__mod_8f90_source_l02665}{2665}} of file \mbox{\hyperlink{Sample__mod_8f90_source}{Sample\+\_\+mod.\+f90}}.

\mbox{\Hypertarget{namespaceSample__mod_a64b836f780040d4b71c0a63c77ea5231}\label{namespaceSample__mod_a64b836f780040d4b71c0a63c77ea5231}} 
\index{Sample\_mod@{Sample\_mod}!mergeMeanCov@{mergeMeanCov}}
\index{mergeMeanCov@{mergeMeanCov}!Sample\_mod@{Sample\_mod}}
\doxysubsubsection{\texorpdfstring{mergeMeanCov()}{mergeMeanCov()}}
{\footnotesize\ttfamily subroutine Sample\+\_\+mod\+::merge\+Mean\+Cov (\begin{DoxyParamCaption}\item[{integer(IK), intent(in)}]{nd,  }\item[{integer(IK)}]{npA,  }\item[{real(RK)}]{MeanA,  }\item[{real(RK)}]{Cov\+MatA,  }\item[{integer(IK)}]{npB,  }\item[{real(RK)}]{MeanB,  }\item[{real(RK)}]{Cov\+MatB,  }\item[{real(RK)}]{Mean\+AB,  }\item[{real(RK)}]{Cov\+Mat\+AB }\end{DoxyParamCaption})}



Given two input sample means and covariance matrices, return the combination of them as a single mean and covariance matrix. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em nd} & \+: The number of dimensions of the input sample. \\
\hline
\mbox{\texttt{ in}}  & {\em npA} & \+: The number of points in sample {\ttfamily A}. \\
\hline
\mbox{\texttt{ in}}  & {\em MeanA} & \+: The mean vector of sample {\ttfamily A}. \\
\hline
\mbox{\texttt{ in}}  & {\em Cov\+MatA} & \+: The covariance matrix of sample {\ttfamily A}. \\
\hline
\mbox{\texttt{ in}}  & {\em npB} & \+: The number of points in sample {\ttfamily B}. \\
\hline
\mbox{\texttt{ in}}  & {\em MeanB} & \+: The mean vector of sample {\ttfamily B}. \\
\hline
\mbox{\texttt{ in}}  & {\em Cov\+MatB} & \+: The covariance matrix of sample {\ttfamily B}. \\
\hline
\mbox{\texttt{ out}}  & {\em Mean\+AB} & \+: The output mean vector of the combined sample. \\
\hline
\mbox{\texttt{ out}}  & {\em Cov\+Mat\+AB} & \+: The output covariance matrix of the combined sample.\\
\hline
\end{DoxyParams}
\begin{DoxyRemark}{Remarks}
An exact implementation of this algorithm which needs only the upper triangles of the input matrices and yields only the upper triangle of the covariance matrix is given in \mbox{\hyperlink{namespaceSample__mod_ab6c8a951bf35c59402a30d6d17a6d193}{merge\+Mean\+Cov\+Upp}}. The alternative implementation is much more efficient, by a factor of 6-\/7 with all compiler optimization flags on.
\end{DoxyRemark}
\begin{DoxyAuthor}{Author}
Amir Shahmoradi, Oct 16, 2009, 11\+:14 AM, Michigan 
\end{DoxyAuthor}


Definition at line \mbox{\hyperlink{Sample__mod_8f90_source_l02735}{2735}} of file \mbox{\hyperlink{Sample__mod_8f90_source}{Sample\+\_\+mod.\+f90}}.

\mbox{\Hypertarget{namespaceSample__mod_ab6c8a951bf35c59402a30d6d17a6d193}\label{namespaceSample__mod_ab6c8a951bf35c59402a30d6d17a6d193}} 
\index{Sample\_mod@{Sample\_mod}!mergeMeanCovUpp@{mergeMeanCovUpp}}
\index{mergeMeanCovUpp@{mergeMeanCovUpp}!Sample\_mod@{Sample\_mod}}
\doxysubsubsection{\texorpdfstring{mergeMeanCovUpp()}{mergeMeanCovUpp()}}
{\footnotesize\ttfamily subroutine Sample\+\_\+mod\+::merge\+Mean\+Cov\+Upp (\begin{DoxyParamCaption}\item[{integer(IK), intent(in)}]{nd,  }\item[{integer(IK)}]{npA,  }\item[{real(RK)}]{MeanA,  }\item[{real(RK)}]{Cov\+UppA,  }\item[{integer(IK)}]{npB,  }\item[{real(RK)}]{MeanB,  }\item[{real(RK)}]{Cov\+UppB,  }\item[{real(RK)}]{Mean\+AB,  }\item[{real(RK)}]{Cov\+Upp\+AB }\end{DoxyParamCaption})}



Given two input sample means and covariance matrices, return the combination of them as a single mean and covariance matrix. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em nd} & \+: The number of dimensions of the input sample. \\
\hline
\mbox{\texttt{ in}}  & {\em npA} & \+: The number of points in sample {\ttfamily A}. \\
\hline
\mbox{\texttt{ in}}  & {\em MeanA} & \+: The mean vector of sample {\ttfamily A}. \\
\hline
\mbox{\texttt{ in}}  & {\em Cov\+UppA} & \+: The covariance matrix of sample {\ttfamily A}. \\
\hline
\mbox{\texttt{ in}}  & {\em npB} & \+: The number of points in sample {\ttfamily B}. \\
\hline
\mbox{\texttt{ in}}  & {\em MeanB} & \+: The mean vector of sample {\ttfamily B}. \\
\hline
\mbox{\texttt{ in}}  & {\em Cov\+UppB} & \+: The covariance matrix of sample {\ttfamily B}. \\
\hline
\mbox{\texttt{ out}}  & {\em Mean\+AB} & \+: The output mean vector of the combined sample. \\
\hline
\mbox{\texttt{ out}}  & {\em Cov\+Upp\+AB} & \+: The output covariance matrix of the combined sample.\\
\hline
\end{DoxyParams}
\begin{DoxyRemark}{Remarks}
This subroutine is the same as \mbox{\hyperlink{namespaceSample__mod_a64b836f780040d4b71c0a63c77ea5231}{merge\+Mean\+Cov}}, with the {\bfseries{important difference}} that only the upper triangles and diagonals of the input covariance matrices need to be given by the user\+: {\ttfamily Cov\+UppA}, {\ttfamily Cov\+UppB} This alternative implementation is 6-\/7 times faster, with all compiler optimization flags on. In addition, all computational coefficients are predefined in this implementation, resulting in an extra 10\%-\/15\% efficiency gain.
\end{DoxyRemark}
\begin{DoxyRefDesc}{Todo}
\item[\mbox{\hyperlink{todo__todo000020}{Todo}}]The efficiency of this algorithm might still be improved by converting the upper triangle covariance matrix to a packed vector.\end{DoxyRefDesc}


\begin{DoxyAuthor}{Author}
Amir Shahmoradi, Nov 24, 2020, 4\+:19 AM, Dallas, TX 
\end{DoxyAuthor}


Definition at line \mbox{\hyperlink{Sample__mod_8f90_source_l02794}{2794}} of file \mbox{\hyperlink{Sample__mod_8f90_source}{Sample\+\_\+mod.\+f90}}.

\mbox{\Hypertarget{namespaceSample__mod_a81524ddc27a48db65744d80cfad9b348}\label{namespaceSample__mod_a81524ddc27a48db65744d80cfad9b348}} 
\index{Sample\_mod@{Sample\_mod}!mergeMeanCovUppDense@{mergeMeanCovUppDense}}
\index{mergeMeanCovUppDense@{mergeMeanCovUppDense}!Sample\_mod@{Sample\_mod}}
\doxysubsubsection{\texorpdfstring{mergeMeanCovUppDense()}{mergeMeanCovUppDense()}}
{\footnotesize\ttfamily subroutine Sample\+\_\+mod\+::merge\+Mean\+Cov\+Upp\+Dense (\begin{DoxyParamCaption}\item[{integer(IK), intent(in)}]{nd,  }\item[{integer(IK)}]{npA,  }\item[{real(RK)}]{MeanA,  }\item[{real(RK)}]{Cov\+UppA,  }\item[{integer(IK)}]{npB,  }\item[{real(RK)}]{MeanB,  }\item[{real(RK)}]{Cov\+UppB }\end{DoxyParamCaption})}



Given two input sample means and covariance matrices, return the combination of them as a single mean and covariance matrix. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em nd} & \+: The number of dimensions of the input sample. \\
\hline
\mbox{\texttt{ in}}  & {\em npA} & \+: The number of points in sample {\ttfamily A}. \\
\hline
\mbox{\texttt{ in}}  & {\em MeanA} & \+: The mean vector of sample {\ttfamily A}. \\
\hline
\mbox{\texttt{ in}}  & {\em Cov\+UppA} & \+: The covariance matrix of sample {\ttfamily A}. \\
\hline
\mbox{\texttt{ in}}  & {\em npB} & \+: The number of points in sample {\ttfamily B}. \\
\hline
\mbox{\texttt{ in,out}}  & {\em MeanB} & \+: The mean vector of sample {\ttfamily B}. \\
\hline
\mbox{\texttt{ in,out}}  & {\em Cov\+UppB} & \+: The covariance matrix of sample {\ttfamily B}.\\
\hline
\end{DoxyParams}
\begin{DoxyRemark}{Remarks}
This subroutine is the same as \mbox{\hyperlink{namespaceSample__mod_ab6c8a951bf35c59402a30d6d17a6d193}{merge\+Mean\+Cov\+Upp}}, with the {\bfseries{important difference}} that the resulting output mean and covariance matrices are written to the input arguments {\ttfamily MeanB}, {\ttfamily Cov\+UppB}. This alternative implementation results in another extra 15\%-\/20\% efficiency gain. This result is based on the benchmarks with Intel Fortran compiler 19.\+4 with all compiler optimization flags on.
\end{DoxyRemark}
\begin{DoxyRefDesc}{Todo}
\item[\mbox{\hyperlink{todo__todo000021}{Todo}}]The efficiency of this algorithm might still be improved by converting the upper triangle covariance matrix to a packed vector.\end{DoxyRefDesc}


\begin{DoxyAuthor}{Author}
Amir Shahmoradi, Nov 25, 2020, 1\+:00 AM, Dallas, TX 
\end{DoxyAuthor}


Definition at line \mbox{\hyperlink{Sample__mod_8f90_source_l02862}{2862}} of file \mbox{\hyperlink{Sample__mod_8f90_source}{Sample\+\_\+mod.\+f90}}.

\mbox{\Hypertarget{namespaceSample__mod_ae3f7288e349a6a7f5150a35a96194361}\label{namespaceSample__mod_ae3f7288e349a6a7f5150a35a96194361}} 
\index{Sample\_mod@{Sample\_mod}!transform\_1D@{transform\_1D}}
\index{transform\_1D@{transform\_1D}!Sample\_mod@{Sample\_mod}}
\doxysubsubsection{\texorpdfstring{transform\_1D()}{transform\_1D()}}
{\footnotesize\ttfamily pure real(RK) function, dimension(\+:), allocatable Sample\+\_\+mod\+::transform\+\_\+1D (\begin{DoxyParamCaption}\item[{real(RK)}]{Point,  }\item[{real(RK)}]{Cho\+Low,  }\item[{real(RK)}]{Cho\+Dia }\end{DoxyParamCaption})}



Return the transformed sample according to the input Cholesky factorization. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em Point} & \+: The input contiguous data points of shape {\ttfamily (\+:)} that is to be transformed. \\
\hline
\mbox{\texttt{ in}}  & {\em Cho\+Low} & \+: The lower Cholesky factorization of shape {\ttfamily (nd,nd)} with which the input point must be transformed. \\
\hline
\mbox{\texttt{ in}}  & {\em Cho\+Dia} & \+: The input diagonal elements of the Cholesky factorization of the transformation. ({\bfseries{optional}}, if not provided, the procedure assumes that the diagonal elements are given in {\ttfamily Cho\+Low})\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
{\ttfamily Tran\+Point} \+: The output transformed point based on the input Cholesky factorization.
\end{DoxyReturn}
\begin{DoxyAuthor}{Author}
Amir Shahmoradi, Monday 4\+:00 AM, August 23, 2021, Dallas, TX 
\end{DoxyAuthor}


Definition at line \mbox{\hyperlink{Sample__mod_8f90_source_l03236}{3236}} of file \mbox{\hyperlink{Sample__mod_8f90_source}{Sample\+\_\+mod.\+f90}}.

\mbox{\Hypertarget{namespaceSample__mod_a864d7c57c9dbfac5186cdc337985d48e}\label{namespaceSample__mod_a864d7c57c9dbfac5186cdc337985d48e}} 
\index{Sample\_mod@{Sample\_mod}!transform\_2D@{transform\_2D}}
\index{transform\_2D@{transform\_2D}!Sample\_mod@{Sample\_mod}}
\doxysubsubsection{\texorpdfstring{transform\_2D()}{transform\_2D()}}
{\footnotesize\ttfamily PURE real(RK) function, dimension(\+:,\+:), allocatable Sample\+\_\+mod\+::transform\+\_\+2D (\begin{DoxyParamCaption}\item[{real(RK)}]{Sample,  }\item[{real(RK)}]{Cho\+Low,  }\item[{real(RK)}]{Cho\+Dia,  }\item[{integer(IK), intent(in), optional}]{dim,  }\item[{logical, intent(in), optional}]{tenabled }\end{DoxyParamCaption})}



Return the transformed sample according to the input Cholesky factorization. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em Sample} & \+: The contiguous array of data points of shape {\ttfamily (\+:,\+:)} normalized to their mean vector. By default, the shape of {\ttfamily Sample} is assumed to be {\ttfamily (nd,np)} unless {\ttfamily dim = 1}. \\
\hline
\mbox{\texttt{ in}}  & {\em Cho\+Low} & \+: The input lower-\/triangle Cholesky factorization of shape {\ttfamily (nd,nd)} with which the input sample must be transformed. \\
\hline
\mbox{\texttt{ in}}  & {\em Cho\+Dia} & \+: The input diagonal elements of the Cholesky factorization of the transformation. ({\bfseries{optional}}, if not provided, the procedure assumes that the diagonal elements are given in {\ttfamily Cho\+Low}) \\
\hline
\mbox{\texttt{ in}}  & {\em dim} & \+: The dimension of the input {\ttfamily Sample} along which individual data exist ({\bfseries{optional}}, default = {\ttfamily 2\+\_\+\+IK}). \\
\hline
\mbox{\texttt{ in}}  & {\em tenabled} & \+: A logical input. If {\ttfamily .true.}, the output transformed sample will have the transposed shape of the input {\ttfamily Sample}. ({\bfseries{optional}}, default = {\ttfamily .false.}).\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
{\ttfamily Tran\+Sample} \+: The output transformed sample based on the input Cholesky factorization.
\end{DoxyReturn}
\begin{DoxyAuthor}{Author}
Amir Shahmoradi, Thursday 2\+:45 AM, August 19, 2021, Dallas, TX
\end{DoxyAuthor}
\begin{DoxyWarning}{Warning}
This procedure is {\ttfamily impure} when the library is compiled with macro {\ttfamily CHECK\+\_\+\+ENABLED=1}. By default, it is {\ttfamily pure} in {\ttfamily release} build and {\ttfamily impure} in {\ttfamily debug} and {\ttfamily testing} builds. 
\end{DoxyWarning}


Definition at line \mbox{\hyperlink{Sample__mod_8f90_source_l03138}{3138}} of file \mbox{\hyperlink{Sample__mod_8f90_source}{Sample\+\_\+mod.\+f90}}.



\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{namespaceSample__mod_a09a467371587c98f96236755496f7f13}\label{namespaceSample__mod_a09a467371587c98f96236755496f7f13}} 
\index{Sample\_mod@{Sample\_mod}!MODULE\_NAME@{MODULE\_NAME}}
\index{MODULE\_NAME@{MODULE\_NAME}!Sample\_mod@{Sample\_mod}}
\doxysubsubsection{\texorpdfstring{MODULE\_NAME}{MODULE\_NAME}}
{\footnotesize\ttfamily character(len=$\ast$), parameter Sample\+\_\+mod\+::\+MODULE\+\_\+\+NAME = \char`\"{}@Sample\+\_\+mod\char`\"{}}



Definition at line \mbox{\hyperlink{Sample__mod_8f90_source_l00060}{60}} of file \mbox{\hyperlink{Sample__mod_8f90_source}{Sample\+\_\+mod.\+f90}}.

