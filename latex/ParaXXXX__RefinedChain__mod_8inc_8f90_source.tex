\hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source}{}\doxysection{Para\+XXXX\+\_\+\+Refined\+Chain\+\_\+mod.\+inc.\+f90}
\label{ParaXXXX__RefinedChain__mod_8inc_8f90_source}\index{D:/Dropbox/Projects/20180101\_ParaMonte/git/src/kernel/ParaXXXX\_RefinedChain\_mod.inc.f90@{D:/Dropbox/Projects/20180101\_ParaMonte/git/src/kernel/ParaXXXX\_RefinedChain\_mod.inc.f90}}
\mbox{\hyperlink{ParaXXXX__RefinedChain__mod_8inc_8f90}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00001}00001 \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00002}00002 \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00003}00003 \textcolor{comment}{!!!!}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00004}00004 \textcolor{comment}{!!!!   MIT License}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00005}00005 \textcolor{comment}{!!!!}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00006}00006 \textcolor{comment}{!!!!   ParaMonte: plain powerful parallel Monte Carlo library.}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00007}00007 \textcolor{comment}{!!!!}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00008}00008 \textcolor{comment}{!!!!   Copyright (C) 2012-\/present, The Computational Data Science Lab}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00009}00009 \textcolor{comment}{!!!!}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00010}00010 \textcolor{comment}{!!!!   This file is part of the ParaMonte library.}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00011}00011 \textcolor{comment}{!!!!}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00012}00012 \textcolor{comment}{!!!!   Permission is hereby granted, free of charge, to any person obtaining a}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00013}00013 \textcolor{comment}{!!!!   copy of this software and associated documentation files (the "{}Software"{}),}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00014}00014 \textcolor{comment}{!!!!   to deal in the Software without restriction, including without limitation}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00015}00015 \textcolor{comment}{!!!!   the rights to use, copy, modify, merge, publish, distribute, sublicense,}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00016}00016 \textcolor{comment}{!!!!   and/or sell copies of the Software, and to permit persons to whom the}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00017}00017 \textcolor{comment}{!!!!   Software is furnished to do so, subject to the following conditions:}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00018}00018 \textcolor{comment}{!!!!}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00019}00019 \textcolor{comment}{!!!!   The above copyright notice and this permission notice shall be}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00020}00020 \textcolor{comment}{!!!!   included in all copies or substantial portions of the Software.}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00021}00021 \textcolor{comment}{!!!!}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00022}00022 \textcolor{comment}{!!!!   THE SOFTWARE IS PROVIDED "{}AS IS"{}, WITHOUT WARRANTY OF ANY KIND,}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00023}00023 \textcolor{comment}{!!!!   EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00024}00024 \textcolor{comment}{!!!!   MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00025}00025 \textcolor{comment}{!!!!   IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00026}00026 \textcolor{comment}{!!!!   DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00027}00027 \textcolor{comment}{!!!!   OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00028}00028 \textcolor{comment}{!!!!   OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00029}00029 \textcolor{comment}{!!!!}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00030}00030 \textcolor{comment}{!!!!   ACKNOWLEDGMENT}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00031}00031 \textcolor{comment}{!!!!}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00032}00032 \textcolor{comment}{!!!!   ParaMonte is an honor-\/ware and its currency is acknowledgment and citations.}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00033}00033 \textcolor{comment}{!!!!   As per the ParaMonte library license agreement terms, if you use any parts of}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00034}00034 \textcolor{comment}{!!!!   this library for any purposes, kindly acknowledge the use of ParaMonte in your}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00035}00035 \textcolor{comment}{!!!!   work (education/research/industry/development/...) by citing the ParaMonte}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00036}00036 \textcolor{comment}{!!!!   library as described on this page:}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00037}00037 \textcolor{comment}{!!!!}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00038}00038 \textcolor{comment}{!!!!       https://github.com/cdslaborg/paramonte/blob/main/ACKNOWLEDGMENT.md}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00039}00039 \textcolor{comment}{!!!!}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00040}00040 \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00041}00041 \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00042}00042 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00045}00045 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00046}00046 \textcolor{preprocessor}{\#if defined PARADRAM}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00047}00047 \textcolor{preprocessor}{}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00048}00048 \textcolor{preprocessor}{\#define ParaXXXX\_ChainFileContents\_mod ParaDRAM\_ChainFileContents\_mod}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00049}00049 \textcolor{preprocessor}{}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00050}00050 \textcolor{preprocessor}{\#elif defined PARADISE}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00051}00051 \textcolor{preprocessor}{}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00052}00052 \textcolor{preprocessor}{\#define ParaXXXX\_ChainFileContents\_mod ParaDISE\_ChainFileContents\_mod}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00053}00053 \textcolor{preprocessor}{}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00054}00054 \textcolor{preprocessor}{\#elif defined PARANEST}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00055}00055 \textcolor{preprocessor}{}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00056}00056 \textcolor{preprocessor}{\#define ParaXXXX\_ChainFileContents\_mod ParaNest\_ChainFileContents\_mod}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00057}00057 \textcolor{preprocessor}{}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00058}00058 \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00059}00059 \textcolor{preprocessor}{}\textcolor{preprocessor}{\#error "{}Unrecognized sampler in ParaXXXX\_RefinedChain\_mod.inc.f90"{}}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00060}00060 \textcolor{preprocessor}{}\textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00061}00061 \textcolor{preprocessor}{}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00062}00062 \textcolor{comment}{! module ParaMCMC\_RefinedChain\_mod}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00063}00063 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00064}00064     \textcolor{keywordtype}{use }\mbox{\hyperlink{namespacespecmcmc__samplerefinementmethod__mod}{specmcmc\_samplerefinementmethod\_mod}}, \textcolor{keywordtype}{only}: \mbox{\hyperlink{namespacespecmcmc__samplerefinementmethod__mod_a7db9c2c01c2aed101077d5aef54f487a}{batch\_means\_method\_name}}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00065}00065     \textcolor{keywordtype}{use }\mbox{\hyperlink{namespacespecmcmc__samplerefinementmethod__mod}{specmcmc\_samplerefinementmethod\_mod}}, \textcolor{keywordtype}{only}: \mbox{\hyperlink{namespacespecmcmc__samplerefinementmethod__mod_abbffa351f70fa8da64d9773a91f1a175}{cutoff\_autocorr\_method\_name}}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00066}00066     \textcolor{keywordtype}{use }\mbox{\hyperlink{namespacespecmcmc__samplerefinementmethod__mod}{specmcmc\_samplerefinementmethod\_mod}}, \textcolor{keywordtype}{only}: \mbox{\hyperlink{namespacespecmcmc__samplerefinementmethod__mod_afbcf92cdc7dd72757cacae95e29be4aa}{max\_cumsum\_autocorr\_method\_name}}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00067}00067     \textcolor{keywordtype}{use }paraxxxx\_chainfilecontents\_mod, \textcolor{keywordtype}{only}: count\_type}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00068}00068     \textcolor{keywordtype}{use }\mbox{\hyperlink{namespacejaggedarray__mod}{jaggedarray\_mod}}, \textcolor{keywordtype}{only}: \mbox{\hyperlink{structjaggedarray__mod_1_1charvec__type}{charvec\_type}}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00069}00069     \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceconstants__mod}{constants\_mod}}, \textcolor{keywordtype}{only}: ik, rk}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00070}00070     \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceerr__mod}{err\_mod}}, \textcolor{keywordtype}{only}: \mbox{\hyperlink{structerr__mod_1_1err__type}{err\_type}}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00071}00071 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00072}00072     \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00073}00073 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00074}00074     \textcolor{keywordtype}{character(*)}, \textcolor{keywordtype}{parameter} :: MODULE\_NAME = \textcolor{stringliteral}{"{}@paramCMCRefinedChain\_mod"{}}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00075}00075 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00077}00077     \textcolor{keyword}{type}                                    :: refinedchain\_type}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00078}00078         \textcolor{keywordtype}{integer(IK)}                         :: ndim  = 0\_ik         \textcolor{comment}{! number of sampling variables}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00079}00079         \textcolor{keywordtype}{integer(IK)}                         :: numRefinement = 0\_ik \textcolor{comment}{! number of refinements, zero if sample size is prescribed by the user}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00080}00080         \textcolor{keywordtype}{type}(Count\_type)    , \textcolor{keywordtype}{allocatable}   :: Count(:)             \textcolor{comment}{! compact and verbose counts}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00081}00081 \textcolor{keywordtype}{        real}(RK)            , \textcolor{keywordtype}{allocatable}   :: IAC(:,:)             \textcolor{comment}{! size of (ndim,0:numRefinement): The Integrated AutoCorrelation Time at each refinement stage}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00082}00082 \textcolor{keywordtype}{        real}(RK)            , \textcolor{keywordtype}{allocatable}   :: LogFuncState(:,:)    \textcolor{comment}{! size of (ndim,Count\%compact): LogFuncState is LogFunc + Variables}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00083}00083         \textcolor{keywordtype}{integer(IK)}         , \textcolor{keywordtype}{allocatable}   :: Weight(:)            \textcolor{comment}{! size of (Count\%compact): Weight of each state}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00084}00084         \textcolor{keywordtype}{type}(CharVec\_type)  , \textcolor{keywordtype}{allocatable}   :: ColHeader(:)         \textcolor{comment}{! refined sample column headers}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00085}00085         \textcolor{keywordtype}{type}(Err\_type)                      :: Err}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00086}00086     \textcolor{keyword}{contains}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00087}00087         \textcolor{keywordtype}{procedure}, pass :: get => getrefinedchain}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00088}00088         \textcolor{keywordtype}{procedure}, pass :: write => writerefinedchain}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00089}00089     \textcolor{keyword}{end type }refinedchain\_type}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00090}00090 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00091}00091    \textcolor{keyword}{type} method\_type}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00092}00092        \textcolor{keywordtype}{logical} :: isMax = .false.}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00093}00093        \textcolor{keywordtype}{logical} :: isMed = .false.}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00094}00094        \textcolor{keywordtype}{logical} :: isMin = .false.}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00095}00095        \textcolor{keywordtype}{logical} :: isAvg = .false.}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00096}00096        \textcolor{keywordtype}{logical} :: isBatchMeans = .false.}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00097}00097        \textcolor{keywordtype}{logical} :: isCutoffAutoCorr = .false.}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00098}00098        \textcolor{keywordtype}{logical} :: isViaCompactChain = .true.}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00099}00099        \textcolor{keywordtype}{logical} :: isViaVerboseChain = .true.}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00100}00100        \textcolor{keywordtype}{logical} :: isMaxCumSumAutoCorr = .false.}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00101}00101    \textcolor{keyword}{end type }method\_type}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00102}00102 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00103}00103 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00104}00104 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00105}00105 \textcolor{keyword}{contains}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00106}00106 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00107}00107 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00108}00108 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00123}00123     \textcolor{keyword}{subroutine }getrefinedchain  ( RefinedChain              \&}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00124}00124                                 , CFC                       \&}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00125}00125                                 , Err                       \&}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00126}00126                                 , burninLoc                 \&}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00127}00127                                 , refinedChainSize          \&}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00128}00128                                 , sampleRefinementCount     \&}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00129}00129                                 , sampleRefinementMethod    \&}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00130}00130                                 )}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00131}00131 \textcolor{preprocessor}{\#if INTEL\_COMPILER\_ENABLED \&\& defined DLL\_ENABLED \&\& (OS\_IS\_WINDOWS || defined OS\_IS\_DARWIN)}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00132}00132 \textcolor{preprocessor}{}        \textcolor{comment}{!DEC\$ ATTRIBUTES DLLEXPORT :: getRefinedChain}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00133}00133 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00134}00134 \textcolor{preprocessor}{}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00135}00135         use, \textcolor{keywordtype}{intrinsic} :: iso\_fortran\_env, only: output\_unit}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00136}00136         \textcolor{keywordtype}{use }paraxxxx\_chainfilecontents\_mod, \textcolor{keywordtype}{only}: chainfilecontents\_type, num\_def\_col}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00137}00137         \textcolor{keywordtype}{use }\mbox{\hyperlink{namespacecrosscorr__mod}{crosscorr\_mod}}, \textcolor{keywordtype}{only}: \mbox{\hyperlink{namespacecrosscorr__mod_ac2e66e35e953f6c5316efda112d31f51}{getbatchmeansiac}}, \mbox{\hyperlink{namespacecrosscorr__mod_a78147c2832004c7fbe119deace29426b}{getcumsumiac}}, \mbox{\hyperlink{namespacecrosscorr__mod_a7c41461ec6430b3c4cc42a174f6f0af9}{getmaxcumsumiac}}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00138}00138         \textcolor{keywordtype}{use }\mbox{\hyperlink{namespacestring__mod}{string\_mod}}, \textcolor{keywordtype}{only}: \mbox{\hyperlink{namespacestring__mod_a7b4ad790c8a3a5bb9937ee1b51f3baa2}{getlowercase}}, \mbox{\hyperlink{namespacestring__mod_a6c1958789d670e5ecf3ddea42f853ec2}{replacestr}}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00139}00139         \textcolor{keywordtype}{use }\mbox{\hyperlink{namespacesort__mod}{sort\_mod}}, \textcolor{keywordtype}{only}: \mbox{\hyperlink{interfacesort__mod_1_1getmedian}{getmedian}}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00140}00140 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00141}00141         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00142}00142 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00143}00143         \textcolor{keywordtype}{character(*)}, \textcolor{keywordtype}{parameter} :: PROCEDURE\_NAME = \mbox{\hyperlink{namespaceconstants__mod_a7facbdd6f237b77f9c08c94fbe98e847}{module\_name}}//\textcolor{stringliteral}{"{}@getRefinedChain()"{}}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00144}00144 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00145}00145         \textcolor{keywordtype}{class}(RefinedChain\_type)    , \textcolor{keywordtype}{intent(inout)}             :: RefinedChain}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00146}00146         \textcolor{keywordtype}{type}(ChainFileContents\_type), \textcolor{keywordtype}{intent(inout)}             :: CFC}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00147}00147         \textcolor{keywordtype}{type}(Err\_type)              , \textcolor{keywordtype}{intent(out)}               :: Err}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00148}00148         \textcolor{keywordtype}{character(*)}                , \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional}      :: sampleRefinementMethod}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00149}00149         \textcolor{keywordtype}{integer(IK)}                 , \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional}      :: burninLoc, refinedChainSize, sampleRefinementCount}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00150}00150         \textcolor{keywordtype}{integer(IK)}                                             :: burninLocDefault, i, countCompact, ndimPlusOne}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00151}00151         \textcolor{keywordtype}{integer(IK)}                                             :: maxRefinementCurrent, maxRefinementCount}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00152}00152 \textcolor{keywordtype}{        real}(RK)                                                :: integratedAutoCorrTime, ndimPlusOneInverse}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00153}00153         \textcolor{keywordtype}{logical}                                                 :: refinedChainSizeIsPresent}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00154}00154         \textcolor{keywordtype}{logical}                                                 :: maxRefinementCountIsReached}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00155}00155         \textcolor{keywordtype}{character(:)}    , \textcolor{keywordtype}{allocatable}                           :: sampleRefinementMethodDefault, sampleRefinementMethodDefaultLowerCase, srmethod}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00156}00156         \textcolor{keywordtype}{type}(Count\_type), \textcolor{keywordtype}{allocatable}                           :: DumCount(:)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00157}00157 \textcolor{keywordtype}{        real}(RK)        , \textcolor{keywordtype}{allocatable}                           :: DumIAC(:,:), DumVec(:)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00158}00158         \textcolor{keywordtype}{integer(IK)}     , \textcolor{keywordtype}{allocatable}                           :: SampleWeight(:)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00159}00159         \textcolor{keywordtype}{type}(Method\_type)                                       :: Method}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00160}00160         \textcolor{keywordtype}{type}(ChainFileContents\_type)                            :: DumCFC}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00161}00161 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00162}00162         err\%occurred = .false.}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00163}00163 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00164}00164         \textcolor{comment}{! if the size of the refined sample is given as input, then generate the requested sample straight}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00165}00165 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00166}00166         refinedchainsizeispresent = \textcolor{keyword}{present}(refinedchainsize)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00167}00167         \textcolor{keywordflow}{if} (refinedchainsizeispresent) \textcolor{keywordflow}{then}    \textcolor{comment}{! ignore sampleRefinementCount, even if it is given by the user}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00168}00168             maxrefinementcount = 1\_ik}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00169}00169         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00170}00170             maxrefinementcount = 20\_ik  \textcolor{comment}{! this is a temporary maximum value, to be increased later if needed}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00171}00171             \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(samplerefinementcount)) maxrefinementcount = samplerefinementcount}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00172}00172 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00173}00173 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00174}00174         \textcolor{comment}{! this is to avoid memory overflow due to extremely large maxRefinementCount requested by the user}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00175}00175 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00176}00176         maxrefinementcurrent = min(2\_ik, maxrefinementcount)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00177}00177 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00178}00178         \textcolor{comment}{! compute ndim and the initial chain size}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00179}00179 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00180}00180         refinedchain\%numRefinement = 0\_ik}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00181}00181 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00182}00182         \textcolor{keywordflow}{if} (cfc\%ndim == 0\_ik) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00183}00183             refinedchain\%ndim = \textcolor{keyword}{size}(cfc\%State(:,1))}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00184}00184             cfc\%ndim = refinedchain\%ndim}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00185}00185         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00186}00186             refinedchain\%ndim = cfc\%ndim}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00187}00187 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00188}00188 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00189}00189         \textcolor{comment}{! allocate components}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00190}00190 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00191}00191         \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(refinedchain\%IAC)) \textcolor{keyword}{deallocate}(refinedchain\%IAC)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00192}00192         \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(refinedchain\%Count)) \textcolor{keyword}{deallocate}(refinedchain\%Count)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00193}00193         \textcolor{keyword}{allocate}(refinedchain\%IAC(0:refinedchain\%ndim,0:maxrefinementcurrent))}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00194}00194         \textcolor{keyword}{allocate}(refinedchain\%Count(0:maxrefinementcurrent))}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00195}00195         \textcolor{keywordflow}{if} (cfc\%Count\%compact == 0\_ik) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00196}00196             refinedchain\%Count(refinedchain\%numRefinement)\%compact = \textcolor{keyword}{size}(cfc\%State(1,:))}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00197}00197             cfc\%Count\%compact = refinedchain\%Count(refinedchain\%numRefinement)\%compact}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00198}00198         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00199}00199             refinedchain\%Count(refinedchain\%numRefinement)\%compact = cfc\%Count\%compact}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00200}00200 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00201}00201         \textcolor{keywordflow}{if} (cfc\%Count\%verbose == 0\_ik) cfc\%Count\%verbose = sum(cfc\%Weight(1:cfc\%Count\%compact))}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00202}00202         refinedchain\%Count(refinedchain\%numRefinement)\%verbose = cfc\%Count\%verbose}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00203}00203 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00204}00204         \textcolor{comment}{! define the AIC computation method}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00205}00205 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00206}00206         samplerefinementmethoddefault = \mbox{\hyperlink{namespacespecmcmc__samplerefinementmethod__mod_a7db9c2c01c2aed101077d5aef54f487a}{batch\_means\_method\_name}}; \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(samplerefinementmethod)) samplerefinementmethoddefault = samplerefinementmethod}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00207}00207         samplerefinementmethoddefaultlowercase = \mbox{\hyperlink{namespacestring__mod_a7b4ad790c8a3a5bb9937ee1b51f3baa2}{getlowercase}}(samplerefinementmethoddefault)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00208}00208 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00209}00209         \textcolor{keywordflow}{if} (index(samplerefinementmethoddefaultlowercase,\mbox{\hyperlink{namespacestring__mod_a7b4ad790c8a3a5bb9937ee1b51f3baa2}{getlowercase}}(\mbox{\hyperlink{namespacespecmcmc__samplerefinementmethod__mod_a7db9c2c01c2aed101077d5aef54f487a}{batch\_means\_method\_name}}))>0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00210}00210             method\%isBatchMeans = .true.}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00211}00211         \textcolor{keywordflow}{elseif} (index(samplerefinementmethoddefaultlowercase,\mbox{\hyperlink{namespacestring__mod_a7b4ad790c8a3a5bb9937ee1b51f3baa2}{getlowercase}}(\mbox{\hyperlink{namespacespecmcmc__samplerefinementmethod__mod_abbffa351f70fa8da64d9773a91f1a175}{cutoff\_autocorr\_method\_name}}))>0 .or. index(samplerefinementmethoddefaultlowercase,\textcolor{stringliteral}{"{}cutoff"{}})>0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00212}00212             method\%isCutoffAutoCorr = .true.}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00213}00213         \textcolor{keywordflow}{elseif} (index(samplerefinementmethoddefaultlowercase,\mbox{\hyperlink{namespacestring__mod_a7b4ad790c8a3a5bb9937ee1b51f3baa2}{getlowercase}}(\mbox{\hyperlink{namespacespecmcmc__samplerefinementmethod__mod_afbcf92cdc7dd72757cacae95e29be4aa}{max\_cumsum\_autocorr\_method\_name}}))>0 .or. index(samplerefinementmethoddefaultlowercase,\textcolor{stringliteral}{"{}cumsum"{}})>0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00214}00214             method\%isMaxCumSumAutoCorr = .true.}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00215}00215         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00216}00216             \textcolor{comment}{! LCOV\_EXCL\_START}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00217}00217             err\%occurred = .true.}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00218}00218             err\%msg = procedure\_name // \textcolor{stringliteral}{"{}: Unknown unsupported IAC computation method name: "{}} // samplerefinementmethoddefault}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00219}00219             \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00220}00220             \textcolor{comment}{! LCOV\_EXCL\_STOP}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00221}00221 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00222}00222 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00223}00223         \textcolor{comment}{! define the chain types to use for the AIC computation}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00224}00224 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00225}00225         method\%isViaCompactChain = index(samplerefinementmethoddefaultlowercase,\textcolor{stringliteral}{"{}compact"{}}) > 0}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00226}00226         method\%isViaVerboseChain = index(samplerefinementmethoddefaultlowercase,\textcolor{stringliteral}{"{}verbose"{}}) > 0}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00227}00227         \textcolor{keywordflow}{if} (.not.(method\%isViaCompactChain .or. method\%isViaVerboseChain)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00228}00228             method\%isViaCompactChain = .true.}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00229}00229             method\%isViaVerboseChain = .true.}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00230}00230 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00231}00231 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00232}00232         \textcolor{comment}{! define the statistic to use for the AIC computation}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00233}00233 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00234}00234         srmethod = \mbox{\hyperlink{namespacestring__mod_a6c1958789d670e5ecf3ddea42f853ec2}{replacestr}}(string=samplerefinementmethoddefaultlowercase,search=\textcolor{stringliteral}{"{} "{}},substitute=\textcolor{stringliteral}{"{}-\/"{}})}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00235}00235         method\%isAvg =  index(srmethod,\textcolor{stringliteral}{"{}-\/avg"{}}) > 0 .or. index(srmethod,\textcolor{stringliteral}{"{}-\/average"{}}) > 0}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00236}00236         method\%isMed =  index(srmethod,\textcolor{stringliteral}{"{}-\/med"{}}) > 0 .or. index(srmethod,\textcolor{stringliteral}{"{}-\/median"{}}) > 0}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00237}00237         method\%isMin =  index(srmethod,\textcolor{stringliteral}{"{}-\/min"{}}) > 0 .or. index(srmethod,\textcolor{stringliteral}{"{}-\/minimum"{}}) > 0}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00238}00238         method\%isMax =  index(srmethod,\textcolor{stringliteral}{"{}-\/max"{}}) > 0 .or. index(srmethod,\textcolor{stringliteral}{"{}-\/maximum"{}}) > 0}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00239}00239         \textcolor{keywordflow}{if} ( method\%isAvg .and. (method\%isMed .or. method\%isMax .or. method\%isMin) ) err\%occurred = .true.}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00240}00240         \textcolor{keywordflow}{if} ( method\%isMed .and. (method\%isMax .or. method\%isMin) ) err\%occurred = .true.}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00241}00241         \textcolor{keywordflow}{if} ( method\%isMax .and. method\%isMin ) err\%occurred = .true.}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00242}00242         \textcolor{keywordflow}{if} (.not.(method\%isAvg .or. method\%isMed .or. method\%isMin .or. method\%isMax)) method\%isAvg = .true. \textcolor{comment}{! default method of AIC summarization.}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00243}00243 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00244}00244         \textcolor{keywordflow}{if} (method\%isAvg) ndimplusoneinverse = 1.\_rk / (refinedchain\%ndim + 1\_ik)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00245}00245         \textcolor{keywordflow}{if} (method\%isMed) ndimplusone = refinedchain\%ndim + 1\_ik}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00246}00246 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00247}00247         \textcolor{comment}{! assign the column headers}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00248}00248 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00249}00249         \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(cfc\%ColHeader)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00250}00250             \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(refinedchain\%ColHeader)) \textcolor{keyword}{deallocate}(refinedchain\%ColHeader)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00251}00251             \textcolor{keyword}{allocate}(refinedchain\%ColHeader(0:refinedchain\%ndim))}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00252}00252             \textcolor{keywordflow}{do} i = 0, refinedchain\%ndim}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00253}00253                 refinedchain\%ColHeader(i)\%record = cfc\%ColHeader(i+num\_def\_col)\%record}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00254}00254 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00255}00255         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00256}00256             \textcolor{comment}{! LCOV\_EXCL\_START}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00257}00257             err\%occurred = .true.}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00258}00258             err\%msg = procedure\_name // \textcolor{stringliteral}{"{}: Internal error occurred. CFC\%ColHeader is NULL."{}}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00259}00259             \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00260}00260             \textcolor{comment}{! LCOV\_EXCL\_STOP}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00261}00261 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00262}00262 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00263}00263         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(burninloc)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00264}00264             burninlocdefault = burninloc}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00265}00265         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00266}00266             burninlocdefault = cfc\%BurninLoc(cfc\%Count\%compact)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00267}00267 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00268}00268 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00269}00269         refinedchain\%Count(refinedchain\%numRefinement)\%compact = cfc\%Count\%compact -\/ burninlocdefault + 1}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00270}00270         \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(refinedchain\%LogFuncState)) \textcolor{keyword}{deallocate}(refinedchain\%LogFuncState)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00271}00271         \textcolor{keyword}{allocate}(refinedchain\%LogFuncState(0:refinedchain\%ndim,refinedchain\%Count(refinedchain\%numRefinement)\%compact))}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00272}00272         refinedchain\%LogFuncState(0                  ,1:refinedchain\%Count(refinedchain\%numRefinement)\%compact) = cfc\%LogFunc(burninlocdefault:cfc\%Count\%compact)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00273}00273         refinedchain\%LogFuncState(1:refinedchain\%ndim,1:refinedchain\%Count(refinedchain\%numRefinement)\%compact) = cfc\%State(1:refinedchain\%ndim, burninlocdefault:cfc\%Count\%compact)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00274}00274 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00275}00275         \textcolor{comment}{! check if there are more than 1 sample points in the burnin-\/subtracted CFC}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00276}00276 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00277}00277         \textcolor{keywordflow}{if} (refinedchain\%Count(refinedchain\%numRefinement)\%compact==0\_ik) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00278}00278             \textcolor{comment}{! LCOV\_EXCL\_START}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00279}00279             err\%occurred = .true.}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00280}00280             err\%msg = procedure\_name // \textcolor{stringliteral}{"{}: The size of the refined sample is zero."{}}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00281}00281             \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00282}00282             \textcolor{comment}{! LCOV\_EXCL\_STOP}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00283}00283         \textcolor{keywordflow}{elseif} (refinedchain\%Count(refinedchain\%numRefinement)\%compact==1\_ik) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00284}00284             \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(refinedchain\%Weight)) \textcolor{keyword}{deallocate}(refinedchain\%Weight)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00285}00285             \textcolor{keyword}{allocate}(refinedchain\%Weight(refinedchain\%Count(refinedchain\%numRefinement)\%compact))}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00286}00286             \textcolor{keywordflow}{if} (refinedchainsizeispresent) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00287}00287                 refinedchain\%Weight = refinedchainsize}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00288}00288             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00289}00289                 refinedchain\%Weight = 1}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00290}00290 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00291}00291             \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(refinedchain\%IAC)) \textcolor{keyword}{deallocate}(refinedchain\%IAC)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00292}00292             \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(refinedchain\%Count)) \textcolor{keyword}{deallocate}(refinedchain\%Count)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00293}00293             \textcolor{keyword}{allocate}(refinedchain\%IAC(0:refinedchain\%ndim,0:0))}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00294}00294             \textcolor{keyword}{allocate}(refinedchain\%Count(0:0))}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00295}00295             refinedchain\%IAC = 0.\_rk}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00296}00296             refinedchain\%Count(refinedchain\%numRefinement)\%verbose = sum(refinedchain\%Weight)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00297}00297             \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00298}00298 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00299}00299 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00300}00300         refinedchain\%Weight = cfc\%Weight(burninlocdefault:cfc\%Count\%compact) \textcolor{comment}{! Weight is intentionally separately assigned from State here}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00301}00301 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00302}00302         \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00303}00303 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00304}00304         looprefinement: \textcolor{keywordflow}{do}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00305}00305 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00306}00306             countcompact = refinedchain\%Count(refinedchain\%numRefinement)\%compact}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00307}00307 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00308}00308             \textcolor{comment}{! set the sample weight}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00309}00309 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00310}00310             \textcolor{keywordflow}{if} (method\%isViaCompactChain) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00311}00311                 \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(sampleweight)) \textcolor{keyword}{deallocate}(sampleweight)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00312}00312             \textcolor{keywordflow}{elseif} (method\%isViaVerboseChain) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00313}00313                 sampleweight = refinedchain\%Weight}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00314}00314 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00315}00315 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00316}00316             \textcolor{comment}{! obtain the IAC for each individual variable}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00317}00317 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00318}00318             \textcolor{keywordflow}{do} i = 0, refinedchain\%ndim}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00319}00319                 dumvec = refinedchain\%LogFuncState(i,1:refinedchain\%Count(refinedchain\%numRefinement)\%compact)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00320}00320                 \textcolor{keywordflow}{if} (method\%isBatchMeans) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00321}00321                     refinedchain\%IAC(i,refinedchain\%numRefinement) = \mbox{\hyperlink{namespacecrosscorr__mod_ac2e66e35e953f6c5316efda112d31f51}{getbatchmeansiac}}( np        = countcompact  \&}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00322}00322                                                                                         , point     = dumvec        \& \textcolor{comment}{! LCOV\_EXCL\_LINE}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00323}00323                                                                                         , weight    = sampleweight  \& \textcolor{comment}{! LCOV\_EXCL\_LINE}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00324}00324                                                                                         )}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00325}00325                 \textcolor{keywordflow}{elseif} (method\%isCutoffAutoCorr) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00326}00326                     refinedchain\%IAC(i,refinedchain\%numRefinement) = \mbox{\hyperlink{namespacecrosscorr__mod_a78147c2832004c7fbe119deace29426b}{getcumsumiac}}( np        = countcompact  \&}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00327}00327                                                                                         , point     = dumvec        \& \textcolor{comment}{! LCOV\_EXCL\_LINE}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00328}00328                                                                                         , weight    = sampleweight  \& \textcolor{comment}{! LCOV\_EXCL\_LINE}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00329}00329                                                                                         )}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00330}00330                 \textcolor{keywordflow}{elseif} (method\%isMaxCumSumAutoCorr) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00331}00331                     refinedchain\%IAC(i,refinedchain\%numRefinement) = \mbox{\hyperlink{namespacecrosscorr__mod_a7c41461ec6430b3c4cc42a174f6f0af9}{getmaxcumsumiac}}( np        = countcompact  \&}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00332}00332                                                                                         , point     = dumvec        \& \textcolor{comment}{! LCOV\_EXCL\_LINE}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00333}00333                                                                                         , weight    = sampleweight  \& \textcolor{comment}{! LCOV\_EXCL\_LINE}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00334}00334                                                                                         )}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00335}00335 \textcolor{keywordflow}{                end if}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00336}00336 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00337}00337 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00338}00338             \textcolor{keywordflow}{if} (refinedchainsizeispresent) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00339}00339                 integratedautocorrtime = real(sum(refinedchain\%Weight),kind=rk) / real(refinedchainsize,kind=rk)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00340}00340             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00341}00341                 \textcolor{keywordflow}{if} (method\%isAvg) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00342}00342                     integratedautocorrtime = sum( refinedchain\%IAC(0:refinedchain\%ndim,refinedchain\%numRefinement) ) * ndimplusoneinverse}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00343}00343                 \textcolor{keywordflow}{elseif} (method\%isMed) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00344}00344                     \textcolor{keyword}{call }\mbox{\hyperlink{interfacesort__mod_1_1getmedian}{getmedian}}(lenarray=ndimplusone,array=refinedchain\%IAC(0:refinedchain\%ndim,refinedchain\%numRefinement),median=integratedautocorrtime,err=err)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00345}00345                     \textcolor{keywordflow}{if} (err\%occurred) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00346}00346                         \textcolor{comment}{! LCOV\_EXCL\_START}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00347}00347                         err\%msg = procedure\_name//err\%msg}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00348}00348                         \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00349}00349                         \textcolor{comment}{! LCOV\_EXCL\_STOP}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00350}00350 \textcolor{keywordflow}{                    end if}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00351}00351                 \textcolor{keywordflow}{elseif} (method\%isMax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00352}00352                     integratedautocorrtime = maxval( refinedchain\%IAC(0:refinedchain\%ndim,refinedchain\%numRefinement) )}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00353}00353                 \textcolor{keywordflow}{elseif} (method\%isMin) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00354}00354                     integratedautocorrtime = minval( refinedchain\%IAC(0:refinedchain\%ndim,refinedchain\%numRefinement) )}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00355}00355 \textcolor{keywordflow}{                end if}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00356}00356 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00357}00357 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00358}00358             \textcolor{comment}{! so far, we have computed the max IAC of the sample, but no refinement. Refine the sample only if needed.}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00359}00359 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00360}00360             maxrefinementcountisreached = refinedchain\%numRefinement==maxrefinementcount}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00361}00361             \textcolor{keywordflow}{if} (integratedautocorrtime<2.\_rk .or. maxrefinementcountisreached) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00362}00362                 \textcolor{keywordflow}{if} (method\%isViaCompactChain .and. method\%isViaVerboseChain) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00363}00363                     \textcolor{comment}{!if (maxRefinementCountIsReached) maxRefinementCount = maxRefinementCount * 2\_IK}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00364}00364                     maxrefinementcount = maxrefinementcount * 2\_ik}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00365}00365                     method\%isViaCompactChain = .false.}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00366}00366                     cycle looprefinement}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00367}00367 \textcolor{keywordflow}{                end if}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00368}00368                 \textcolor{keywordflow}{exit} looprefinement}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00369}00369 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00370}00370 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00371}00371             \textcolor{comment}{! generate the refined sample, dump it in CFC, then put it back into RefinedChain to start over again}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00372}00372 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00373}00373             refinedchain\%numRefinement = refinedchain\%numRefinement + 1\_ik}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00374}00374 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00375}00375             \textcolor{comment}{! reallocate to bigger array if nedded}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00376}00376 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00377}00377             \textcolor{keywordflow}{if} (refinedchain\%numRefinement>maxrefinementcurrent) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00378}00378                 \textcolor{keyword}{call }move\_alloc( from = refinedchain\%IAC, to = dumiac )}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00379}00379                 \textcolor{keyword}{call }move\_alloc( from = refinedchain\%Count, to = dumcount )}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00380}00380                 maxrefinementcurrent = min( maxrefinementcurrent*2 , maxrefinementcount )}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00381}00381                 \textcolor{keyword}{allocate}( refinedchain\%IAC( 0:refinedchain\%ndim , 0:maxrefinementcurrent ) )}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00382}00382                 \textcolor{keyword}{allocate}( refinedchain\%Count( 0:maxrefinementcurrent ) )}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00383}00383                 refinedchain\%IAC(0:refinedchain\%ndim,0:refinedchain\%numRefinement-\/1) = dumiac}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00384}00384                 refinedchain\%Count(0:refinedchain\%numRefinement-\/1) = dumcount}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00385}00385 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00386}00386 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00387}00387             \textcolor{keywordflow}{if} (integratedautocorrtime<2.\_rk) cycle looprefinement \textcolor{comment}{! no need for refinement. should happen only when transitioning from compact to verbose}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00388}00388 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00389}00389             \textcolor{keyword}{call }refineweightedsample   ( nd = refinedchain\%ndim                                        \& \textcolor{comment}{! LCOV\_EXCL\_LINE}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00390}00390                                         , np = countcompact                                             \& \textcolor{comment}{! LCOV\_EXCL\_LINE}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00391}00391                                         , skip = integratedautocorrtime                                 \& \textcolor{comment}{! LCOV\_EXCL\_LINE}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00392}00392                                         , sample = refinedchain\%LogFuncState                            \& \textcolor{comment}{! LCOV\_EXCL\_LINE}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00393}00393                                         , weight = refinedchain\%Weight                                  \& \textcolor{comment}{! LCOV\_EXCL\_LINE}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00394}00394                                         , refinedchain = dumcfc\%State                                   \& \textcolor{comment}{! LCOV\_EXCL\_LINE}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00395}00395                                         , refinedweight = dumcfc\%Weight                                 \& \textcolor{comment}{! LCOV\_EXCL\_LINE}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00396}00396                                         , pointcount = refinedchain\%Count(refinedchain\%numRefinement)   \&}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00397}00397                                         , refinedchainsize = refinedchainsize                           \& \textcolor{comment}{! LCOV\_EXCL\_LINE}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00398}00398                                         )}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00399}00399             refinedchain\%Weight        = dumcfc\%Weight}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00400}00400             refinedchain\%LogFuncState  = dumcfc\%State}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00401}00401 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00402}00402 \textcolor{keywordflow}{        end do} looprefinement}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00403}00403 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00404}00404         \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00405}00405 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00406}00406     \textcolor{keyword}{end subroutine }getrefinedchain}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00407}00407 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00408}00408 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00409}00409 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00432}00432     \textcolor{keywordtype}{pure} \textcolor{keyword}{function }getrefinedweight(np,Weight,skip,refinedChainSize) \textcolor{keyword}{result}(RefinedWeight)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00433}00433 \textcolor{preprocessor}{\#if INTEL\_COMPILER\_ENABLED \&\& defined DLL\_ENABLED \&\& (OS\_IS\_WINDOWS || defined OS\_IS\_DARWIN)}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00434}00434 \textcolor{preprocessor}{}        \textcolor{comment}{!DEC\$ ATTRIBUTES DLLEXPORT :: getRefinedWeight}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00435}00435 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00436}00436 \textcolor{preprocessor}{}        \textcolor{keywordtype}{use }\mbox{\hyperlink{namespacemath__mod}{math\_mod}}, \textcolor{keywordtype}{only}: \mbox{\hyperlink{interfacemath__mod_1_1getcumsum}{getcumsum}}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00437}00437         \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceconstants__mod}{constants\_mod}}, \textcolor{keywordtype}{only}: ik, rk}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00438}00438         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00439}00439 \textcolor{keywordtype}{        real}(RK), \textcolor{keywordtype}{intent(in)}                :: skip}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00440}00440         \textcolor{keywordtype}{integer(IK)}, \textcolor{keywordtype}{intent(in)}             :: np, Weight(np)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00441}00441         \textcolor{keywordtype}{integer(IK)} , \textcolor{keywordtype}{intent(in)} , \textcolor{keywordtype}{optional} :: refinedChainSize}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00442}00442         \textcolor{keywordtype}{integer(IK)}                         :: RefinedWeight(np)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00443}00443         \textcolor{keywordtype}{integer(IK)}                         :: ip, refinedChainSizeCounter, offset}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00444}00444 \textcolor{keywordtype}{        real}(RK)                            :: sumSkips, CumSumWeight(np)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00445}00445         \textcolor{keywordtype}{logical}                             :: refinedChainSizeIsPresent}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00446}00446         refinedchainsizeispresent = \textcolor{keyword}{present}(refinedchainsize)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00447}00447         \textcolor{keywordflow}{if} (refinedchainsizeispresent) refinedchainsizecounter = 0\_ik}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00448}00448         cumsumweight = real(\mbox{\hyperlink{interfacemath__mod_1_1getcumsum}{getcumsum}}(np,weight),kind=rk)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00449}00449         sumskips = skip}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00450}00450         offset = 1\_ik}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00451}00451         ip = offset}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00452}00452         refinedweight = 0\_ik}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00453}00453         loopoverallsample: \textcolor{keywordflow}{do}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00454}00454             loopovercurrentsample: \textcolor{keywordflow}{do}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00455}00455                 \textcolor{keywordflow}{if} (sumskips>cumsumweight(ip)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00456}00456                     \textcolor{keywordflow}{exit} loopovercurrentsample}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00457}00457                 \textcolor{keywordflow}{elseif} (refinedchainsizeispresent) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00458}00458                     \textcolor{keywordflow}{if} (refinedchainsizecounter==refinedchainsize) \textcolor{keywordflow}{exit} loopoverallsample}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00459}00459                     refinedchainsizecounter = refinedchainsizecounter + 1\_ik}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00460}00460 \textcolor{keywordflow}{                end if}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00461}00461                 refinedweight(ip) = refinedweight(ip) + 1\_ik}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00462}00462                 sumskips = sumskips + skip}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00463}00463                 cycle loopovercurrentsample}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00464}00464 \textcolor{keywordflow}{            end do} loopovercurrentsample}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00465}00465             \textcolor{keywordflow}{if} (ip==np) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00466}00466                 \textcolor{keywordflow}{if} (refinedchainsizeispresent) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00467}00467                     \textcolor{keywordflow}{if} (refinedchainsizecounter<refinedchainsize) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00468}00468                         offset = offset + 1\_ik}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00469}00469                         \textcolor{keywordflow}{if} (offset==np) offset = 1\_ik}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00470}00470                         ip = offset}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00471}00471                         sumskips = skip}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00472}00472                         \textcolor{keywordflow}{if} (offset/=1\_ik) sumskips = sumskips + cumsumweight(ip-\/1)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00473}00473                         cycle loopoverallsample \textcolor{comment}{! LCOV\_EXCL\_LINE}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00474}00474 \textcolor{keywordflow}{                    end if}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00475}00475 \textcolor{keywordflow}{                end if}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00476}00476                 \textcolor{keywordflow}{exit} loopoverallsample}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00477}00477 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00478}00478             ip = ip + 1\_ik}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00479}00479 \textcolor{keywordflow}{        end do} loopoverallsample}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00480}00480     \textcolor{keyword}{end function }getrefinedweight}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00481}00481 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00482}00482 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00483}00483 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00497}00497     \textcolor{keywordtype}{pure} \textcolor{keyword}{subroutine }refineweightedsample(nd,np,skip,Sample,Weight,RefinedChain,RefinedWeight,PointCount,refinedChainSize)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00498}00498 \textcolor{preprocessor}{\#if INTEL\_COMPILER\_ENABLED \&\& defined DLL\_ENABLED \&\& (OS\_IS\_WINDOWS || defined OS\_IS\_DARWIN)}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00499}00499 \textcolor{preprocessor}{}        \textcolor{comment}{!DEC\$ ATTRIBUTES DLLEXPORT :: refineWeightedSample}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00500}00500 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00501}00501 \textcolor{preprocessor}{}        \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceconstants__mod}{constants\_mod}}, \textcolor{keywordtype}{only}: ik, rk}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00502}00502         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00503}00503         \textcolor{keywordtype}{integer(IK)}     , \textcolor{keywordtype}{intent(in)}                :: nd, np, Weight(np)   \textcolor{comment}{!, skip}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00504}00504 \textcolor{keywordtype}{        real}(RK)        , \textcolor{keywordtype}{intent(in)}                :: Sample(0:nd,np), skip}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00505}00505 \textcolor{keywordtype}{        real}(RK)        , \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{allocatable}  :: RefinedChain(:,:)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00506}00506         \textcolor{keywordtype}{integer(IK)}     , \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{allocatable}  :: RefinedWeight(:)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00507}00507         \textcolor{keywordtype}{integer(IK)}     , \textcolor{keywordtype}{intent(in)} , \textcolor{keywordtype}{optional}     :: refinedChainSize}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00508}00508         \textcolor{keywordtype}{type}(Count\_type), \textcolor{keywordtype}{intent(out)}               :: PointCount}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00509}00509         \textcolor{keywordtype}{integer(IK)}                                 :: ip, ipRefined, npRefined, UpdatedWeight(np) \textcolor{comment}{! LCOV\_EXCL\_LINE}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00510}00510         updatedweight = getrefinedweight(np,weight,skip,refinedchainsize)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00511}00511         nprefined = count(updatedweight>0)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00512}00512         \textcolor{keyword}{allocate}( refinedchain(0:nd,nprefined) , refinedweight(nprefined) )}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00513}00513         iprefined = 0}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00514}00514         pointcount\%verbose = 0}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00515}00515         \textcolor{keywordflow}{do} ip = 1, np}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00516}00516             \textcolor{keywordflow}{if} (updatedweight(ip)>0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00517}00517                 iprefined = iprefined + 1}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00518}00518                 refinedchain(0:nd,iprefined) = sample(0:nd,ip)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00519}00519                 refinedweight(iprefined) = updatedweight(ip)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00520}00520                 pointcount\%verbose = pointcount\%verbose + refinedweight(iprefined)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00521}00521 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00522}00522 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00523}00523         pointcount\%compact = nprefined}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00524}00524     \textcolor{keyword}{end subroutine }refineweightedsample}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00525}00525 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00526}00526 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00527}00527 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00539}00539     \textcolor{keywordtype}{pure} \textcolor{keyword}{function }getskip4newsamplesize(oldSampleSize,newSampleSize) \textcolor{keyword}{result}(skip4NewSampleSize)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00540}00540 \textcolor{preprocessor}{\#if INTEL\_COMPILER\_ENABLED \&\& defined DLL\_ENABLED \&\& (OS\_IS\_WINDOWS || defined OS\_IS\_DARWIN)}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00541}00541 \textcolor{preprocessor}{}        \textcolor{comment}{!DEC\$ ATTRIBUTES DLLEXPORT :: getSkip4NewSampleSize}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00542}00542 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00543}00543 \textcolor{preprocessor}{}        \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceconstants__mod}{constants\_mod}}, \textcolor{keywordtype}{only}: ik, rk}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00544}00544         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00545}00545         \textcolor{keywordtype}{integer(IK)} , \textcolor{keywordtype}{intent(in)}    :: oldSampleSize,newSampleSize}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00546}00546         \textcolor{keywordtype}{integer(IK)}                 :: skip4NewSampleSize, addition, quotient}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00547}00547         \textcolor{keywordflow}{if} (oldsamplesize < newsamplesize) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00548}00548             skip4newsamplesize = -\/1\_ik}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00549}00549             \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00550}00550 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00551}00551         addition = 1}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00552}00552         quotient = oldsamplesize / newsamplesize}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00553}00553         \textcolor{keywordflow}{if} (mod(oldsamplesize,newsamplesize)==0) addition = 0}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00554}00554         skip4newsamplesize = quotient + addition}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00555}00555     \textcolor{keyword}{end function }getskip4newsamplesize}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00556}00556 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00557}00557 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00558}00558 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00566}00566     \textcolor{keyword}{subroutine }writerefinedchain(RefinedChain,sampleFileUnit,sampleFileHeaderFormat,sampleFileContentsFormat)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00567}00567 \textcolor{preprocessor}{\#if INTEL\_COMPILER\_ENABLED \&\& defined DLL\_ENABLED \&\& (OS\_IS\_WINDOWS || defined OS\_IS\_DARWIN)}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00568}00568 \textcolor{preprocessor}{}        \textcolor{comment}{!DEC\$ ATTRIBUTES DLLEXPORT :: writeRefinedChain}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00569}00569 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00570}00570 \textcolor{preprocessor}{}        \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00571}00571         \textcolor{keywordtype}{class}(RefinedChain\_type), \textcolor{keywordtype}{intent(in)}    :: RefinedChain}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00572}00572         \textcolor{keywordtype}{integer(IK)} , \textcolor{keywordtype}{intent(in)}                :: sampleFileUnit}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00573}00573         \textcolor{keywordtype}{character(*)}, \textcolor{keywordtype}{intent(in)}                :: sampleFileHeaderFormat, sampleFileContentsFormat}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00574}00574         \textcolor{keywordtype}{integer(IK)}                             :: isample, iweight, i}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00575}00575         \textcolor{keyword}{write}(samplefileunit, samplefileheaderformat) (trim(adjustl(refinedchain\%ColHeader(i)\%record)),i=0,refinedchain\%ndim)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00576}00576         \textcolor{keywordflow}{do} isample = 1, refinedchain\%Count(refinedchain\%numRefinement)\%compact}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00577}00577             \textcolor{keywordflow}{do} iweight = 1, refinedchain\%Weight(isample)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00578}00578                 \textcolor{keyword}{write}(samplefileunit,samplefilecontentsformat) refinedchain\%LogFuncState(0:refinedchain\%ndim,isample)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00579}00579 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00580}00580 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00581}00581         \textcolor{keyword}{flush}(samplefileunit)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00582}00582     \textcolor{keyword}{end subroutine }writerefinedchain \textcolor{comment}{! LCOV\_EXCL\_LINE}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00583}00583 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00584}00584 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00585}00585 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00602}00602     \textcolor{keyword}{function }readrefinedchain(sampleFilePath,delimiter,ndim,tenabled) \textcolor{keyword}{result}(RefinedChain)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00603}00603 \textcolor{preprocessor}{\#if INTEL\_COMPILER\_ENABLED \&\& defined DLL\_ENABLED \&\& (OS\_IS\_WINDOWS || defined OS\_IS\_DARWIN)}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00604}00604 \textcolor{preprocessor}{}        \textcolor{comment}{!DEC\$ ATTRIBUTES DLLEXPORT :: readRefinedChain}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00605}00605 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00606}00606 \textcolor{preprocessor}{}        \textcolor{keywordtype}{use }\mbox{\hyperlink{namespacefilecontents__mod}{filecontents\_mod}}, \textcolor{keywordtype}{only}: \mbox{\hyperlink{namespacefilecontents__mod_ac25396928dd945f59ccffe6274ffe92f}{getnumrecordinfile}}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00607}00607         \textcolor{keywordtype}{use }\mbox{\hyperlink{namespacestring__mod}{string\_mod}}, \textcolor{keywordtype}{only}: \mbox{\hyperlink{structstring__mod_1_1string__type}{string\_type}}, \mbox{\hyperlink{interfacestring__mod_1_1num2str}{num2str}}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00608}00608         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00609}00609         \textcolor{keywordtype}{integer(IK)} , \textcolor{keywordtype}{intent(in)}            :: ndim}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00610}00610         \textcolor{keywordtype}{character(*)}, \textcolor{keywordtype}{intent(in)}            :: sampleFilePath, delimiter}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00611}00611         \textcolor{keywordtype}{logical}     , \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional}  :: tenabled}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00612}00612         \textcolor{keywordtype}{type}(RefinedChain\_type)             :: RefinedChain}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00613}00613         \textcolor{keywordtype}{character(*)}, \textcolor{keywordtype}{parameter}             :: PROCEDURE\_NAME = \mbox{\hyperlink{namespaceerr__mod_a9241a0f1670c98dccd7e3831dd3973b5}{module\_name}}//\textcolor{stringliteral}{"{}@readRefinedChain()"{}}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00614}00614         \textcolor{keywordtype}{integer(IK)}                         :: sampleFileUnit, isample, i}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00615}00615         \textcolor{keywordtype}{logical}                             :: tenabledDefault}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00616}00616         \textcolor{keywordtype}{type}(String\_type)                   :: Record}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00617}00617 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00618}00618         \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(record\%value)) \textcolor{keyword}{deallocate}(record\%value) \textcolor{comment}{! LCOV\_EXCL\_LINE}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00619}00619         \textcolor{keyword}{allocate}( \textcolor{keywordtype}{character(99999)} :: Record\%\textcolor{keywordtype}{value} )}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00620}00620 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00621}00621         refinedchain\%ndim = ndim}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00622}00622         refinedchain\%numRefinement = 0\_ik}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00623}00623         \textcolor{keyword}{allocate}(refinedchain\%Count(refinedchain\%numRefinement:refinedchain\%numRefinement)) \textcolor{comment}{! allocate just the zeroth level of `RefinedChain`.}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00624}00624 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00625}00625         \textcolor{comment}{! find the number of lines in the sample file}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00626}00626 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00627}00627         \textcolor{keyword}{call }\mbox{\hyperlink{namespacefilecontents__mod_ac25396928dd945f59ccffe6274ffe92f}{getnumrecordinfile}}(filepath=samplefilepath, numrecord=refinedchain\%Count(refinedchain\%numRefinement)\%verbose, err=refinedchain\%Err)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00628}00628         \textcolor{keywordflow}{if} (refinedchain\%Err\%occurred) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00629}00629             \textcolor{comment}{! LCOV\_EXCL\_START}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00630}00630             refinedchain\%Err\%msg = procedure\_name // refinedchain\%Err\%msg}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00631}00631             \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00632}00632             \textcolor{comment}{! LCOV\_EXCL\_STOP}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00633}00633 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00634}00634 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00635}00635         refinedchain\%Count(refinedchain\%numRefinement)\%verbose = refinedchain\%Count(refinedchain\%numRefinement)\%verbose -\/ 1\_ik \textcolor{comment}{! remove header from the count}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00636}00636 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00637}00637         \textcolor{keyword}{open}( newunit = samplefileunit \&}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00638}00638             , file = samplefilepath \&}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00639}00639             , status = \textcolor{stringliteral}{"{}old"{}} \&}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00640}00640 \textcolor{preprocessor}{\#if defined INTEL\_COMPILER\_ENABLED \&\& defined OS\_IS\_WINDOWS}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00641}00641 \textcolor{preprocessor}{}            , shared \&}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00642}00642 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00643}00643 \textcolor{preprocessor}{}            )}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00644}00644 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00645}00645         \textcolor{comment}{! read header}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00646}00646 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00647}00647         \textcolor{keyword}{read}(samplefileunit,\textcolor{stringliteral}{"{}(A)"{}}) record\%value}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00648}00648         record\%Parts = record\%split(record\%value,delimiter,record\%nPart)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00649}00649         \textcolor{keywordflow}{if} (record\%nPart/=ndim+1\_ik) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00650}00650             \textcolor{comment}{! LCOV\_EXCL\_START}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00651}00651             refinedchain\%Err\%occurred = .true.}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00652}00652             refinedchain\%Err\%msg = procedure\_name // \textcolor{stringliteral}{"{}: The number of header columns ("{}}//\mbox{\hyperlink{interfacestring__mod_1_1num2str}{num2str}}(record\%nPart)//\textcolor{stringliteral}{"{}) is not equal to ndim + 1: "{}}//\mbox{\hyperlink{interfacestring__mod_1_1num2str}{num2str}}(ndim+1\_ik)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00653}00653             \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00654}00654             \textcolor{comment}{! LCOV\_EXCL\_STOP}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00655}00655 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00656}00656 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00657}00657         \textcolor{keyword}{allocate}(refinedchain\%ColHeader(0:ndim))}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00658}00658         \textcolor{keywordflow}{do} i = 0, ndim}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00659}00659             refinedchain\%ColHeader(i)\%record = record\%Parts(i+1)\%record}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00660}00660 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00661}00661 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00662}00662         \textcolor{comment}{! read contents}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00663}00663 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00664}00664         tenableddefault = .false.}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00665}00665         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(tenabled)) tenableddefault = tenabled}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00666}00666 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00667}00667         \textcolor{keywordflow}{if} (tenableddefault) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00668}00668 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00669}00669             \textcolor{keyword}{allocate}( refinedchain\%LogFuncState(refinedchain\%Count(refinedchain\%numRefinement)\%verbose, 0:ndim) )}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00670}00670             \textcolor{keywordflow}{do} isample = 1, refinedchain\%Count(refinedchain\%numRefinement)\%verbose}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00671}00671                 \textcolor{keyword}{read}(samplefileunit, \textcolor{stringliteral}{"{}(A)"{}}) record\%value}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00672}00672                 record\%Parts = record\%split(trim(adjustl(record\%value)),delimiter)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00673}00673                 \textcolor{keywordflow}{do} i = 0, ndim}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00674}00674                     \textcolor{keyword}{read}(record\%Parts(i+1)\%record,*) refinedchain\%LogFuncState(isample,i)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00675}00675 \textcolor{keywordflow}{                end do}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00676}00676 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00677}00677 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00678}00678         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00679}00679 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00680}00680             \textcolor{keyword}{allocate}( refinedchain\%LogFuncState(0:ndim, refinedchain\%Count(refinedchain\%numRefinement)\%verbose) )}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00681}00681             \textcolor{keywordflow}{do} isample = 1, refinedchain\%Count(refinedchain\%numRefinement)\%verbose}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00682}00682                 \textcolor{keyword}{read}(samplefileunit, \textcolor{stringliteral}{"{}(A)"{}}) record\%value}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00683}00683                 record\%Parts = record\%split(trim(adjustl(record\%value)),delimiter)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00684}00684                 \textcolor{keywordflow}{do} i = 0, ndim}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00685}00685                     \textcolor{keyword}{read}(record\%Parts(i+1)\%record,*) refinedchain\%LogFuncState(i,isample)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00686}00686 \textcolor{keywordflow}{                end do}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00687}00687 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00688}00688 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00689}00689 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00690}00690 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00691}00691         \textcolor{keyword}{close}(samplefileunit)}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00692}00692 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00693}00693     \textcolor{keyword}{end function }readrefinedchain}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00694}00694 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00695}00695 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00696}00696 }
\DoxyCodeLine{\Hypertarget{ParaXXXX__RefinedChain__mod_8inc_8f90_source_l00697}00697 ! \textcolor{keyword}{end module }paramcmc\_refinedchain\_mod ! lcov\_excl\_line}

\end{DoxyCode}
