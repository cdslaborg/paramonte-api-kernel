\hypertarget{CrossCorr__mod_8f90_source}{}\doxysection{Cross\+Corr\+\_\+mod.\+f90}
\label{CrossCorr__mod_8f90_source}\index{D:/Dropbox/Projects/20180101\_ParaMonte/git/src/kernel/CrossCorr\_mod.f90@{D:/Dropbox/Projects/20180101\_ParaMonte/git/src/kernel/CrossCorr\_mod.f90}}
\mbox{\hyperlink{CrossCorr__mod_8f90}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00001}00001 \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00002}00002 \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00003}00003 \textcolor{comment}{!!!!}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00004}00004 \textcolor{comment}{!!!!   MIT License}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00005}00005 \textcolor{comment}{!!!!}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00006}00006 \textcolor{comment}{!!!!   ParaMonte: plain powerful parallel Monte Carlo library.}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00007}00007 \textcolor{comment}{!!!!}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00008}00008 \textcolor{comment}{!!!!   Copyright (C) 2012-\/present, The Computational Data Science Lab}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00009}00009 \textcolor{comment}{!!!!}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00010}00010 \textcolor{comment}{!!!!   This file is part of the ParaMonte library.}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00011}00011 \textcolor{comment}{!!!!}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00012}00012 \textcolor{comment}{!!!!   Permission is hereby granted, free of charge, to any person obtaining a}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00013}00013 \textcolor{comment}{!!!!   copy of this software and associated documentation files (the "{}Software"{}),}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00014}00014 \textcolor{comment}{!!!!   to deal in the Software without restriction, including without limitation}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00015}00015 \textcolor{comment}{!!!!   the rights to use, copy, modify, merge, publish, distribute, sublicense,}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00016}00016 \textcolor{comment}{!!!!   and/or sell copies of the Software, and to permit persons to whom the}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00017}00017 \textcolor{comment}{!!!!   Software is furnished to do so, subject to the following conditions:}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00018}00018 \textcolor{comment}{!!!!}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00019}00019 \textcolor{comment}{!!!!   The above copyright notice and this permission notice shall be}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00020}00020 \textcolor{comment}{!!!!   included in all copies or substantial portions of the Software.}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00021}00021 \textcolor{comment}{!!!!}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00022}00022 \textcolor{comment}{!!!!   THE SOFTWARE IS PROVIDED "{}AS IS"{}, WITHOUT WARRANTY OF ANY KIND,}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00023}00023 \textcolor{comment}{!!!!   EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00024}00024 \textcolor{comment}{!!!!   MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00025}00025 \textcolor{comment}{!!!!   IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00026}00026 \textcolor{comment}{!!!!   DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00027}00027 \textcolor{comment}{!!!!   OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00028}00028 \textcolor{comment}{!!!!   OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00029}00029 \textcolor{comment}{!!!!}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00030}00030 \textcolor{comment}{!!!!   ACKNOWLEDGMENT}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00031}00031 \textcolor{comment}{!!!!}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00032}00032 \textcolor{comment}{!!!!   ParaMonte is an honor-\/ware and its currency is acknowledgment and citations.}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00033}00033 \textcolor{comment}{!!!!   As per the ParaMonte library license agreement terms, if you use any parts of}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00034}00034 \textcolor{comment}{!!!!   this library for any purposes, kindly acknowledge the use of ParaMonte in your}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00035}00035 \textcolor{comment}{!!!!   work (education/research/industry/development/...) by citing the ParaMonte}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00036}00036 \textcolor{comment}{!!!!   library as described on this page:}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00037}00037 \textcolor{comment}{!!!!}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00038}00038 \textcolor{comment}{!!!!       https://github.com/cdslaborg/paramonte/blob/main/ACKNOWLEDGMENT.md}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00039}00039 \textcolor{comment}{!!!!}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00040}00040 \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00041}00041 \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00042}00042 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00045}00045 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00046}\mbox{\hyperlink{namespacecrosscorr__mod}{00046}} \textcolor{keyword}{module} \mbox{\hyperlink{namespacecrosscorr__mod}{crosscorr\_mod}}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00047}00047 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00048}00048     \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00049}00049 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00050}\mbox{\hyperlink{namespacecrosscorr__mod_a08ed18f00ab3cba07653e5e6043db234}{00050}}     \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{parameter} :: \mbox{\hyperlink{namespacecrosscorr__mod_a08ed18f00ab3cba07653e5e6043db234}{module\_name}} = \textcolor{stringliteral}{"{}@CrossCorr\_mod"{}}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00051}00051 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00052}\mbox{\hyperlink{interfacecrosscorr__mod_1_1getpaddedlen}{00052}}     \textcolor{keyword}{interface} \mbox{\hyperlink{interfacecrosscorr__mod_1_1getpaddedlen}{getpaddedlen}}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00053}00053         \textcolor{keyword}{module procedure} :: \mbox{\hyperlink{namespacecrosscorr__mod_af9820a60ebbbd23e56c5c47738c2e9d4}{getpaddedlen\_ik}}, \mbox{\hyperlink{namespacecrosscorr__mod_a07dddbb333de864d7ed8f170167dee06}{getpaddedlen\_rk}}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00054}00054     \textcolor{keyword}{end interface }\mbox{\hyperlink{interfacecrosscorr__mod_1_1getpaddedlen}{getpaddedlen}}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00055}00055 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00056}00056 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00057}00057 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00058}00058 \textcolor{keyword}{contains}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00059}00059 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00060}00060 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00061}00061 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00075}\mbox{\hyperlink{namespacecrosscorr__mod_ac2e66e35e953f6c5316efda112d31f51}{00075}}     \textcolor{keyword}{function }\mbox{\hyperlink{namespacecrosscorr__mod_ac2e66e35e953f6c5316efda112d31f51}{getbatchmeansiac}}(np,Point,Weight,batchSize) \textcolor{keyword}{result}(iac)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00076}00076 \textcolor{preprocessor}{\#if INTEL\_COMPILER\_ENABLED \&\& defined DLL\_ENABLED \&\& (OS\_IS\_WINDOWS || defined OS\_IS\_DARWIN)}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00077}00077 \textcolor{preprocessor}{}        \textcolor{comment}{!DEC\$ ATTRIBUTES DLLEXPORT :: getBatchMeansIAC}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00078}00078 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00079}00079 \textcolor{preprocessor}{}        \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceconstants__mod}{constants\_mod}}, \textcolor{keywordtype}{only}: ik, rk}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00080}00080         \textcolor{keywordtype}{use }\mbox{\hyperlink{namespacestatistics__mod}{statistics\_mod}}, \textcolor{keywordtype}{only}: \mbox{\hyperlink{interfacestatistics__mod_1_1getvariance}{getvariance}}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00081}00081         \textcolor{keywordtype}{use }\mbox{\hyperlink{namespacemath__mod}{math\_mod}}, \textcolor{keywordtype}{only}: \mbox{\hyperlink{interfacemath__mod_1_1getcumsum}{getcumsum}}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00082}00082         \textcolor{comment}{!use Stirng\_mod, only: num2str}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00083}00083         \textcolor{comment}{!use Err\_mod, only: Err\_type}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00084}00084 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00085}00085         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00086}00086 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00087}00087         \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{parameter}         :: procedure\_name = \mbox{\hyperlink{namespaceconstants__mod_a7facbdd6f237b77f9c08c94fbe98e847}{module\_name}} // \textcolor{stringliteral}{"{}@getBatchMeansIAC()"{}}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00088}00088 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00089}00089         \textcolor{keywordtype}{integer(IK)}, \textcolor{keywordtype}{intent(in)}             :: np}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00090}00090 \textcolor{keywordtype}{        real}(rk), \textcolor{keywordtype}{intent(in)}                :: point(np)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00091}00091         \textcolor{keywordtype}{integer(IK)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional}   :: weight(np), batchsize}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00092}00092         \textcolor{comment}{!type(Err\_type), intent(out)         :: Err}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00093}00093 \textcolor{keywordtype}{        real}(rk)                            :: iac}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00094}00094 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00095}00095         \textcolor{keywordtype}{integer(IK)}                         :: cumsumweight(np), currentsampleendloc, batchsizedefault, samplecount, isample}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00096}00096         \textcolor{keywordtype}{integer(IK)}                         :: ip, ipverbose, ipstart, ipend, npeffective}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00097}00097 \textcolor{keywordtype}{        real}(rk)                            :: avgpoint, varpoint, avgbatchmean, varbatchmean}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00098}00098 \textcolor{keywordtype}{        real}(rk)                            :: diffsquared, batchsizedefaultinverse}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00099}00099 \textcolor{keywordtype}{        real}(rk), \textcolor{keywordtype}{allocatable}               :: batchmean(:)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00100}00100 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00101}00101         \textcolor{comment}{!Err\%occurred = .false.}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00102}00102 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00103}00103         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(weight)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00104}00104             cumsumweight = \mbox{\hyperlink{interfacemath__mod_1_1getcumsum}{getcumsum}}(np,weight)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00105}00105         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00106}00106             cumsumweight(np) = np}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00107}00107 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00108}00108 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00109}00109         \textcolor{comment}{! compute batch size and count}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00110}00110         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(batchsize)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00111}00111             batchsizedefault = batchsize}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00112}00112         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00113}00113             batchsizedefault = int( real(cumsumweight(np),kind=rk)**(0.666666666666666\_rk) )}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00114}00114 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00115}00115         batchsizedefaultinverse = 1.\_rk / real(batchsizedefault,kind=rk)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00116}00116         samplecount = cumsumweight(np) / batchsizedefault}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00117}00117         npeffective = samplecount * batchsizedefault}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00118}00118 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00119}00119         \textcolor{keywordflow}{if} (samplecount<2) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00120}00120             \textcolor{comment}{!Err\%occurred = .true.}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00121}00121             \textcolor{comment}{!Err\%msg = PROCEDURE\_NAME // "{}: sampleCount<10: "{} // num2str(sampleCount)}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00122}00122             \textcolor{comment}{!iac = -\/huge(iac)}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00123}00123             iac = 1}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00124}00124             \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00125}00125 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00126}00126 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00127}00127         \textcolor{comment}{! xxx: here goes another GFortran 7.3 bug: EndOfLineLoc is assumed already allocated, despite the first appearance here.}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00128}00128         \textcolor{keywordflow}{if} (\textcolor{keyword}{allocated}(batchmean)) \textcolor{keyword}{deallocate}(batchmean)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00129}00129         \textcolor{keyword}{allocate}(batchmean(samplecount))}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00130}00130 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00131}00131         \textcolor{comment}{! improvement: iterate from the end to the beginning of the chain to ignore initial points instead of the last points.}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00132}00132         \textcolor{comment}{! this would be beneficial for MCMC samples}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00133}00133 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00134}00134         \textcolor{comment}{! compute the Batch-\/Means avergage and variance, also average of Point}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00135}00135         avgpoint = 0.\_rk}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00136}00136         ipstart = 1}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00137}00137         ipend   = 0}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00138}00138         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(weight)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00139}00139             ip = 1}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00140}00140             isample = 1}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00141}00141             ipverbose = 0}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00142}00142             currentsampleendloc = batchsizedefault}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00143}00143             batchmean(isample) = 0.\_rk}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00144}00144             loopoverweight: \textcolor{keywordflow}{do}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00145}00145                 ipverbose = ipverbose + 1}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00146}00146                 \textcolor{keywordflow}{if} (ipverbose>cumsumweight(ip)) ip = ip + 1}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00147}00147                 \textcolor{keywordflow}{if} (ipverbose>currentsampleendloc) \textcolor{keywordflow}{then} \textcolor{comment}{! we are done with the current batch}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00148}00148                     avgpoint = avgpoint + batchmean(isample)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00149}00149                     batchmean(isample) = batchmean(isample) * batchsizedefaultinverse}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00150}00150                     \textcolor{keywordflow}{if} (ipverbose>npeffective) \textcolor{keywordflow}{exit} loopoverweight  \textcolor{comment}{! condition equivalent to currentSampleEndLoc==npEffective}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00151}00151                     currentsampleendloc = currentsampleendloc + batchsizedefault}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00152}00152                     isample = isample + 1}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00153}00153                     batchmean(isample) = 0.\_rk}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00154}00154 \textcolor{keywordflow}{                end if}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00155}00155                 batchmean(isample)  = batchmean(isample) + point(ip)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00156}00156 \textcolor{keywordflow}{            end do} loopoverweight}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00157}00157         \textcolor{keywordflow}{else}    \textcolor{comment}{! there is no weight}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00158}00158             \textcolor{keywordflow}{do} isample = 1, samplecount}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00159}00159                 batchmean(isample) = 0.\_rk}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00160}00160                 ipend = ipend + batchsizedefault}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00161}00161                 \textcolor{keywordflow}{do} ip = ipstart, ipend}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00162}00162                     batchmean(isample)  = batchmean(isample) + point(ip)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00163}00163 \textcolor{keywordflow}{                end do}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00164}00164                 ipstart = ipend + 1\_ik}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00165}00165                 avgpoint = avgpoint + batchmean(isample)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00166}00166                 batchmean(isample) = batchmean(isample) * batchsizedefaultinverse}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00167}00167 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00168}00168 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00169}00169         avgbatchmean = sum( batchmean ) / real(samplecount,kind=rk)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00170}00170         varbatchmean = sum( (batchmean -\/ avgbatchmean)**2 ) / real(samplecount-\/1,kind=rk)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00171}00171         avgpoint = avgpoint / real(npeffective,kind=rk)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00172}00172 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00173}00173         \textcolor{comment}{! compute the variance of Point}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00174}00174 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00175}00175         varpoint = 0.\_rk}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00176}00176         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(weight)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00177}00177             ip = 1}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00178}00178             ipverbose = 0}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00179}00179             diffsquared = ( point(ip) -\/ avgpoint )**2}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00180}00180             loopcomputevarpoint: \textcolor{keywordflow}{do}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00181}00181                 ipverbose = ipverbose + 1}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00182}00182                 \textcolor{keywordflow}{if} (ipverbose>npeffective) \textcolor{keywordflow}{exit} loopcomputevarpoint}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00183}00183                 \textcolor{keywordflow}{if} (ipverbose>cumsumweight(ip)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00184}00184                     ip = ip + 1 \textcolor{comment}{! by definition, ip never become > np, otherwise it leads to disastrous errors}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00185}00185                     diffsquared = ( point(ip) -\/ avgpoint )**2}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00186}00186 \textcolor{keywordflow}{                end if}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00187}00187                 varpoint = varpoint + diffsquared}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00188}00188 \textcolor{keywordflow}{            end do} loopcomputevarpoint}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00189}00189         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00190}00190             \textcolor{keywordflow}{do} ip = 1, npeffective}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00191}00191                 varpoint = varpoint + ( point(ip) -\/ avgpoint )**2}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00192}00192 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00193}00193 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00194}00194         varpoint = varpoint / real(npeffective-\/1,kind=rk)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00195}00195 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00196}00196         \textcolor{comment}{! compute the IAC}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00197}00197 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00198}00198         iac = batchsizedefault * varbatchmean / varpoint}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00199}00199 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00200}00200     \textcolor{keyword}{end function }\mbox{\hyperlink{namespacecrosscorr__mod_ac2e66e35e953f6c5316efda112d31f51}{getbatchmeansiac}}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00201}00201 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00202}00202 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00203}00203 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00215}\mbox{\hyperlink{namespacecrosscorr__mod_a78147c2832004c7fbe119deace29426b}{00215}}     \textcolor{keyword}{function }\mbox{\hyperlink{namespacecrosscorr__mod_a78147c2832004c7fbe119deace29426b}{getcumsumiac}}(np,Point,Weight,significance) \textcolor{keyword}{result}(iac)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00216}00216 \textcolor{preprocessor}{\#if INTEL\_COMPILER\_ENABLED \&\& defined DLL\_ENABLED \&\& (OS\_IS\_WINDOWS || defined OS\_IS\_DARWIN)}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00217}00217 \textcolor{preprocessor}{}        \textcolor{comment}{!DEC\$ ATTRIBUTES DLLEXPORT :: getCumSumIAC}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00218}00218 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00219}00219 \textcolor{preprocessor}{}        \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceconstants__mod}{constants\_mod}}, \textcolor{keywordtype}{only}: ik, rk}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00220}00220         \textcolor{keywordtype}{use }\mbox{\hyperlink{namespacemath__mod}{math\_mod}}, \textcolor{keywordtype}{only}: \mbox{\hyperlink{interfacemath__mod_1_1getcumsum}{getcumsum}}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00221}00221         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00222}00222         \textcolor{keywordtype}{integer(IK)} , \textcolor{keywordtype}{intent(in)}            :: np}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00223}00223 \textcolor{keywordtype}{        real}(rk)    , \textcolor{keywordtype}{intent(in)}            :: point(np)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00224}00224         \textcolor{keywordtype}{integer(IK)} , \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional}  :: weight(np)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00225}00225 \textcolor{keywordtype}{        real}(rk)    , \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional}  :: significance \textcolor{comment}{! in units of sigma}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00226}00226 \textcolor{keywordtype}{        real}(rk)                            :: iac, meanpoint, normfac, normeddata(np), cutoff, significancedefault}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00227}00227 \textcolor{keywordtype}{        real}(rk)    , \textcolor{keywordtype}{allocatable}           :: autocorr(:)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00228}00228         \textcolor{keywordtype}{integer(IK)}                         :: i, paddedlen, sumweight, cutoffindex}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00229}00229         significancedefault = 2.\_rk}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00230}00230         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(significance)) significancedefault = significance}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00231}00231         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(weight)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00232}00232             sumweight = sum(weight)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00233}00233             meanpoint = sum(point*weight) / real(sumweight,kind=rk)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00234}00234         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00235}00235             sumweight = np}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00236}00236             meanpoint = sum(point) / real(np,kind=rk)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00237}00237 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00238}00238         normeddata = point -\/ meanpoint}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00239}00239         paddedlen = \mbox{\hyperlink{interfacecrosscorr__mod_1_1getpaddedlen}{getpaddedlen}}(sumweight)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00240}00240         autocorr = \mbox{\hyperlink{namespacecrosscorr__mod_a247f997287f07e7f497107335d7deddf}{getcrosscorrweightedfft}}( lencompactdata1   = np            \&}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00241}00241                                             , lencompactdata2   = np            \&}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00242}00242                                             , paddedlen         = paddedlen     \&}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00243}00243                                             , compactdata1      = normeddata    \&}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00244}00244                                             , compactdata2      = normeddata    \&}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00245}00245                                             , weight1           = weight        \&}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00246}00246                                             , weight2           = weight        \&}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00247}00247                                             )}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00248}00248         normfac = 1.\_rk / autocorr(1)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00249}00249         autocorr = autocorr * normfac}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00250}00250         \textcolor{comment}{! For autocorrelation, under the assumption of a completely random series, the ACF standard error reduces to sqrt(1/ndata)}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00251}00251         cutoff = significancedefault * sqrt(1.\_rk/sumweight) \textcolor{comment}{! standardErrorAutoCorr}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00252}00252         cutoffindex = 1\_ik}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00253}00253         \textcolor{keywordflow}{do} i = 1, paddedlen}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00254}00254             \textcolor{keywordflow}{if} (autocorr(i)<cutoff) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00255}00255                 cutoffindex = i}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00256}00256                 \textcolor{keywordflow}{exit}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00257}00257 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00258}00258 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00259}00259         iac = 2\_ik * sum(autocorr(1:cutoffindex)) -\/ 1\_ik}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00260}00260     \textcolor{keyword}{end function }\mbox{\hyperlink{namespacecrosscorr__mod_a78147c2832004c7fbe119deace29426b}{getcumsumiac}}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00261}00261 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00262}00262 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00263}00263 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00273}\mbox{\hyperlink{namespacecrosscorr__mod_a7c41461ec6430b3c4cc42a174f6f0af9}{00273}}     \textcolor{keyword}{function }\mbox{\hyperlink{namespacecrosscorr__mod_a7c41461ec6430b3c4cc42a174f6f0af9}{getmaxcumsumiac}}(np,Point,Weight) \textcolor{keyword}{result}(maxIAC)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00274}00274 \textcolor{preprocessor}{\#if INTEL\_COMPILER\_ENABLED \&\& defined DLL\_ENABLED \&\& (OS\_IS\_WINDOWS || defined OS\_IS\_DARWIN)}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00275}00275 \textcolor{preprocessor}{}        \textcolor{comment}{!DEC\$ ATTRIBUTES DLLEXPORT :: getMaxCumSumIAC}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00276}00276 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00277}00277 \textcolor{preprocessor}{}        \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceconstants__mod}{constants\_mod}}, \textcolor{keywordtype}{only}: ik, rk}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00278}00278         \textcolor{keywordtype}{use }\mbox{\hyperlink{namespacemath__mod}{math\_mod}}, \textcolor{keywordtype}{only}: \mbox{\hyperlink{interfacemath__mod_1_1getcumsum}{getcumsum}}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00279}00279         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00280}00280         \textcolor{keywordtype}{integer(IK)}, \textcolor{keywordtype}{intent(in)}             :: np}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00281}00281 \textcolor{keywordtype}{        real}(rk), \textcolor{keywordtype}{intent(in)}                :: point(np)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00282}00282         \textcolor{keywordtype}{integer(IK)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional}   :: weight(np)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00283}00283 \textcolor{keywordtype}{        real}(rk)                            :: maxiac, meanpoint, normfac, normeddata(np)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00284}00284 \textcolor{keywordtype}{        real}(rk), \textcolor{keywordtype}{allocatable}               :: autocorr(:)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00285}00285         \textcolor{keywordtype}{integer(IK)}                         :: paddedlen, sumweight}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00286}00286         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(weight)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00287}00287             sumweight = sum(weight)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00288}00288             meanpoint = sum(point*weight) / real(sumweight,kind=rk)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00289}00289         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00290}00290             sumweight = np}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00291}00291             meanpoint = sum(point) / real(np,kind=rk)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00292}00292 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00293}00293         normeddata = point -\/ meanpoint}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00294}00294         paddedlen = \mbox{\hyperlink{interfacecrosscorr__mod_1_1getpaddedlen}{getpaddedlen}}(sumweight)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00295}00295         autocorr = \mbox{\hyperlink{namespacecrosscorr__mod_a247f997287f07e7f497107335d7deddf}{getcrosscorrweightedfft}}( lencompactdata1   = np            \&}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00296}00296                                             , lencompactdata2   = np            \&}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00297}00297                                             , paddedlen         = paddedlen     \&}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00298}00298                                             , compactdata1      = normeddata    \&}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00299}00299                                             , compactdata2      = normeddata    \&}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00300}00300                                             , weight1           = weight        \&}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00301}00301                                             , weight2           = weight        \&}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00302}00302                                             )}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00303}00303         normfac = 1.\_rk / autocorr(1)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00304}00304         autocorr = autocorr * normfac}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00305}00305         maxiac = 2\_ik * maxval(\mbox{\hyperlink{interfacemath__mod_1_1getcumsum}{getcumsum}}(paddedlen,autocorr)) -\/ 1\_ik}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00306}00306     \textcolor{keyword}{end function }\mbox{\hyperlink{namespacecrosscorr__mod_a7c41461ec6430b3c4cc42a174f6f0af9}{getmaxcumsumiac}}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00307}00307 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00308}00308 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00309}00309 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00329}\mbox{\hyperlink{interfacecrosscorr__mod_1_1getpaddedlen_a55e5c711c4c66f679433af81043e3b33}{00329}}     \textcolor{keywordtype}{pure} \textcolor{keyword}{function }\mbox{\hyperlink{namespacecrosscorr__mod_af9820a60ebbbd23e56c5c47738c2e9d4}{getpaddedlen\_ik}}(actualLen,base) \textcolor{keyword}{result}(paddedLen)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00330}00330 \textcolor{preprocessor}{\#if INTEL\_COMPILER\_ENABLED \&\& defined DLL\_ENABLED \&\& (OS\_IS\_WINDOWS || defined OS\_IS\_DARWIN)}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00331}00331 \textcolor{preprocessor}{}        \textcolor{comment}{!DEC\$ ATTRIBUTES DLLEXPORT :: getPaddedLen\_IK}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00332}00332 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00333}00333 \textcolor{preprocessor}{}        \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceconstants__mod}{constants\_mod}}, \textcolor{keywordtype}{only}: ik, rk}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00334}00334         \textcolor{keywordtype}{integer(IK)} , \textcolor{keywordtype}{intent(in)}            :: actuallen}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00335}00335         \textcolor{keywordtype}{integer(IK)} , \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional}  :: base}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00336}00336         \textcolor{keywordtype}{integer(IK)}                         :: basedefault}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00337}00337         \textcolor{keywordtype}{integer(IK)}                         :: paddedlen}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00338}00338         basedefault = 2\_ik}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00339}00339         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(base)) basedefault = base}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00340}00340         paddedlen = basedefault ** ( \mbox{\hyperlink{namespacecrosscorr__mod_a2aa1e7aab0ed6b28a2c093270364210e}{getnextexponent}}( real(actuallen,kind=rk), real(basedefault,kind=rk)) + 1\_ik )}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00341}00341     \textcolor{keyword}{end function }\mbox{\hyperlink{namespacecrosscorr__mod_af9820a60ebbbd23e56c5c47738c2e9d4}{getpaddedlen\_ik}}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00342}00342 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00343}00343 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00344}00344 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00364}\mbox{\hyperlink{interfacecrosscorr__mod_1_1getpaddedlen_a5dbea8dc9a04c07937ba6ad9bb1398cb}{00364}}     \textcolor{keywordtype}{pure} \textcolor{keyword}{function }\mbox{\hyperlink{namespacecrosscorr__mod_a07dddbb333de864d7ed8f170167dee06}{getpaddedlen\_rk}}(actualLen,base) \textcolor{keyword}{result}(paddedLen)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00365}00365 \textcolor{preprocessor}{\#if INTEL\_COMPILER\_ENABLED \&\& defined DLL\_ENABLED \&\& (OS\_IS\_WINDOWS || defined OS\_IS\_DARWIN)}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00366}00366 \textcolor{preprocessor}{}        \textcolor{comment}{!DEC\$ ATTRIBUTES DLLEXPORT :: getPaddedLen\_RK}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00367}00367 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00368}00368 \textcolor{preprocessor}{}        \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceconstants__mod}{constants\_mod}}, \textcolor{keywordtype}{only}: ik, rk}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00369}00369 \textcolor{keywordtype}{        real}(rk)    , \textcolor{keywordtype}{intent(in)}            :: actuallen}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00370}00370 \textcolor{keywordtype}{        real}(rk)    , \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional}  :: base}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00371}00371 \textcolor{keywordtype}{        real}(rk)                            :: basedefault}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00372}00372         \textcolor{keywordtype}{integer(IK)}                         :: paddedlen}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00373}00373         basedefault = 2.\_rk}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00374}00374         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(base)) basedefault = base}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00375}00375         paddedlen = nint( basedefault ** ( \mbox{\hyperlink{namespacecrosscorr__mod_a2aa1e7aab0ed6b28a2c093270364210e}{getnextexponent}}(real(actuallen,kind=rk), basedefault) + 1\_ik ) )}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00376}00376     \textcolor{keyword}{end function }\mbox{\hyperlink{namespacecrosscorr__mod_a07dddbb333de864d7ed8f170167dee06}{getpaddedlen\_rk}}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00377}00377 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00378}00378 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00379}00379 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00391}\mbox{\hyperlink{namespacecrosscorr__mod_a7e42791732acdd50278751c5d4439068}{00391}}     \textcolor{keywordtype}{pure} \textcolor{keyword}{function }\mbox{\hyperlink{namespacecrosscorr__mod_a7e42791732acdd50278751c5d4439068}{getpreviousexponent}}(absoluteValue,base) \textcolor{keyword}{result}(previousExponent)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00392}00392 \textcolor{preprocessor}{\#if INTEL\_COMPILER\_ENABLED \&\& defined DLL\_ENABLED \&\& (OS\_IS\_WINDOWS || defined OS\_IS\_DARWIN)}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00393}00393 \textcolor{preprocessor}{}        \textcolor{comment}{!DEC\$ ATTRIBUTES DLLEXPORT :: getPreviousExponent}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00394}00394 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00395}00395 \textcolor{preprocessor}{}        \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceconstants__mod}{constants\_mod}}, \textcolor{keywordtype}{only}: ik, rk, \mbox{\hyperlink{namespaceconstants__mod_a6f812cdff0771059f9fc402e1c60011d}{invln2}}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00396}00396 \textcolor{keywordtype}{        real}(rk), \textcolor{keywordtype}{intent(in)}            :: absolutevalue}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00397}00397 \textcolor{keywordtype}{        real}(rk), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional}  :: base}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00398}00398         \textcolor{keywordtype}{integer(IK)}                     :: previousexponent}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00399}00399         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(base)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00400}00400             previousexponent = floor( log(absolutevalue) / log(base) )}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00401}00401         \textcolor{keywordflow}{else}    \textcolor{comment}{! assume the base is 2}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00402}00402             previousexponent = floor( log(absolutevalue) * \mbox{\hyperlink{namespaceconstants__mod_a6f812cdff0771059f9fc402e1c60011d}{invln2}} )}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00403}00403 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00404}00404     \textcolor{keyword}{end function }\mbox{\hyperlink{namespacecrosscorr__mod_a7e42791732acdd50278751c5d4439068}{getpreviousexponent}}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00405}00405 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00406}00406 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00407}00407 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00419}\mbox{\hyperlink{namespacecrosscorr__mod_a2aa1e7aab0ed6b28a2c093270364210e}{00419}}     \textcolor{keywordtype}{pure} \textcolor{keyword}{function }\mbox{\hyperlink{namespacecrosscorr__mod_a2aa1e7aab0ed6b28a2c093270364210e}{getnextexponent}}(absoluteValue,base) \textcolor{keyword}{result}(nextExponent)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00420}00420 \textcolor{preprocessor}{\#if INTEL\_COMPILER\_ENABLED \&\& defined DLL\_ENABLED \&\& (OS\_IS\_WINDOWS || defined OS\_IS\_DARWIN)}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00421}00421 \textcolor{preprocessor}{}        \textcolor{comment}{!DEC\$ ATTRIBUTES DLLEXPORT :: getNextExponent}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00422}00422 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00423}00423 \textcolor{preprocessor}{}        \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceconstants__mod}{constants\_mod}}, \textcolor{keywordtype}{only}: ik, rk, \mbox{\hyperlink{namespaceconstants__mod_a6f812cdff0771059f9fc402e1c60011d}{invln2}}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00424}00424 \textcolor{keywordtype}{        real}(rk), \textcolor{keywordtype}{intent(in)}            :: absolutevalue}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00425}00425 \textcolor{keywordtype}{        real}(rk), \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional}  :: base}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00426}00426         \textcolor{keywordtype}{integer(IK)}                     :: nextexponent}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00427}00427         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(base)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00428}00428             nextexponent = ceiling( log(absolutevalue) / log(base) )}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00429}00429         \textcolor{keywordflow}{else}    \textcolor{comment}{! assume the base is 2}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00430}00430             nextexponent = ceiling( log(absolutevalue) * \mbox{\hyperlink{namespaceconstants__mod_a6f812cdff0771059f9fc402e1c60011d}{invln2}} )}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00431}00431 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00432}00432     \textcolor{keyword}{end function }\mbox{\hyperlink{namespacecrosscorr__mod_a2aa1e7aab0ed6b28a2c093270364210e}{getnextexponent}}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00433}00433 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00434}00434 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00435}00435 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00449}\mbox{\hyperlink{namespacecrosscorr__mod_ac5d364ac18bf70229f26b150e9cadea0}{00449}}     \textcolor{keywordtype}{pure} \textcolor{keyword}{function }\mbox{\hyperlink{namespacecrosscorr__mod_ac5d364ac18bf70229f26b150e9cadea0}{padzero}}(currentLen,Array,paddedLen) \textcolor{keyword}{result}(ArrayPadded)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00450}00450 \textcolor{preprocessor}{\#if INTEL\_COMPILER\_ENABLED \&\& defined DLL\_ENABLED \&\& (OS\_IS\_WINDOWS || defined OS\_IS\_DARWIN)}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00451}00451 \textcolor{preprocessor}{}        \textcolor{comment}{!DEC\$ ATTRIBUTES DLLEXPORT :: padZero}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00452}00452 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00453}00453 \textcolor{preprocessor}{}        \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceconstants__mod}{constants\_mod}}, \textcolor{keywordtype}{only}: ik, rk}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00454}00454         \textcolor{keywordtype}{integer(IK)} , \textcolor{keywordtype}{intent(in)}            :: currentlen}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00455}00455 \textcolor{keywordtype}{        real}(rk)    , \textcolor{keywordtype}{intent(in)}            :: array(currentlen)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00456}00456         \textcolor{keywordtype}{integer(IK)} , \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional}  :: paddedlen}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00457}00457 \textcolor{keywordtype}{        real}(rk)    , \textcolor{keywordtype}{allocatable}           :: arraypadded(:)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00458}00458         \textcolor{keywordtype}{integer(IK)}                         :: i, paddedsize}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00459}00459         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(paddedlen)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00460}00460             paddedsize = paddedlen}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00461}00461         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00462}00462             paddedsize = 2 ** ( \mbox{\hyperlink{namespacecrosscorr__mod_a2aa1e7aab0ed6b28a2c093270364210e}{getnextexponent}}(real(currentlen,kind=rk)) + 1 )}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00463}00463 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00464}00464         \textcolor{keyword}{allocate}(arraypadded(paddedsize))}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00465}00465         \textcolor{keywordflow}{do} concurrent(i=1:currentlen)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00466}00466             arraypadded(i) = array(i)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00467}00467 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00468}00468         \textcolor{keywordflow}{do} concurrent(i=currentlen+1:paddedsize)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00469}00469             arraypadded(i) = 0.\_rk}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00470}00470 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00471}00471     \textcolor{keyword}{end function }\mbox{\hyperlink{namespacecrosscorr__mod_ac5d364ac18bf70229f26b150e9cadea0}{padzero}}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00472}00472 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00473}00473 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00474}00474 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00496}\mbox{\hyperlink{namespacecrosscorr__mod_aae681614829163bf4c104c0c15a37dcd}{00496}}     \textcolor{keyword}{function }\mbox{\hyperlink{namespacecrosscorr__mod_aae681614829163bf4c104c0c15a37dcd}{getcrosscorrfft}}(paddedLen, PaddedData1, PaddedData2) \textcolor{keyword}{result}(CrossCorrFFT)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00497}00497 \textcolor{preprocessor}{\#if INTEL\_COMPILER\_ENABLED \&\& defined DLL\_ENABLED \&\& (OS\_IS\_WINDOWS || defined OS\_IS\_DARWIN)}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00498}00498 \textcolor{preprocessor}{}        \textcolor{comment}{!DEC\$ ATTRIBUTES DLLEXPORT :: getCrossCorrFFT}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00499}00499 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00500}00500 \textcolor{preprocessor}{}        \textcolor{keywordtype}{use }iso\_fortran\_env, \textcolor{keywordtype}{only}: output\_unit}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00501}00501         \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceconstants__mod}{constants\_mod}}, \textcolor{keywordtype}{only}: ik, rk, \mbox{\hyperlink{namespaceconstants__mod_a570f1c2f3601237b3e8cc02f262bab24}{ck}}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00502}00502 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00503}00503         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00504}00504 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00505}00505         \textcolor{keywordtype}{integer(IK)}, \textcolor{keywordtype}{intent(in)}                 :: paddedlen}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00506}00506 \textcolor{keywordtype}{        real}(rk), \textcolor{keywordtype}{intent(inout)}                 :: paddeddata1(paddedlen), paddeddata2(paddedlen)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00507}00507 \textcolor{keywordtype}{        real}(rk)                                :: crosscorrfft(paddedlen)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00508}00508 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00509}00509         \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{parameter}             :: procedure\_name = \mbox{\hyperlink{namespaceconstants__mod_a7facbdd6f237b77f9c08c94fbe98e847}{module\_name}}//\textcolor{stringliteral}{"{}@getCrossCorrFFT()"{}}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00510}00510         \textcolor{keywordtype}{complex(CK)}, \textcolor{keywordtype}{dimension(paddedLen/2)}     :: cdat1, cdat2}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00511}00511         \textcolor{keywordtype}{integer(IK)}                             :: paddedlenhalf, paddedlenquarter}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00512}00512 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00513}00513         \textcolor{keywordflow}{if} (iand(paddedlen,paddedlen-\/1) /= 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00514}00514             \textcolor{keyword}{write}(output\_unit,\textcolor{stringliteral}{"{}(A)"{}}) procedure\_name//\textcolor{stringliteral}{"{}: paddedLen must be a power of 2."{}}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00515}00515             error stop}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00516}00516 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00517}00517 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00518}00518         paddedlenhalf = paddedlen / 2}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00519}00519         paddedlenquarter = paddedlenhalf / 2}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00520}00520         \textcolor{keyword}{call }\mbox{\hyperlink{namespacecrosscorr__mod_abdd5852483e3c9cafbc7eef75cdcc9d7}{realft}}(paddedlen, paddedlenhalf, paddedlenquarter, paddeddata1, 1\_ik, cdat1)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00521}00521         \textcolor{keyword}{call }\mbox{\hyperlink{namespacecrosscorr__mod_abdd5852483e3c9cafbc7eef75cdcc9d7}{realft}}(paddedlen, paddedlenhalf, paddedlenquarter, paddeddata2, 1\_ik, cdat2)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00522}00522         cdat1(1) = cmplx( real(cdat1(1)) * real(cdat2(1)) / paddedlenhalf, aimag(cdat1(1)) * aimag(cdat2(1)) / paddedlenhalf , kind = \mbox{\hyperlink{namespaceconstants__mod_a570f1c2f3601237b3e8cc02f262bab24}{ck}} )}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00523}00523         cdat1(2:paddedlenhalf) = cdat1(2:paddedlenhalf) * conjg(cdat2(2:paddedlenhalf)) / paddedlenhalf}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00524}00524         \textcolor{keyword}{call }\mbox{\hyperlink{namespacecrosscorr__mod_abdd5852483e3c9cafbc7eef75cdcc9d7}{realft}}(paddedlen, paddedlenhalf, paddedlenquarter, crosscorrfft, -\/1\_ik, cdat1)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00525}00525 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00526}00526     \textcolor{keyword}{end function }\mbox{\hyperlink{namespacecrosscorr__mod_aae681614829163bf4c104c0c15a37dcd}{getcrosscorrfft}}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00527}00527 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00528}00528 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00529}00529 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00552}\mbox{\hyperlink{namespacecrosscorr__mod_a247f997287f07e7f497107335d7deddf}{00552}}     \textcolor{keyword}{function }\mbox{\hyperlink{namespacecrosscorr__mod_a247f997287f07e7f497107335d7deddf}{getcrosscorrweightedfft}}(lenCompactData1, lenCompactData2, paddedLen, CompactData1, CompactData2, Weight1, Weight2) \textcolor{keyword}{result}(CrossCorrFFT)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00553}00553 \textcolor{preprocessor}{\#if INTEL\_COMPILER\_ENABLED \&\& defined DLL\_ENABLED \&\& (OS\_IS\_WINDOWS || defined OS\_IS\_DARWIN)}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00554}00554 \textcolor{preprocessor}{}        \textcolor{comment}{!DEC\$ ATTRIBUTES DLLEXPORT :: getCrossCorrWeightedFFT}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00555}00555 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00556}00556 \textcolor{preprocessor}{}        \textcolor{keywordtype}{use }iso\_fortran\_env, \textcolor{keywordtype}{only}: output\_unit}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00557}00557         \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceconstants__mod}{constants\_mod}}, \textcolor{keywordtype}{only}: ik, rk, \mbox{\hyperlink{namespaceconstants__mod_a570f1c2f3601237b3e8cc02f262bab24}{ck}}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00558}00558         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00559}00559         \textcolor{keywordtype}{integer(IK)}, \textcolor{keywordtype}{intent(in)}                 :: lencompactdata1, lencompactdata2, paddedlen}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00560}00560 \textcolor{keywordtype}{        real}(rk), \textcolor{keywordtype}{intent(in)}                    :: compactdata1(lencompactdata1), compactdata2(lencompactdata2)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00561}00561         \textcolor{keywordtype}{integer(IK)}, \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional}       :: weight1(lencompactdata1), weight2(lencompactdata2)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00562}00562 \textcolor{keywordtype}{        real}(rk)                                :: crosscorrfft(paddedlen)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00563}00563 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00564}00564         \textcolor{keywordtype}{character(len=*)}, \textcolor{keywordtype}{parameter}             :: procedure\_name = \mbox{\hyperlink{namespaceconstants__mod_a7facbdd6f237b77f9c08c94fbe98e847}{module\_name}}//\textcolor{stringliteral}{"{}@getCrossCorrWeightedFFT()"{}}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00565}00565 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00566}00566         \textcolor{keywordtype}{complex(CK)}, \textcolor{keywordtype}{dimension(paddedLen/2)}     :: cdat1, cdat2}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00567}00567         \textcolor{keywordtype}{integer(IK)}                             :: paddedlenhalf, paddedlenquarter}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00568}00568 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00569}00569         \textcolor{keywordflow}{if} (iand(paddedlen,paddedlen-\/1) /= 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00570}00570             \textcolor{keyword}{write}(output\_unit,\textcolor{stringliteral}{"{}(A)"{}}) procedure\_name//\textcolor{stringliteral}{"{}: paddedLen must be a power of 2."{}}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00571}00571             error stop}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00572}00572 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00573}00573 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00574}00574         paddedlenhalf = paddedlen / 2}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00575}00575         paddedlenquarter = paddedlenhalf / 2}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00576}00576         \textcolor{keyword}{call }\mbox{\hyperlink{namespacecrosscorr__mod_ad6509a008e667773d89b82399cdf9d0f}{realftweighted}}(lencompactdata1, paddedlen, paddedlenhalf, paddedlenquarter, compactdata1, cdat1, weight1)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00577}00577         \textcolor{keyword}{call }\mbox{\hyperlink{namespacecrosscorr__mod_ad6509a008e667773d89b82399cdf9d0f}{realftweighted}}(lencompactdata2, paddedlen, paddedlenhalf, paddedlenquarter, compactdata2, cdat2, weight2)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00578}00578         cdat1(1) = cmplx( real(cdat1(1)) * real(cdat2(1)) / paddedlenhalf, aimag(cdat1(1)) * aimag(cdat2(1)) / paddedlenhalf , kind = \mbox{\hyperlink{namespaceconstants__mod_a570f1c2f3601237b3e8cc02f262bab24}{ck}} )}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00579}00579         cdat1(2:paddedlenhalf) = cdat1(2:paddedlenhalf) * conjg(cdat2(2:paddedlenhalf)) / paddedlenhalf}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00580}00580         \textcolor{keyword}{call }\mbox{\hyperlink{namespacecrosscorr__mod_abdd5852483e3c9cafbc7eef75cdcc9d7}{realft}}(paddedlen, paddedlenhalf, paddedlenquarter, crosscorrfft, -\/1\_ik, cdat1)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00581}00581 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00582}00582     \textcolor{keyword}{end function }\mbox{\hyperlink{namespacecrosscorr__mod_a247f997287f07e7f497107335d7deddf}{getcrosscorrweightedfft}}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00583}00583 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00584}00584 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00585}00585 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00586}00586     \textcolor{comment}{! Here, `paddedLenQuarter` is 1/4 of the length of the input array, which is already padded with zeros.}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00587}\mbox{\hyperlink{namespacecrosscorr__mod_abdd5852483e3c9cafbc7eef75cdcc9d7}{00587}}     \textcolor{keyword}{subroutine }\mbox{\hyperlink{namespacecrosscorr__mod_abdd5852483e3c9cafbc7eef75cdcc9d7}{realft}}(paddedLen, paddedLenHalf, paddedLenQuarter, PaddedData, isign, Zdata)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00588}00588 \textcolor{preprocessor}{\#if INTEL\_COMPILER\_ENABLED \&\& defined DLL\_ENABLED \&\& (OS\_IS\_WINDOWS || defined OS\_IS\_DARWIN)}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00589}00589 \textcolor{preprocessor}{}        \textcolor{comment}{!DEC\$ ATTRIBUTES DLLEXPORT :: realft}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00590}00590 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00591}00591 \textcolor{preprocessor}{}        \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceconstants__mod}{constants\_mod}}, \textcolor{keywordtype}{only}: ik, rk, \mbox{\hyperlink{namespaceconstants__mod_a570f1c2f3601237b3e8cc02f262bab24}{ck}}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00592}00592         \textcolor{keywordtype}{use }\mbox{\hyperlink{namespacemisc__mod}{misc\_mod}}, \textcolor{keywordtype}{only}: \mbox{\hyperlink{namespacemisc__mod_a5c8aee1f0ef1290e5061582b2c12b616}{zroots\_unity}}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00593}00593 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00594}00594         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00595}00595 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00596}00596         \textcolor{keywordtype}{integer(IK)}, \textcolor{keywordtype}{intent(in)}                     :: paddedLen, paddedLenHalf, paddedLenQuarter, isign}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00597}00597 \textcolor{keywordtype}{        real}(RK), \textcolor{keywordtype}{intent(inout)}                     :: PaddedData(paddedLen)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00598}00598         \textcolor{keywordtype}{complex(CK)}, \textcolor{keywordtype}{optional}, \textcolor{keywordtype}{target}               :: Zdata(paddedLenHalf)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00599}00599 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00600}00600         \textcolor{keywordtype}{complex(CK)}, \textcolor{keywordtype}{dimension(paddedLenQuarter-\/1)}  :: h1, h2}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00601}00601         \textcolor{keywordtype}{complex(CK)}, \textcolor{keywordtype}{pointer}                        :: Cdata(:)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00602}00602         \textcolor{keywordtype}{complex(CK)}                                 :: w(paddedLenQuarter)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00603}00603         \textcolor{keywordtype}{complex(CK)}                                 :: z}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00604}00604 \textcolor{keywordtype}{        real}(RK)                                    :: c1, c2}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00605}00605 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00606}00606         c1 = 0.5\_rk}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00607}00607 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00608}00608         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(zdata)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00609}00609             cdata => zdata}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00610}00610             \textcolor{keywordflow}{if} (isign == 1\_ik) cdata = cmplx(paddeddata(1:paddedlen-\/1:2), paddeddata(2:paddedlen:2), kind=\mbox{\hyperlink{namespaceconstants__mod_a570f1c2f3601237b3e8cc02f262bab24}{ck}})}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00611}00611         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00612}00612             \textcolor{keyword}{allocate}(cdata(paddedlenhalf))}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00613}00613             cdata = cmplx(paddeddata(1:paddedlen-\/1:2), paddeddata(2:paddedlen:2), kind=\mbox{\hyperlink{namespaceconstants__mod_a570f1c2f3601237b3e8cc02f262bab24}{ck}})}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00614}00614 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00615}00615 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00616}00616         \textcolor{keywordflow}{if} (isign == 1\_ik) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00617}00617             c2 = -\/0.5\_rk}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00618}00618             \textcolor{keyword}{call }\mbox{\hyperlink{namespacecrosscorr__mod_a8f893aae01f0ccb0cfb7ebf5a89df126}{four1}}(paddedlenhalf, cdata, +1\_ik)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00619}00619         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00620}00620             c2 = 0.5\_rk}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00621}00621 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00622}00622 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00623}00623         w = \mbox{\hyperlink{namespacemisc__mod_a5c8aee1f0ef1290e5061582b2c12b616}{zroots\_unity}}(sign(paddedlen,isign), paddedlenquarter)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00624}00624         w = cmplx(-\/aimag(w), real(w), kind=\mbox{\hyperlink{namespaceconstants__mod_a570f1c2f3601237b3e8cc02f262bab24}{ck}})}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00625}00625         h1 = c1 * ( cdata(2:paddedlenquarter) + conjg(cdata(paddedlenhalf:paddedlenquarter+2:-\/1)) )}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00626}00626         h2 = c2 * ( cdata(2:paddedlenquarter) -\/ conjg(cdata(paddedlenhalf:paddedlenquarter+2:-\/1)) )}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00627}00627         cdata(2:paddedlenquarter) = h1 + w(2:paddedlenquarter) * h2}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00628}00628         cdata(paddedlenhalf:paddedlenquarter+2:-\/1) = conjg(h1 -\/ w(2:paddedlenquarter) * h2)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00629}00629         z = cdata(1)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00630}00630 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00631}00631         \textcolor{keywordflow}{if} (isign == 1\_ik) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00632}00632             cdata(1) = cmplx(real(z)+aimag(z), real(z)-\/aimag(z), kind=\mbox{\hyperlink{namespaceconstants__mod_a570f1c2f3601237b3e8cc02f262bab24}{ck}})}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00633}00633         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00634}00634             cdata(1) = cmplx(c1*(real(z)+aimag(z)), c1*(real(z)-\/aimag(z)), kind=\mbox{\hyperlink{namespaceconstants__mod_a570f1c2f3601237b3e8cc02f262bab24}{ck}})}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00635}00635             \textcolor{keyword}{call }\mbox{\hyperlink{namespacecrosscorr__mod_a8f893aae01f0ccb0cfb7ebf5a89df126}{four1}}(paddedlenhalf, cdata, -\/1)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00636}00636 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00637}00637 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00638}00638      \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(zdata)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00639}00639             \textcolor{keywordflow}{if} (isign /= 1\_ik) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00640}00640                 paddeddata(1:paddedlen-\/1:2) = real(cdata)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00641}00641                 paddeddata(2:paddedlen:2) = aimag(cdata)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00642}00642 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00643}00643         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00644}00644             paddeddata(1:paddedlen-\/1:2) = real(cdata)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00645}00645             paddeddata(2:paddedlen:2) = aimag(cdata)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00646}00646             \textcolor{keyword}{nullify}(cdata)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00647}00647 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00648}00648 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00649}00649     \textcolor{keyword}{end subroutine }\mbox{\hyperlink{namespacecrosscorr__mod_abdd5852483e3c9cafbc7eef75cdcc9d7}{realft}}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00650}00650 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00651}00651 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00652}00652 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00653}00653     \textcolor{comment}{! The `lenCompactData` is the length of the compact input array `CompactData`, which is NOT padded by default.}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00654}\mbox{\hyperlink{namespacecrosscorr__mod_ad6509a008e667773d89b82399cdf9d0f}{00654}}     \textcolor{keyword}{subroutine }\mbox{\hyperlink{namespacecrosscorr__mod_ad6509a008e667773d89b82399cdf9d0f}{realftweighted}}(lenCompactData, paddedLen, paddedLenHalf, paddedLenQuarter, CompactData, Zdata, Weight)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00655}00655 \textcolor{preprocessor}{\#if INTEL\_COMPILER\_ENABLED \&\& defined DLL\_ENABLED \&\& (OS\_IS\_WINDOWS || defined OS\_IS\_DARWIN)}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00656}00656 \textcolor{preprocessor}{}        \textcolor{comment}{!DEC\$ ATTRIBUTES DLLEXPORT :: realftWeighted}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00657}00657 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00658}00658 \textcolor{preprocessor}{}        \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceconstants__mod}{constants\_mod}}, \textcolor{keywordtype}{only}: ik, rk, \mbox{\hyperlink{namespaceconstants__mod_a570f1c2f3601237b3e8cc02f262bab24}{ck}}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00659}00659         \textcolor{keywordtype}{use }\mbox{\hyperlink{namespacemisc__mod}{misc\_mod}}, \textcolor{keywordtype}{only}: \mbox{\hyperlink{namespacemisc__mod_a5c8aee1f0ef1290e5061582b2c12b616}{zroots\_unity}}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00660}00660 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00661}00661         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00662}00662 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00663}00663         \textcolor{keywordtype}{integer(IK)} , \textcolor{keywordtype}{intent(in)}            :: lenCompactData, paddedLen, paddedLenHalf, paddedLenQuarter}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00664}00664 \textcolor{keywordtype}{        real}(RK)    , \textcolor{keywordtype}{intent(in)}            :: CompactData(lenCompactData)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00665}00665         \textcolor{keywordtype}{integer(IK)} , \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional}  :: Weight(lenCompactData)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00666}00666         \textcolor{keywordtype}{complex(CK)} , \textcolor{keywordtype}{intent(out)}           :: Zdata(paddedLenHalf)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00667}00667 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00668}00668         \textcolor{keywordtype}{integer(IK)}                         :: id, idEnd, iw, counter}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00669}00669         \textcolor{keywordtype}{complex(CK)}                         :: w(paddedLenQuarter)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00670}00670         \textcolor{keywordtype}{complex(CK)}                         :: h1(paddedLenQuarter-\/1)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00671}00671         \textcolor{keywordtype}{complex(CK)}                         :: h2(paddedLenQuarter-\/1)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00672}00672 \textcolor{keywordtype}{        real}(RK)                            :: zReal, zImag}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00673}00673 \textcolor{keywordtype}{        real}(RK)                            :: c1, c2}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00674}00674 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00675}00675         c1 = 0.5\_rk}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00676}00676 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00677}00677         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(weight)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00678}00678 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00679}00679             iw = 1}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00680}00680             counter = 0}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00681}00681             loopovercompactdata: \textcolor{keywordflow}{do} id = 1, lencompactdata}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00682}00682                 loopoverweight: \textcolor{keywordflow}{do}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00683}00683                     \textcolor{keywordflow}{if} (iw>weight(id)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00684}00684                         iw = 1}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00685}00685                         cycle loopovercompactdata}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00686}00686                     \textcolor{keywordflow}{elseif} (iw==weight(id)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00687}00687                         counter = counter + 1}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00688}00688                         \textcolor{keywordflow}{if} (id==lencompactdata) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00689}00689                             zdata(counter) = cmplx( compactdata(id) , 0.\_rk , kind=\mbox{\hyperlink{namespaceconstants__mod_a570f1c2f3601237b3e8cc02f262bab24}{ck}} )}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00690}00690                             \textcolor{keywordflow}{exit} loopovercompactdata}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00691}00691                         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00692}00692                             zdata(counter) = cmplx( compactdata(id) , compactdata(id+1) , kind=\mbox{\hyperlink{namespaceconstants__mod_a570f1c2f3601237b3e8cc02f262bab24}{ck}} )}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00693}00693                             iw = 2}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00694}00694                             cycle loopovercompactdata}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00695}00695 \textcolor{keywordflow}{                        end if}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00696}00696                     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00697}00697                         counter = counter + 1}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00698}00698                         zdata(counter) = cmplx( compactdata(id) , compactdata(id) , kind=\mbox{\hyperlink{namespaceconstants__mod_a570f1c2f3601237b3e8cc02f262bab24}{ck}} )}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00699}00699                         iw = iw + 2}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00700}00700                         cycle loopoverweight}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00701}00701 \textcolor{keywordflow}{                    end if}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00702}00702 \textcolor{keywordflow}{                end do} loopoverweight}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00703}00703 \textcolor{keywordflow}{            end do} loopovercompactdata}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00704}00704             zdata(counter+1:paddedlenhalf) = cmplx( 0.\_rk , 0.\_rk , kind=\mbox{\hyperlink{namespaceconstants__mod_a570f1c2f3601237b3e8cc02f262bab24}{ck}} )}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00705}00705 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00706}00706         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00707}00707 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00708}00708             idend = lencompactdata / 2\_ik}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00709}00709             \textcolor{keywordflow}{do} concurrent(id=1:idend)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00710}00710                 zdata(id) = cmplx( compactdata(2*id-\/1) , compactdata(2*id) , kind=\mbox{\hyperlink{namespaceconstants__mod_a570f1c2f3601237b3e8cc02f262bab24}{ck}} )}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00711}00711 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00712}00712             \textcolor{keywordflow}{if} (2*idend<lencompactdata) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00713}00713                 idend = idend + 1}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00714}00714                 zdata(idend) = cmplx( compactdata(lencompactdata) , 0.\_rk , kind=\mbox{\hyperlink{namespaceconstants__mod_a570f1c2f3601237b3e8cc02f262bab24}{ck}} )}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00715}00715 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00716}00716             zdata(idend+1:paddedlenhalf) = cmplx(0.\_rk, 0.\_rk, kind=\mbox{\hyperlink{namespaceconstants__mod_a570f1c2f3601237b3e8cc02f262bab24}{ck}})}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00717}00717 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00718}00718 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00719}00719 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00720}00720         c2 = -\/0.5\_rk}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00721}00721         \textcolor{keyword}{call }\mbox{\hyperlink{namespacecrosscorr__mod_a8f893aae01f0ccb0cfb7ebf5a89df126}{four1}}(paddedlenhalf,zdata,1\_ik)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00722}00722 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00723}00723         w = \mbox{\hyperlink{namespacemisc__mod_a5c8aee1f0ef1290e5061582b2c12b616}{zroots\_unity}}(paddedlen, paddedlenquarter)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00724}00724         w = cmplx(-\/aimag(w), real(w,kind=rk), kind=\mbox{\hyperlink{namespaceconstants__mod_a570f1c2f3601237b3e8cc02f262bab24}{ck}})}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00725}00725         h1 = c1 * ( zdata(2:paddedlenquarter) + conjg(zdata(paddedlenhalf:paddedlenquarter+2:-\/1)) )}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00726}00726         h2 = c2 * ( zdata(2:paddedlenquarter) -\/ conjg(zdata(paddedlenhalf:paddedlenquarter+2:-\/1)) )}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00727}00727         zdata(2:paddedlenquarter) = h1 + w(2:paddedlenquarter) * h2}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00728}00728         zdata(paddedlenhalf:paddedlenquarter+2:-\/1) = conjg(h1 -\/ w(2:paddedlenquarter) * h2)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00729}00729         zreal = real(zdata(1)); zimag = aimag(zdata(1))}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00730}00730         zdata(1) = cmplx(zreal+zimag, zreal-\/zimag, kind=\mbox{\hyperlink{namespaceconstants__mod_a570f1c2f3601237b3e8cc02f262bab24}{ck}})}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00731}00731 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00732}00732     \textcolor{keyword}{end subroutine }\mbox{\hyperlink{namespacecrosscorr__mod_ad6509a008e667773d89b82399cdf9d0f}{realftweighted}}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00733}00733 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00734}00734 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00735}00735 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00736}\mbox{\hyperlink{namespacecrosscorr__mod_a8f893aae01f0ccb0cfb7ebf5a89df126}{00736}}     \textcolor{keyword}{subroutine }\mbox{\hyperlink{namespacecrosscorr__mod_a8f893aae01f0ccb0cfb7ebf5a89df126}{four1}}(ndata,Data,isign)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00737}00737 \textcolor{preprocessor}{\#if INTEL\_COMPILER\_ENABLED \&\& defined DLL\_ENABLED \&\& (OS\_IS\_WINDOWS || defined OS\_IS\_DARWIN)}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00738}00738 \textcolor{preprocessor}{}        \textcolor{comment}{!DEC\$ ATTRIBUTES DLLEXPORT :: four1}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00739}00739 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00740}00740 \textcolor{preprocessor}{}        \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceconstants__mod}{constants\_mod}}, \textcolor{keywordtype}{only}: ik, rk, \mbox{\hyperlink{namespaceconstants__mod_a570f1c2f3601237b3e8cc02f262bab24}{ck}}, \mbox{\hyperlink{namespaceconstants__mod_a31ceb84e37f3a59811b8dab97fca8ae2}{twopi}}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00741}00741         \textcolor{keywordtype}{use }\mbox{\hyperlink{namespacemisc__mod}{misc\_mod}}, \textcolor{keywordtype}{only}: \mbox{\hyperlink{interfacemisc__mod_1_1arth}{arth}}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00742}00742         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00743}00743         \textcolor{keywordtype}{integer(IK)}, \textcolor{keywordtype}{intent(in)}    :: ndata, isign}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00744}00744         \textcolor{keywordtype}{complex(CK)}, \textcolor{keywordtype}{intent(inout)} :: Data(ndata)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00745}00745         \textcolor{keywordtype}{complex(CK)}, \textcolor{keywordtype}{allocatable}   :: dat(:,:), temp(:,:)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00746}00746         \textcolor{keywordtype}{complex(CK)}, \textcolor{keywordtype}{allocatable}   :: w(:),wp(:)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00747}00747 \textcolor{keywordtype}{        real}(RK)   , \textcolor{keywordtype}{allocatable}   :: theta(:)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00748}00748         \textcolor{keywordtype}{integer(IK)} :: m1,m2,j}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00749}00749         m1=2**ceiling(0.5\_rk*log(real(ndata,rk))/0.693147\_rk)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00750}00750         m2=ndata/m1}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00751}00751         \textcolor{keyword}{allocate}(dat(m1,m2),theta(m1),w(m1),wp(m1),temp(m2,m1))}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00752}00752         dat=reshape(\textcolor{keyword}{Data},shape(dat))}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00753}00753         \textcolor{keyword}{call }\mbox{\hyperlink{namespacecrosscorr__mod_acdb5c41e158196bce3e2060fe3991c40}{fourrow}}(dat,isign)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00754}00754         theta=\mbox{\hyperlink{interfacemisc__mod_1_1arth}{arth}}(0,isign,m1)*\mbox{\hyperlink{namespaceconstants__mod_a31ceb84e37f3a59811b8dab97fca8ae2}{twopi}}/ndata}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00755}00755         wp=cmplx(-\/2.0\_rk*sin(0.5\_rk*theta)**2,sin(theta),kind=\mbox{\hyperlink{namespaceconstants__mod_a570f1c2f3601237b3e8cc02f262bab24}{ck}})}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00756}00756         w=cmplx(1.0\_rk,0.0\_rk,kind=\mbox{\hyperlink{namespaceconstants__mod_a570f1c2f3601237b3e8cc02f262bab24}{ck}})}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00757}00757         \textcolor{keywordflow}{do} j=2,m2}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00758}00758             w=w*wp+w}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00759}00759             dat(:,j)=dat(:,j)*w}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00760}00760 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00761}00761         temp=transpose(dat)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00762}00762         \textcolor{keyword}{call }\mbox{\hyperlink{namespacecrosscorr__mod_acdb5c41e158196bce3e2060fe3991c40}{fourrow}}(temp,isign)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00763}00763         data=reshape(temp,shape(data))}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00764}00764         \textcolor{keyword}{deallocate}(dat,w,wp,theta,temp)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00765}00765     \textcolor{keyword}{end subroutine }\mbox{\hyperlink{namespacecrosscorr__mod_a8f893aae01f0ccb0cfb7ebf5a89df126}{four1}}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00766}00766 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00767}00767 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00768}00768 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00769}\mbox{\hyperlink{namespacecrosscorr__mod_acdb5c41e158196bce3e2060fe3991c40}{00769}}     \textcolor{keyword}{subroutine }\mbox{\hyperlink{namespacecrosscorr__mod_acdb5c41e158196bce3e2060fe3991c40}{fourrow}}(Data,isign)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00770}00770 \textcolor{preprocessor}{\#if INTEL\_COMPILER\_ENABLED \&\& defined DLL\_ENABLED \&\& (OS\_IS\_WINDOWS || defined OS\_IS\_DARWIN)}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00771}00771 \textcolor{preprocessor}{}        \textcolor{comment}{!DEC\$ ATTRIBUTES DLLEXPORT :: fourrow}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00772}00772 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00773}00773 \textcolor{preprocessor}{}        \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceconstants__mod}{constants\_mod}}, \textcolor{keywordtype}{only}: ik, rk, \mbox{\hyperlink{namespaceconstants__mod_a570f1c2f3601237b3e8cc02f262bab24}{ck}}, \mbox{\hyperlink{namespaceconstants__mod_a36fefa8a6c72f790763382d69f8443fa}{pi}}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00774}00774         \textcolor{keywordtype}{use }\mbox{\hyperlink{namespacemisc__mod}{misc\_mod}}, \textcolor{keywordtype}{only}: \mbox{\hyperlink{interfacemisc__mod_1_1swap}{swap}}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00775}00775         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00776}00776         \textcolor{keywordtype}{complex(CK)}, \textcolor{keywordtype}{dimension(:,:)}, \textcolor{keywordtype}{intent(inout)} :: Data}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00777}00777         \textcolor{keywordtype}{integer(IK)}, \textcolor{keywordtype}{intent(in)}                    :: isign}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00778}00778         \textcolor{keywordtype}{integer(IK)}                                :: n,i,istep,j,m,mmax,n2}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00779}00779 \textcolor{keywordtype}{        real}(RK)                                   :: theta}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00780}00780         \textcolor{keywordtype}{complex(CK)}, \textcolor{keywordtype}{dimension(size(Data,1))}       :: temp}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00781}00781         \textcolor{keywordtype}{complex(CK)}                                :: w,wp}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00782}00782         \textcolor{keywordtype}{complex(CK)}                                :: ws}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00783}00783         n=\textcolor{keyword}{size}(\textcolor{keyword}{Data},2)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00784}00784         n2=n/2}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00785}00785         j=n2}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00786}00786         \textcolor{keywordflow}{do} i=1,n-\/2}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00787}00787             \textcolor{keywordflow}{if} (j > i) \textcolor{keyword}{call }\mbox{\hyperlink{interfacemisc__mod_1_1swap}{swap}}(\textcolor{keyword}{Data}(:,j+1),\textcolor{keyword}{Data}(:,i+1))}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00788}00788             m=n2}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00789}00789             \textcolor{keywordflow}{do}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00790}00790                 \textcolor{keywordflow}{if} (m < 2 .or. j < m) \textcolor{keywordflow}{exit}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00791}00791                 j=j-\/m}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00792}00792                 m=m/2}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00793}00793 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00794}00794             j=j+m}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00795}00795 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00796}00796         mmax=1}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00797}00797         \textcolor{keywordflow}{do}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00798}00798             \textcolor{keywordflow}{if} (n <= mmax) \textcolor{keywordflow}{exit}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00799}00799             istep=2*mmax}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00800}00800             theta=\mbox{\hyperlink{namespaceconstants__mod_a36fefa8a6c72f790763382d69f8443fa}{pi}}/(isign*mmax)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00801}00801             wp=cmplx(-\/2.0\_rk*sin(0.5\_rk*theta)**2,sin(theta),kind=\mbox{\hyperlink{namespaceconstants__mod_a570f1c2f3601237b3e8cc02f262bab24}{ck}})}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00802}00802             w=cmplx(1.0\_rk,0.0\_rk,kind=\mbox{\hyperlink{namespaceconstants__mod_a570f1c2f3601237b3e8cc02f262bab24}{ck}})}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00803}00803             \textcolor{keywordflow}{do} m=1,mmax}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00804}00804                 ws=w}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00805}00805                 \textcolor{keywordflow}{do} i=m,n,istep}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00806}00806                     j=i+mmax}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00807}00807                     temp=ws*\textcolor{keyword}{Data}(:,j)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00808}00808                     \textcolor{keyword}{Data}(:,j)=\textcolor{keyword}{Data}(:,i)-\/temp}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00809}00809                     \textcolor{keyword}{Data}(:,i)=\textcolor{keyword}{Data}(:,i)+temp}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00810}00810 \textcolor{keywordflow}{                end do}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00811}00811                 w=w*wp+w}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00812}00812 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00813}00813             mmax=istep}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00814}00814 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00815}00815     \textcolor{keyword}{end subroutine }\mbox{\hyperlink{namespacecrosscorr__mod_acdb5c41e158196bce3e2060fe3991c40}{fourrow}}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00816}00816 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00817}00817 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00818}00818 \textcolor{comment}{! The following are for the AutoCorrelation computation using the conventional definition of correlation.}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00819}00819 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00820}00820 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00821}\mbox{\hyperlink{namespacecrosscorr__mod_a3452d1f0726e3fecd23bd0a64dea8fcf}{00821}}     \textcolor{keywordtype}{pure} \textcolor{keyword}{function }\mbox{\hyperlink{namespacecrosscorr__mod_a3452d1f0726e3fecd23bd0a64dea8fcf}{getinversesumnormeddatasq}}(nd,np,NormedData) \textcolor{keyword}{result}(InverseSumNormedDataSq)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00822}00822 \textcolor{preprocessor}{\#if INTEL\_COMPILER\_ENABLED \&\& defined DLL\_ENABLED \&\& (OS\_IS\_WINDOWS || defined OS\_IS\_DARWIN)}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00823}00823 \textcolor{preprocessor}{}        \textcolor{comment}{!DEC\$ ATTRIBUTES DLLEXPORT :: getInverseSumNormedDataSq}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00824}00824 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00825}00825 \textcolor{preprocessor}{}        \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceconstants__mod}{constants\_mod}}, \textcolor{keywordtype}{only}: ik, rk}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00826}00826         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00827}00827         \textcolor{keywordtype}{integer(IK)}, \textcolor{keywordtype}{intent(in)}     :: nd,np}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00828}00828 \textcolor{keywordtype}{        real}(rk)   , \textcolor{keywordtype}{intent(in)}     :: normeddata(nd,np)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00829}00829 \textcolor{keywordtype}{        real}(rk)                    :: inversesumnormeddatasq(nd)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00830}00830         \textcolor{keywordtype}{integer(IK)}                 :: ip}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00831}00831         inversesumnormeddatasq = 0.\_rk}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00832}00832         \textcolor{keywordflow}{do} ip = 1, np}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00833}00833             inversesumnormeddatasq = inversesumnormeddatasq + normeddata(1:nd,ip)**2}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00834}00834 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00835}00835         inversesumnormeddatasq = 1.\_rk / inversesumnormeddatasq}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00836}00836     \textcolor{keyword}{end function }\mbox{\hyperlink{namespacecrosscorr__mod_a3452d1f0726e3fecd23bd0a64dea8fcf}{getinversesumnormeddatasq}}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00837}00837 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00838}00838 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00839}00839 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00859}\mbox{\hyperlink{namespacecrosscorr__mod_a36453308c3f1ee9778c993c233346ce2}{00859}}     \textcolor{keywordtype}{pure} \textcolor{keyword}{subroutine }\mbox{\hyperlink{namespacecrosscorr__mod_a36453308c3f1ee9778c993c233346ce2}{getautocorrdirect}}(nd, np, NormedData, nlag, Lag, AutoCorr, InverseSumNormedDataSq)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00860}00860 \textcolor{preprocessor}{\#if INTEL\_COMPILER\_ENABLED \&\& defined DLL\_ENABLED \&\& (OS\_IS\_WINDOWS || defined OS\_IS\_DARWIN)}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00861}00861 \textcolor{preprocessor}{}        \textcolor{comment}{!DEC\$ ATTRIBUTES DLLEXPORT :: getAutoCorrDirect}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00862}00862 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00863}00863 \textcolor{preprocessor}{}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00864}00864         \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceconstants__mod}{constants\_mod}}, \textcolor{keywordtype}{only}: ik, rk}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00865}00865         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00866}00866         \textcolor{keywordtype}{integer(IK)}, \textcolor{keywordtype}{intent(in)}             :: nd,np,nlag,lag(nlag)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00867}00867 \textcolor{keywordtype}{        real}(rk)   , \textcolor{keywordtype}{intent(in)}             :: normeddata(nd,np)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00868}00868 \textcolor{keywordtype}{        real}(rk)   , \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional}   :: inversesumnormeddatasq(nd)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00869}00869 \textcolor{keywordtype}{        real}(rk)   , \textcolor{keywordtype}{intent(out)}            :: autocorr(nd,nlag)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00870}00870 \textcolor{keywordtype}{        real}(rk)                            :: inversesumnormeddatasqdefault(nd)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00871}00871         \textcolor{keywordtype}{integer(IK)}                         :: ip, ilag}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00872}00872 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00873}00873         \textcolor{keywordflow}{if} (any(lag>np-\/1\_ik)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00874}00874             autocorr    = -\/huge(1.\_rk)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00875}00875             \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00876}00876 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00877}00877 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00878}00878         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(inversesumnormeddatasq)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00879}00879             inversesumnormeddatasqdefault = inversesumnormeddatasq}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00880}00880         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00881}00881             inversesumnormeddatasqdefault = \mbox{\hyperlink{namespacecrosscorr__mod_a3452d1f0726e3fecd23bd0a64dea8fcf}{getinversesumnormeddatasq}}(nd, np, normeddata)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00882}00882 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00883}00883 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00884}00884         \textcolor{comment}{! Now compute the non-\/normalized covariances}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00885}00885 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00886}00886         \textcolor{keywordflow}{do} ilag = 1, nlag}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00887}00887             \textcolor{keywordflow}{if} (lag(ilag)==0\_ik) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00888}00888                 autocorr(1:nd,ilag) = 1.\_rk}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00889}00889             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00890}00890                 autocorr(1:nd,ilag) = 0.\_rk}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00891}00891                 \textcolor{keywordflow}{do} ip = 1, np-\/lag(ilag)}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00892}00892                     autocorr(1:nd,ilag) = autocorr(1:nd,ilag) + normeddata(1:nd,ip) * normeddata(1:nd,ip+lag(ilag))}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00893}00893 \textcolor{keywordflow}{                end do}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00894}00894                 autocorr(1:nd,ilag) = autocorr(1:nd,ilag) * inversesumnormeddatasqdefault}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00895}00895 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00896}00896 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00897}00897 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00898}00898     \textcolor{keyword}{end subroutine }\mbox{\hyperlink{namespacecrosscorr__mod_a36453308c3f1ee9778c993c233346ce2}{getautocorrdirect}}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00899}00899 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00900}00900 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00901}00901 }
\DoxyCodeLine{\Hypertarget{CrossCorr__mod_8f90_source_l00902}00902 \textcolor{keyword}{end module }CrossCorr\_mod}

\end{DoxyCode}
