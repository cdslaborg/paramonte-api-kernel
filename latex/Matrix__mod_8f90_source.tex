\hypertarget{Matrix__mod_8f90_source}{}\doxysection{Matrix\+\_\+mod.\+f90}
\label{Matrix__mod_8f90_source}\index{D:/Dropbox/Projects/20180101\_ParaMonte/git/src/kernel/Matrix\_mod.f90@{D:/Dropbox/Projects/20180101\_ParaMonte/git/src/kernel/Matrix\_mod.f90}}
\mbox{\hyperlink{Matrix__mod_8f90}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00001}00001 \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00002}00002 \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00003}00003 \textcolor{comment}{!!!!}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00004}00004 \textcolor{comment}{!!!!   MIT License}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00005}00005 \textcolor{comment}{!!!!}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00006}00006 \textcolor{comment}{!!!!   ParaMonte: plain powerful parallel Monte Carlo library.}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00007}00007 \textcolor{comment}{!!!!}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00008}00008 \textcolor{comment}{!!!!   Copyright (C) 2012-\/present, The Computational Data Science Lab}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00009}00009 \textcolor{comment}{!!!!}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00010}00010 \textcolor{comment}{!!!!   This file is part of the ParaMonte library.}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00011}00011 \textcolor{comment}{!!!!}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00012}00012 \textcolor{comment}{!!!!   Permission is hereby granted, free of charge, to any person obtaining a}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00013}00013 \textcolor{comment}{!!!!   copy of this software and associated documentation files (the "{}Software"{}),}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00014}00014 \textcolor{comment}{!!!!   to deal in the Software without restriction, including without limitation}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00015}00015 \textcolor{comment}{!!!!   the rights to use, copy, modify, merge, publish, distribute, sublicense,}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00016}00016 \textcolor{comment}{!!!!   and/or sell copies of the Software, and to permit persons to whom the}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00017}00017 \textcolor{comment}{!!!!   Software is furnished to do so, subject to the following conditions:}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00018}00018 \textcolor{comment}{!!!!}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00019}00019 \textcolor{comment}{!!!!   The above copyright notice and this permission notice shall be}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00020}00020 \textcolor{comment}{!!!!   included in all copies or substantial portions of the Software.}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00021}00021 \textcolor{comment}{!!!!}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00022}00022 \textcolor{comment}{!!!!   THE SOFTWARE IS PROVIDED "{}AS IS"{}, WITHOUT WARRANTY OF ANY KIND,}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00023}00023 \textcolor{comment}{!!!!   EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00024}00024 \textcolor{comment}{!!!!   MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00025}00025 \textcolor{comment}{!!!!   IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00026}00026 \textcolor{comment}{!!!!   DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00027}00027 \textcolor{comment}{!!!!   OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00028}00028 \textcolor{comment}{!!!!   OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00029}00029 \textcolor{comment}{!!!!}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00030}00030 \textcolor{comment}{!!!!   ACKNOWLEDGMENT}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00031}00031 \textcolor{comment}{!!!!}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00032}00032 \textcolor{comment}{!!!!   ParaMonte is an honor-\/ware and its currency is acknowledgment and citations.}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00033}00033 \textcolor{comment}{!!!!   As per the ParaMonte library license agreement terms, if you use any parts of}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00034}00034 \textcolor{comment}{!!!!   this library for any purposes, kindly acknowledge the use of ParaMonte in your}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00035}00035 \textcolor{comment}{!!!!   work (education/research/industry/development/...) by citing the ParaMonte}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00036}00036 \textcolor{comment}{!!!!   library as described on this page:}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00037}00037 \textcolor{comment}{!!!!}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00038}00038 \textcolor{comment}{!!!!       https://github.com/cdslaborg/paramonte/blob/main/ACKNOWLEDGMENT.md}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00039}00039 \textcolor{comment}{!!!!}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00040}00040 \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00041}00041 \textcolor{comment}{!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00042}00042 }
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00045}00045 }
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00046}\mbox{\hyperlink{namespacematrix__mod}{00046}} \textcolor{keyword}{module} \mbox{\hyperlink{namespacematrix__mod}{matrix\_mod}}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00047}00047 }
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00048}00048     \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00049}00049 }
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00050}\mbox{\hyperlink{namespacematrix__mod_a88f13a51a9eadeda90dcade7949a6b8b}{00050}}     \textcolor{keywordtype}{character(*)}, \textcolor{keywordtype}{parameter} :: \mbox{\hyperlink{namespacematrix__mod_a88f13a51a9eadeda90dcade7949a6b8b}{module\_name}} = \textcolor{stringliteral}{"{}@Matrix\_mod"{}}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00051}00051 }
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00052}00052 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00053}00053 }
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00054}00054 \textcolor{keyword}{contains}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00055}00055 }
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00056}00056 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00057}00057 }
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00067}\mbox{\hyperlink{namespacematrix__mod_a4c64c8131a142c7d91e6490c407a5d7a}{00067}}     \textcolor{keywordtype}{pure} \textcolor{keyword}{function }\mbox{\hyperlink{namespacematrix__mod_a4c64c8131a142c7d91e6490c407a5d7a}{geteye}}(n,m,diag) \textcolor{keyword}{result}(eye)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00068}00068 \textcolor{preprocessor}{\#if INTEL\_COMPILER\_ENABLED \&\& defined DLL\_ENABLED \&\& (OS\_IS\_WINDOWS || defined OS\_IS\_DARWIN)}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00069}00069 \textcolor{preprocessor}{}        \textcolor{comment}{!DEC\$ ATTRIBUTES DLLEXPORT :: getEye}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00070}00070 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00071}00071 \textcolor{preprocessor}{}        \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceconstants__mod}{constants\_mod}}, \textcolor{keywordtype}{only}: rk, ik}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00072}00072         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00073}00073         \textcolor{keywordtype}{integer(IK)}, \textcolor{keywordtype}{intent(in)}             :: n, m}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00074}00074 \textcolor{keywordtype}{        real}(rk)   , \textcolor{keywordtype}{intent(in)}, \textcolor{keywordtype}{optional}   :: diag}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00075}00075 \textcolor{keywordtype}{        real}(rk)                            :: eye(n,m)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00076}00076 \textcolor{keywordtype}{        real}(rk)                            :: diagonal}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00077}00077         \textcolor{keywordtype}{integer(IK)}                         :: i, j}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00078}00078         diagonal = 1.\_rk}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00079}00079         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(diag)) diagonal = diag}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00080}00080         \textcolor{keywordflow}{do} concurrent(i=1:n, j=1:m)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00081}00081             \textcolor{keywordflow}{if} (i==j) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00082}00082                 eye(i,j) = diagonal}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00083}00083             \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00084}00084                 eye(i,j) = 0.\_rk}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00085}00085 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00086}00086 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00087}00087     \textcolor{keyword}{end function }\mbox{\hyperlink{namespacematrix__mod_a4c64c8131a142c7d91e6490c407a5d7a}{geteye}}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00088}00088 }
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00089}00089 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00090}00090 }
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00107}\mbox{\hyperlink{namespacematrix__mod_a36785a7834c11cfd985f34441c06af66}{00107}}     \textcolor{keywordtype}{pure} \textcolor{keyword}{subroutine }\mbox{\hyperlink{namespacematrix__mod_a36785a7834c11cfd985f34441c06af66}{getcholeskyfactor}}(nd,PosDefMat,Diagonal)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00108}00108 \textcolor{preprocessor}{\#if INTEL\_COMPILER\_ENABLED \&\& defined DLL\_ENABLED \&\& (OS\_IS\_WINDOWS || defined OS\_IS\_DARWIN)}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00109}00109 \textcolor{preprocessor}{}        \textcolor{comment}{!DEC\$ ATTRIBUTES DLLEXPORT :: getCholeskyFactor}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00110}00110 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00111}00111 \textcolor{preprocessor}{}        \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceconstants__mod}{constants\_mod}}, \textcolor{keywordtype}{only}: rk, ik}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00112}00112         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00113}00113         \textcolor{keywordtype}{integer(IK)}, \textcolor{keywordtype}{intent(in)}    :: nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00114}00114 \textcolor{keywordtype}{        real}(rk)   , \textcolor{keywordtype}{intent(inout)} :: posdefmat(nd,nd) \textcolor{comment}{! Upper triangle + diagonal is input matrix, lower is output.}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00115}00115 \textcolor{keywordtype}{        real}(rk)   , \textcolor{keywordtype}{intent(out)}   :: diagonal(nd)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00116}00116 \textcolor{keywordtype}{        real}(rk)                   :: summ}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00117}00117         \textcolor{keywordtype}{integer(IK)}                :: i}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00118}00118         \textcolor{keywordflow}{do} i=1,nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00119}00119             summ = posdefmat(i,i) -\/ dot\_product(posdefmat(i,1:i-\/1),posdefmat(i,1:i-\/1))}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00120}00120             \textcolor{keywordflow}{if} (summ <= 0.\_rk) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00121}00121                 diagonal(1) = -\/1.\_rk}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00122}00122                 \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00123}00123 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00124}00124             diagonal(i) = sqrt(summ)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00125}00125             posdefmat(i+1:nd,i) = ( posdefmat(i,i+1:nd) -\/ matmul(posdefmat(i+1:nd,1:i-\/1),posdefmat(i,1:i-\/1)) ) / diagonal(i)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00126}00126 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00127}00127     \textcolor{keyword}{end subroutine }\mbox{\hyperlink{namespacematrix__mod_a36785a7834c11cfd985f34441c06af66}{getcholeskyfactor}}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00128}00128 }
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00129}00129 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00130}00130 }
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00143}\mbox{\hyperlink{namespacematrix__mod_a393c400caa093b0ac68a0ff1cb0fd897}{00143}}     \textcolor{keyword}{subroutine }\mbox{\hyperlink{namespacematrix__mod_a393c400caa093b0ac68a0ff1cb0fd897}{solvelinearposdefsystem}}(nd,PosDefMat,Diagonal,Intercept,InputSolution)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00144}00144 \textcolor{preprocessor}{\#if INTEL\_COMPILER\_ENABLED \&\& defined DLL\_ENABLED \&\& (OS\_IS\_WINDOWS || defined OS\_IS\_DARWIN)}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00145}00145 \textcolor{preprocessor}{}        \textcolor{comment}{!DEC\$ ATTRIBUTES DLLEXPORT :: solveLinearPosDefSystem}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00146}00146 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00147}00147 \textcolor{preprocessor}{}        \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceconstants__mod}{constants\_mod}}, \textcolor{keywordtype}{only}: rk, ik}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00148}00148         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00149}00149         \textcolor{keywordtype}{integer(IK)}, \textcolor{keywordtype}{intent(in)}    :: nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00150}00150 \textcolor{keywordtype}{        real}(RK)   , \textcolor{keywordtype}{intent(in)}    :: PosDefMat(nd,nd),Diagonal(nd),Intercept(nd)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00151}00151 \textcolor{keywordtype}{        real}(RK)   , \textcolor{keywordtype}{intent(inout)} :: InputSolution(nd)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00152}00152         \textcolor{keywordtype}{integer(IK)}                :: i}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00153}00153         \textcolor{keywordflow}{do} i=1,nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00154}00154             inputsolution(i) = ( intercept(i) -\/ dot\_product(posdefmat(i,1:i-\/1),inputsolution(1:i-\/1)) ) / diagonal(i)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00155}00155 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00156}00156         \textcolor{keywordflow}{do} i = nd,1,-\/1}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00157}00157             inputsolution(i) = ( inputsolution(i) -\/ dot\_product(posdefmat(i+1:nd,i),inputsolution(i+1:nd)) ) / diagonal(i)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00158}00158 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00159}00159     \textcolor{keyword}{end subroutine }\mbox{\hyperlink{namespacematrix__mod_a393c400caa093b0ac68a0ff1cb0fd897}{solvelinearposdefsystem}}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00160}00160 }
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00161}00161 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00162}00162 }
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00182}\mbox{\hyperlink{namespacematrix__mod_a390563b2761c2e0cca18a38562bacf1c}{00182}}     \textcolor{keywordtype}{pure} \textcolor{keyword}{subroutine }\mbox{\hyperlink{namespacematrix__mod_a390563b2761c2e0cca18a38562bacf1c}{getinvposdefmatsqrtdet}}(nd,MatInvMat,sqrtDetInvPosDefMat)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00183}00183 \textcolor{preprocessor}{\#if INTEL\_COMPILER\_ENABLED \&\& defined DLL\_ENABLED \&\& (OS\_IS\_WINDOWS || defined OS\_IS\_DARWIN)}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00184}00184 \textcolor{preprocessor}{}        \textcolor{comment}{!DEC\$ ATTRIBUTES DLLEXPORT :: getInvPosDefMatSqrtDet}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00185}00185 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00186}00186 \textcolor{preprocessor}{}        \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceconstants__mod}{constants\_mod}}, \textcolor{keywordtype}{only}: rk, ik \textcolor{comment}{! LCOV\_EXCL\_LINE}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00187}00187         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00188}00188         \textcolor{keywordtype}{integer(IK)}, \textcolor{keywordtype}{intent(in)}    :: nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00189}00189 \textcolor{keywordtype}{        real}(rk)   , \textcolor{keywordtype}{intent(inout)} :: matinvmat(nd,nd)           \textcolor{comment}{! input: upper half is covariance matrix, output: inverse matrix}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00190}00190 \textcolor{keywordtype}{        real}(rk)   , \textcolor{keywordtype}{intent(out)}   :: sqrtdetinvposdefmat        \textcolor{comment}{!}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00191}00191 \textcolor{keywordtype}{        real}(rk)                   :: choleskylower(nd,nd)       \textcolor{comment}{! Cholesky factor}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00192}00192 \textcolor{keywordtype}{        real}(rk)                   :: diagonal(nd)               \textcolor{comment}{! diagonal terms of the inverse matrix}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00193}00193 \textcolor{keywordtype}{        real}(rk)                   :: summ}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00194}00194         \textcolor{keywordtype}{integer(IK)}                :: i,j,k}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00195}00195         \textcolor{keywordflow}{if} (nd==1\_ik) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00196}00196             matinvmat(1,1) = 1.\_rk / matinvmat(1,1)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00197}00197             sqrtdetinvposdefmat = matinvmat(1,1)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00198}00198             \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00199}00199 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00200}00200         \textcolor{keywordflow}{do} j=1,nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00201}00201             \textcolor{keywordflow}{do} i=1,j}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00202}00202                 choleskylower(i,j) = matinvmat(i,j)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00203}00203 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00204}00204 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00205}00205         \textcolor{keyword}{call }\mbox{\hyperlink{namespacematrix__mod_a36785a7834c11cfd985f34441c06af66}{getcholeskyfactor}}(nd,choleskylower,diagonal)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00206}00206         \textcolor{keywordflow}{if} (diagonal(1)<0.\_rk) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00207}00207             sqrtdetinvposdefmat = -\/1.\_rk}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00208}00208             \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00209}00209 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00210}00210         sqrtdetinvposdefmat = 1.\_rk / product(diagonal)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00211}00211         \textcolor{keywordflow}{do} i = 1,nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00212}00212             choleskylower(i,i) = 1.\_rk / diagonal(i)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00213}00213             \textcolor{keywordflow}{do} j = i+1,nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00214}00214                 summ = 0.\_rk}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00215}00215                 \textcolor{keywordflow}{do} k = i,j-\/1}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00216}00216                     summ = summ -\/ choleskylower(j,k) * choleskylower(k,i)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00217}00217 \textcolor{keywordflow}{                end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00218}00218                 choleskylower(j,i) = summ / diagonal(j)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00219}00219 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00220}00220 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00221}00221         \textcolor{keywordflow}{do} i = 1,nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00222}00222             \textcolor{keywordflow}{do} j = i,nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00223}00223                 matinvmat(j,i) = dot\_product(choleskylower(j:nd,j),choleskylower(j:nd,i))}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00224}00224 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00225}00225             matinvmat(i,i:nd) = matinvmat(i:nd,i)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00226}00226 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00227}00227   \textcolor{keyword}{end subroutine }\mbox{\hyperlink{namespacematrix__mod_a390563b2761c2e0cca18a38562bacf1c}{getinvposdefmatsqrtdet}}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00228}00228 }
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00229}00229 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00230}00230 }
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00247}\mbox{\hyperlink{namespacematrix__mod_a1281fcb5ff0398b841570144bf8765fd}{00247}}     \textcolor{keywordtype}{pure} \textcolor{keyword}{function }\mbox{\hyperlink{namespacematrix__mod_a1281fcb5ff0398b841570144bf8765fd}{getinvmatfromcholfac}}(nd,CholeskyLower,CholeskyDiago) \textcolor{keyword}{result}(InvMatFromCholFac)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00248}00248 \textcolor{preprocessor}{\#if INTEL\_COMPILER\_ENABLED \&\& defined DLL\_ENABLED \&\& (OS\_IS\_WINDOWS || defined OS\_IS\_DARWIN)}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00249}00249 \textcolor{preprocessor}{}        \textcolor{comment}{!DEC\$ ATTRIBUTES DLLEXPORT :: getInvMatFromCholFac}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00250}00250 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00251}00251 \textcolor{preprocessor}{}        \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceconstants__mod}{constants\_mod}}, \textcolor{keywordtype}{only}: rk, ik}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00252}00252         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00253}00253         \textcolor{keywordtype}{integer(IK)}, \textcolor{keywordtype}{intent(in)} :: nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00254}00254 \textcolor{keywordtype}{        real}(rk)   , \textcolor{keywordtype}{intent(in)} :: choleskydiago(nd)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00255}00255 \textcolor{keywordtype}{        real}(rk)   , \textcolor{keywordtype}{intent(in)} :: choleskylower(nd,nd)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00256}00256 \textcolor{keywordtype}{        real}(rk)                :: invmatfromcholfac(nd,nd)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00257}00257 \textcolor{keywordtype}{        real}(rk)                :: summ}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00258}00258         \textcolor{keywordtype}{integer(IK)}             :: i,j,k}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00259}00259         \textcolor{keywordflow}{if} (nd==1\_ik) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00260}00260             invmatfromcholfac(1,1) = 1.\_rk / choleskydiago(1)**2}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00261}00261             \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00262}00262 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00263}00263         invmatfromcholfac = 0.\_rk}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00264}00264         \textcolor{keywordflow}{do} j=1,nd-\/1}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00265}00265             \textcolor{keywordflow}{do} i=j+1,nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00266}00266                 invmatfromcholfac(i,j) = choleskylower(i,j)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00267}00267 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00268}00268 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00269}00269         \textcolor{keywordflow}{do} i = 1,nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00270}00270             invmatfromcholfac(i,i) = 1.\_rk / choleskydiago(i)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00271}00271             \textcolor{keywordflow}{do} j = i+1,nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00272}00272                 summ = 0.\_rk}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00273}00273                 \textcolor{keywordflow}{do} k = i,j-\/1}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00274}00274                     summ = summ -\/ invmatfromcholfac(j,k) * invmatfromcholfac(k,i)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00275}00275 \textcolor{keywordflow}{                end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00276}00276                 invmatfromcholfac(j,i) = summ / choleskydiago(j)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00277}00277 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00278}00278 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00279}00279         \textcolor{keywordflow}{do} i = 1,nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00280}00280             \textcolor{keywordflow}{do} j = i,nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00281}00281                 invmatfromcholfac(j,i) = dot\_product(invmatfromcholfac(j:nd,j),invmatfromcholfac(j:nd,i))}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00282}00282                 invmatfromcholfac(i,j) = invmatfromcholfac(j,i)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00283}00283 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00284}00284             \textcolor{comment}{!InvMatFromCholFac(i,i:nd) = InvMatFromCholFac(i:nd,i)}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00285}00285 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00286}00286     \textcolor{keyword}{end function }\mbox{\hyperlink{namespacematrix__mod_a1281fcb5ff0398b841570144bf8765fd}{getinvmatfromcholfac}}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00287}00287 }
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00288}00288 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00289}00289 }
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00317}\mbox{\hyperlink{namespacematrix__mod_a541fac75a210dc71c90db6a780a7b43f}{00317}}     \textcolor{keywordtype}{pure} \textcolor{keyword}{function }\mbox{\hyperlink{namespacematrix__mod_a541fac75a210dc71c90db6a780a7b43f}{getinvposdefmat}}(nd,PosDefMat) \textcolor{keyword}{result}(InvPosDefMat)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00318}00318 \textcolor{preprocessor}{\#if INTEL\_COMPILER\_ENABLED \&\& defined DLL\_ENABLED \&\& (OS\_IS\_WINDOWS || defined OS\_IS\_DARWIN)}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00319}00319 \textcolor{preprocessor}{}        \textcolor{comment}{!DEC\$ ATTRIBUTES DLLEXPORT :: getInvPosDefMat}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00320}00320 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00321}00321 \textcolor{preprocessor}{}        \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceconstants__mod}{constants\_mod}}, \textcolor{keywordtype}{only}: rk, ik}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00322}00322         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00323}00323         \textcolor{keywordtype}{integer(IK)}, \textcolor{keywordtype}{intent(in)} :: nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00324}00324 \textcolor{keywordtype}{        real}(rk)   , \textcolor{keywordtype}{intent(in)} :: posdefmat(nd,nd)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00325}00325 \textcolor{keywordtype}{        real}(rk)                :: invposdefmat(nd,nd)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00326}00326 \textcolor{keywordtype}{        real}(rk)                :: choleskylower(nd,nd)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00327}00327 \textcolor{keywordtype}{        real}(rk)                :: choleskydiago(nd)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00328}00328 \textcolor{keywordtype}{        real}(rk)                :: summ}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00329}00329         \textcolor{keywordtype}{integer(IK)}             :: i,j,k}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00330}00330        \textcolor{comment}{!if (nd==1) then}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00331}00331        \textcolor{comment}{!    InvPosDefMat(1,1) = 1.\_RK / sqrt(PosDefMat(1,1))}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00332}00332        \textcolor{comment}{!    return}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00333}00333        \textcolor{comment}{!end if}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00334}00334         \textcolor{keywordflow}{do} j=1,nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00335}00335             \textcolor{keywordflow}{do} i=1,j}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00336}00336                 choleskylower(i,j) = posdefmat(i,j)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00337}00337 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00338}00338 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00339}00339         \textcolor{keyword}{call }\mbox{\hyperlink{namespacematrix__mod_a36785a7834c11cfd985f34441c06af66}{getcholeskyfactor}}(nd,choleskylower,choleskydiago)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00340}00340         \textcolor{keywordflow}{if} (choleskydiago(1)<0.\_rk) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00341}00341             invposdefmat = -\/1.\_rk   \textcolor{comment}{! error occurred: getCholeskyFactor() failed in getInvPosDefMat()}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00342}00342             \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00343}00343 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00344}00344         \textcolor{keywordflow}{do} i = 1,nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00345}00345             choleskylower(i,i) = 1.\_rk / choleskydiago(i)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00346}00346             \textcolor{keywordflow}{do} j = i+1,nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00347}00347                 summ = 0.\_rk}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00348}00348                 \textcolor{keywordflow}{do} k = i,j-\/1}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00349}00349                     summ = summ -\/ choleskylower(j,k) * choleskylower(k,i)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00350}00350 \textcolor{keywordflow}{                end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00351}00351                 choleskylower(j,i) = summ / choleskydiago(j)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00352}00352 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00353}00353 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00354}00354         \textcolor{keywordflow}{do} i = 1,nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00355}00355             \textcolor{keywordflow}{do} j = i,nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00356}00356                 invposdefmat(j,i) = dot\_product(choleskylower(j:nd,j),choleskylower(j:nd,i))}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00357}00357                 invposdefmat(i,j) = invposdefmat(j,i)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00358}00358 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00359}00359 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00360}00360   \textcolor{keyword}{end function }\mbox{\hyperlink{namespacematrix__mod_a541fac75a210dc71c90db6a780a7b43f}{getinvposdefmat}}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00361}00361 }
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00362}00362 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00363}00363 }
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00383}\mbox{\hyperlink{namespacematrix__mod_a1921f30635922255128477323ca5ce09}{00383}}     \textcolor{keyword}{subroutine }\mbox{\hyperlink{namespacematrix__mod_a1921f30635922255128477323ca5ce09}{getinvmatdet}}(nd,MatrixLU,InverseMatrix,detInvMat)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00384}00384 \textcolor{preprocessor}{\#if INTEL\_COMPILER\_ENABLED \&\& defined DLL\_ENABLED \&\& (OS\_IS\_WINDOWS || defined OS\_IS\_DARWIN)}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00385}00385 \textcolor{preprocessor}{}        \textcolor{comment}{!DEC\$ ATTRIBUTES DLLEXPORT :: getInvMatDet}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00386}00386 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00387}00387 \textcolor{preprocessor}{}        \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceconstants__mod}{constants\_mod}}, \textcolor{keywordtype}{only}: rk, ik}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00388}00388         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00389}00389         \textcolor{keywordtype}{integer(IK)}, \textcolor{keywordtype}{intent(in)}    :: nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00390}00390 \textcolor{keywordtype}{        real}(RK)   , \textcolor{keywordtype}{intent(inout)} :: MatrixLU(nd,nd) \textcolor{comment}{! On input it is the matrix, on output it is the LU decomposition.}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00391}00391 \textcolor{keywordtype}{        real}(RK)   , \textcolor{keywordtype}{intent(out)}   :: InverseMatrix(nd,nd)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00392}00392 \textcolor{keywordtype}{        real}(RK)   , \textcolor{keywordtype}{intent(out)}   :: detInvMat}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00393}00393         \textcolor{keywordtype}{integer(IK)}                :: i,j,Permutation(nd) \textcolor{comment}{! LCOV\_EXCL\_LINE}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00394}00394         \textcolor{keywordflow}{do} i = 1,nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00395}00395             \textcolor{keywordflow}{do} j = 1,nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00396}00396                 inversematrix(i,j) = 0.\_rk}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00397}00397 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00398}00398             inversematrix(i,i) = 1.\_rk}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00399}00399 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00400}00400         \textcolor{keyword}{call }\mbox{\hyperlink{namespacematrix__mod_af380500b6eb16435797ee030edfd563a}{getlu}}(nd,matrixlu,permutation,detinvmat)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00401}00401         \textcolor{keywordflow}{do} j = 1,nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00402}00402             detinvmat = detinvmat * matrixlu(j,j)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00403}00403             \textcolor{keyword}{call }\mbox{\hyperlink{namespacematrix__mod_a54dd076c547a8b6e1f81b3244887e874}{solvelinearsystem}}(nd,matrixlu,permutation,inversematrix(1:nd,j))}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00404}00404 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00405}00405         detinvmat = 1.\_rk/detinvmat}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00406}00406   \textcolor{keyword}{end subroutine }\mbox{\hyperlink{namespacematrix__mod_a1921f30635922255128477323ca5ce09}{getinvmatdet}}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00407}00407 }
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00408}00408 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00409}00409 }
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00427}\mbox{\hyperlink{namespacematrix__mod_a1d61a8419f2d94806039bb0d08a47a9e}{00427}}     \textcolor{keyword}{function }\mbox{\hyperlink{namespacematrix__mod_a1d61a8419f2d94806039bb0d08a47a9e}{getinvmat}}(nd,Matrix) \textcolor{keyword}{result}(InverseMatrix)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00428}00428 \textcolor{preprocessor}{\#if INTEL\_COMPILER\_ENABLED \&\& defined DLL\_ENABLED \&\& (OS\_IS\_WINDOWS || defined OS\_IS\_DARWIN)}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00429}00429 \textcolor{preprocessor}{}        \textcolor{comment}{!DEC\$ ATTRIBUTES DLLEXPORT :: getInvMat}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00430}00430 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00431}00431 \textcolor{preprocessor}{}        \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceconstants__mod}{constants\_mod}}, \textcolor{keywordtype}{only}: rk, ik}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00432}00432         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00433}00433         \textcolor{keywordtype}{integer(IK)}, \textcolor{keywordtype}{intent(in)} :: nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00434}00434 \textcolor{keywordtype}{        real}(rk)   , \textcolor{keywordtype}{intent(in)} :: matrix(nd,nd)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00435}00435 \textcolor{keywordtype}{        real}(rk)                :: inversematrix(nd,nd),lu(nd,nd)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00436}00436         \textcolor{keywordtype}{integer(IK)}             :: i,j,permutation(nd)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00437}00437 \textcolor{keywordtype}{        real}(rk)                :: parity}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00438}00438         \textcolor{keywordflow}{do} i = 1,nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00439}00439             \textcolor{keywordflow}{do} j = 1,nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00440}00440                 inversematrix(i,j) = 0.\_rk}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00441}00441 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00442}00442             inversematrix(i,i) = 1.\_rk}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00443}00443 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00444}00444         lu = matrix}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00445}00445         \textcolor{keyword}{call }\mbox{\hyperlink{namespacematrix__mod_af380500b6eb16435797ee030edfd563a}{getlu}}(nd,lu,permutation,parity)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00446}00446         \textcolor{keywordflow}{do} j = 1,nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00447}00447             \textcolor{keyword}{call }\mbox{\hyperlink{namespacematrix__mod_a54dd076c547a8b6e1f81b3244887e874}{solvelinearsystem}}(nd,lu,permutation,inversematrix(1:nd,j))}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00448}00448 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00449}00449     \textcolor{keyword}{end function }\mbox{\hyperlink{namespacematrix__mod_a1d61a8419f2d94806039bb0d08a47a9e}{getinvmat}}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00450}00450 }
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00451}00451 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00452}00452 }
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00472}\mbox{\hyperlink{namespacematrix__mod_a54dd076c547a8b6e1f81b3244887e874}{00472}}     \textcolor{keyword}{subroutine }\mbox{\hyperlink{namespacematrix__mod_a54dd076c547a8b6e1f81b3244887e874}{solvelinearsystem}}(nd, LU, Permutation, InputSolution)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00473}00473 \textcolor{preprocessor}{\#if INTEL\_COMPILER\_ENABLED \&\& defined DLL\_ENABLED \&\& (OS\_IS\_WINDOWS || defined OS\_IS\_DARWIN)}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00474}00474 \textcolor{preprocessor}{}        \textcolor{comment}{!DEC\$ ATTRIBUTES DLLEXPORT :: solveLinearSystem}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00475}00475 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00476}00476 \textcolor{preprocessor}{}        \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceconstants__mod}{constants\_mod}}, \textcolor{keywordtype}{only}: rk, ik}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00477}00477         \textcolor{keywordtype}{integer(IK)}, \textcolor{keywordtype}{intent(in)}    :: nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00478}00478         \textcolor{keywordtype}{integer(IK)}, \textcolor{keywordtype}{intent(in)}    :: Permutation(nd)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00479}00479 \textcolor{keywordtype}{        real}(RK)   , \textcolor{keywordtype}{intent(in)}    :: LU(nd,nd)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00480}00480 \textcolor{keywordtype}{        real}(RK)   , \textcolor{keywordtype}{intent(inout)} :: InputSolution(nd)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00481}00481         \textcolor{keywordtype}{integer(IK)}                :: i,ii}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00482}00482 \textcolor{keywordtype}{        real}(RK)                   :: summ}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00483}00483         ii = 0}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00484}00484         \textcolor{keywordflow}{do} i=1,nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00485}00485             summ = inputsolution(permutation(i))}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00486}00486             inputsolution(permutation(i)) = inputsolution(i)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00487}00487             \textcolor{keywordflow}{if} (ii /= 0) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00488}00488                 summ = summ -\/ dot\_product( lu(i,ii:i-\/1) , inputsolution(ii:i-\/1) )}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00489}00489             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (summ /= 0.\_rk) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00490}00490                 ii = i}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00491}00491 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00492}00492             inputsolution(i) = summ}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00493}00493 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00494}00494         \textcolor{keywordflow}{do} i = nd,1,-\/1}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00495}00495             inputsolution(i) = ( inputsolution(i) -\/ dot\_product( lu(i,i+1:nd) , inputsolution(i+1:nd)) ) / lu(i,i)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00496}00496 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00497}00497     \textcolor{keyword}{end subroutine }\mbox{\hyperlink{namespacematrix__mod_a54dd076c547a8b6e1f81b3244887e874}{solvelinearsystem}}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00498}00498 }
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00499}00499 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00500}00500 }
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00514}\mbox{\hyperlink{namespacematrix__mod_af380500b6eb16435797ee030edfd563a}{00514}}     \textcolor{keyword}{subroutine }\mbox{\hyperlink{namespacematrix__mod_af380500b6eb16435797ee030edfd563a}{getlu}}(nd,MatrixLU,Permutation,parity) \textcolor{comment}{! ,errorOccurred)}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00515}00515 \textcolor{preprocessor}{\#if INTEL\_COMPILER\_ENABLED \&\& defined DLL\_ENABLED \&\& (OS\_IS\_WINDOWS || defined OS\_IS\_DARWIN)}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00516}00516 \textcolor{preprocessor}{}        \textcolor{comment}{!DEC\$ ATTRIBUTES DLLEXPORT :: getLU}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00517}00517 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00518}00518 \textcolor{preprocessor}{}        \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceconstants__mod}{constants\_mod}}, \textcolor{keywordtype}{only}: rk, ik}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00519}00519         use, \textcolor{keywordtype}{intrinsic} :: iso\_fortran\_env, only: output\_unit}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00520}00520         \textcolor{keywordtype}{integer(IK)} , \textcolor{keywordtype}{intent(in)}    :: nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00521}00521         \textcolor{keywordtype}{integer(IK)} , \textcolor{keywordtype}{intent(out)}   :: Permutation(nd)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00522}00522 \textcolor{keywordtype}{        real}(RK)    , \textcolor{keywordtype}{intent(inout)} :: MatrixLU(nd,nd)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00523}00523 \textcolor{keywordtype}{        real}(RK)    , \textcolor{keywordtype}{intent(out)}   :: parity}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00524}00524         \textcolor{comment}{!logical     , intent(out)   :: errorOccurred}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00525}00525 \textcolor{keywordtype}{        real}(RK)    , \textcolor{keywordtype}{parameter}     :: TINY = 1.e-\/20\_rk}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00526}00526 \textcolor{keywordtype}{        real}(RK)                    :: aamax,dum,summ,vv(nd)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00527}00527         \textcolor{keywordtype}{integer(IK)}                 :: i,imax,j,k}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00528}00528         \textcolor{comment}{!errorOccurred = .false.}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00529}00529         parity = 1.\_rk}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00530}00530         \textcolor{keywordflow}{do} i = 1,nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00531}00531             aamax = 0.\_rk}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00532}00532             \textcolor{keywordflow}{do} j=1,nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00533}00533                 \textcolor{keywordflow}{if} ( abs(matrixlu(i,j)) > aamax ) aamax = abs( matrixlu(i,j) )}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00534}00534 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00535}00535             \textcolor{keywordflow}{if} (aamax == 0.\_rk) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00536}00536             \textcolor{comment}{! LCOV\_EXCL\_START}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00537}00537                 \textcolor{keyword}{write}(output\_unit,\textcolor{stringliteral}{"{}(A)"{}}) \textcolor{stringliteral}{"{}Statistics@getLU() failed. Singular matrix detected."{}}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00538}00538                 error stop}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00539}00539                 \textcolor{comment}{!errorOccurred = .true.}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00540}00540                 \textcolor{comment}{!return}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00541}00541             \textcolor{comment}{! LCOV\_EXCL\_STOP}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00542}00542 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00543}00543             vv(i) = 1.\_rk/aamax}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00544}00544 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00545}00545         \textcolor{keywordflow}{do} j=1,nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00546}00546             \textcolor{keywordflow}{do} i=1,j-\/1}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00547}00547                 summ = matrixlu(i,j)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00548}00548                 \textcolor{keywordflow}{do} k=1,i-\/1}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00549}00549                     summ = summ -\/ matrixlu(i,k) * matrixlu(k,j)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00550}00550 \textcolor{keywordflow}{                end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00551}00551                 matrixlu(i,j) = summ}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00552}00552 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00553}00553             aamax = 0.\_rk}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00554}00554             \textcolor{keywordflow}{do} i = j, nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00555}00555                 summ = matrixlu(i,j)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00556}00556                 \textcolor{keywordflow}{do} k = 1, j-\/1}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00557}00557                     summ = summ -\/ matrixlu(i,k) * matrixlu(k,j)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00558}00558 \textcolor{keywordflow}{                end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00559}00559                 matrixlu(i,j) = summ}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00560}00560                 dum = vv(i) * abs(summ)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00561}00561                 \textcolor{keywordflow}{if} (dum >= aamax) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00562}00562                     imax = i}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00563}00563                     aamax = dum}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00564}00564 \textcolor{keywordflow}{                end if}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00565}00565 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00566}00566             \textcolor{keywordflow}{if} (j /= imax)\textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00567}00567                 \textcolor{keywordflow}{do} k=1,nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00568}00568                     dum = matrixlu(imax,k)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00569}00569                     matrixlu(imax,k) = matrixlu(j,k)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00570}00570                     matrixlu(j,k) = dum}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00571}00571 \textcolor{keywordflow}{                end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00572}00572                 parity = -\/ parity}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00573}00573                 vv(imax) = vv(j)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00574}00574 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00575}00575             permutation(j) = imax}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00576}00576             \textcolor{keywordflow}{if} (matrixlu(j,j) == 0.\_rk) matrixlu(j,j) = tiny}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00577}00577             \textcolor{keywordflow}{if} (j /= nd) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00578}00578                 dum = 1.\_rk / matrixlu(j,j)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00579}00579                 \textcolor{keywordflow}{do} i = j+1,nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00580}00580                     matrixlu(i,j) = matrixlu(i,j) * dum}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00581}00581 \textcolor{keywordflow}{                end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00582}00582 \textcolor{keywordflow}{            endif}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00583}00583 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00584}00584   \textcolor{keyword}{end subroutine }\mbox{\hyperlink{namespacematrix__mod_af380500b6eb16435797ee030edfd563a}{getlu}}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00585}00585 }
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00586}00586 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00587}00587 }
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00598}\mbox{\hyperlink{namespacematrix__mod_aff8808812389fce984da322f8c2c07f0}{00598}}     \textcolor{keyword}{subroutine }\mbox{\hyperlink{namespacematrix__mod_aff8808812389fce984da322f8c2c07f0}{multiplymatrix}}(A,rowsA,colsA,B,rowsB,colsB,C)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00599}00599 \textcolor{preprocessor}{\#if INTEL\_COMPILER\_ENABLED \&\& defined DLL\_ENABLED \&\& (OS\_IS\_WINDOWS || defined OS\_IS\_DARWIN)}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00600}00600 \textcolor{preprocessor}{}        \textcolor{comment}{!DEC\$ ATTRIBUTES DLLEXPORT :: multiplyMatrix}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00601}00601 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00602}00602 \textcolor{preprocessor}{}        \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceconstants__mod}{constants\_mod}}, \textcolor{keywordtype}{only}: rk, ik}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00603}00603         use, \textcolor{keywordtype}{intrinsic} :: iso\_fortran\_env, only: output\_unit}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00604}00604         \textcolor{comment}{!use Misc  , only: abortProgram}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00605}00605         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00606}00606         \textcolor{keywordtype}{integer(IK)}, \textcolor{keywordtype}{intent(in)}  :: rowsA, colsA, rowsB, colsB \textcolor{comment}{!Matrix Dimensions}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00607}00607 \textcolor{keywordtype}{        real}(RK)   , \textcolor{keywordtype}{intent(in)}  :: A(rowsA,colsA)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00608}00608 \textcolor{keywordtype}{        real}(RK)   , \textcolor{keywordtype}{intent(in)}  :: B(rowsB,colsB)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00609}00609 \textcolor{keywordtype}{        real}(RK)   , \textcolor{keywordtype}{intent(out)} :: C(rowsA,colsB)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00610}00610         \textcolor{keywordtype}{integer(IK)}              :: i,j,k,rowsC,colsC \textcolor{comment}{!Counters}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00611}00611         \textcolor{keywordflow}{if} (colsa == rowsb) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00612}00612             rowsc = rowsa}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00613}00613             colsc = colsb}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00614}00614         \textcolor{comment}{! LCOV\_EXCL\_START}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00615}00615         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00616}00616             \textcolor{keyword}{write}(output\_unit,\textcolor{stringliteral}{"{}(A)"{}}) \textcolor{stringliteral}{"{}Matrix@multiplyMatrix() failed. dimensions of matrices do not match."{}}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00617}00617             stop}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00618}00618             \textcolor{comment}{!call abortProgram( output\_unit , 1 , 1 , 'Statistics@multiplyMatrix() failed. dimensions of matrices do not match.' )}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00619}00619         \textcolor{comment}{! LCOV\_EXCL\_STOP}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00620}00620 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00621}00621         \textcolor{comment}{! Initialize product matrix to 0}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00622}00622         \textcolor{keywordflow}{do} i = 1, rowsc}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00623}00623             \textcolor{keywordflow}{do} j = 1, colsc}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00624}00624                 c(i,j) = 0.\_rk}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00625}00625 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00626}00626 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00627}00627         \textcolor{comment}{! Find product as per above formula}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00628}00628         \textcolor{keywordflow}{do} i = 1, rowsa}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00629}00629             \textcolor{keywordflow}{do} j = 1, colsb}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00630}00630                 \textcolor{keywordflow}{do} k = 1, colsa}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00631}00631                     c(i,j) = c(i,j) + a(i,k)*b(k,j)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00632}00632 \textcolor{keywordflow}{                end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00633}00633 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00634}00634 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00635}00635     \textcolor{keyword}{end subroutine }\mbox{\hyperlink{namespacematrix__mod_aff8808812389fce984da322f8c2c07f0}{multiplymatrix}}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00636}00636 }
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00637}00637 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00638}00638 }
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00650}\mbox{\hyperlink{namespacematrix__mod_a99644ca2cc3b30be2f7363418803b020}{00650}}     \textcolor{keyword}{function }\mbox{\hyperlink{namespacematrix__mod_a99644ca2cc3b30be2f7363418803b020}{getdeterminant}}(nd,Matrix) \textcolor{keyword}{result}(determinant)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00651}00651 \textcolor{preprocessor}{\#if INTEL\_COMPILER\_ENABLED \&\& defined DLL\_ENABLED \&\& (OS\_IS\_WINDOWS || defined OS\_IS\_DARWIN)}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00652}00652 \textcolor{preprocessor}{}        \textcolor{comment}{!DEC\$ ATTRIBUTES DLLEXPORT :: getDeterminant}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00653}00653 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00654}00654 \textcolor{preprocessor}{}        \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceconstants__mod}{constants\_mod}}, \textcolor{keywordtype}{only}: rk, ik}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00655}00655         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00656}00656         \textcolor{keywordtype}{integer(IK)}, \textcolor{keywordtype}{intent(in)} :: nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00657}00657 \textcolor{keywordtype}{        real}(rk)   , \textcolor{keywordtype}{intent(in)} :: matrix(nd,nd)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00658}00658 \textcolor{keywordtype}{        real}(rk)                :: dummymat(nd,nd)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00659}00659 \textcolor{keywordtype}{        real}(rk)                :: determinant}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00660}00660         \textcolor{keywordtype}{integer(IK)}             :: permutation(nd)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00661}00661         \textcolor{keywordtype}{integer(IK)}             :: j}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00662}00662         dummymat = matrix}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00663}00663         \textcolor{keyword}{call }\mbox{\hyperlink{namespacematrix__mod_af380500b6eb16435797ee030edfd563a}{getlu}}(nd,dummymat,permutation,determinant) \textcolor{comment}{! This returns determinant as +-\/1.}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00664}00664         \textcolor{keywordflow}{do} j=1,nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00665}00665             determinant = determinant * dummymat(j,j)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00666}00666 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00667}00667     \textcolor{keyword}{end function }\mbox{\hyperlink{namespacematrix__mod_a99644ca2cc3b30be2f7363418803b020}{getdeterminant}}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00668}00668 }
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00669}00669 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00670}00670 }
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00684}\mbox{\hyperlink{namespacematrix__mod_a869c72bec5850343289680a09254d847}{00684}}     \textcolor{keyword}{function }\mbox{\hyperlink{namespacematrix__mod_a869c72bec5850343289680a09254d847}{getsqrtdetposdefmat}}(nd,PosDefMat) \textcolor{keyword}{result}(sqrtDetPosDefMat)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00685}00685 \textcolor{preprocessor}{\#if INTEL\_COMPILER\_ENABLED \&\& defined DLL\_ENABLED \&\& (OS\_IS\_WINDOWS || defined OS\_IS\_DARWIN)}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00686}00686 \textcolor{preprocessor}{}        \textcolor{comment}{!DEC\$ ATTRIBUTES DLLEXPORT :: getSqrtDetPosDefMat}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00687}00687 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00688}00688 \textcolor{preprocessor}{}        \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceconstants__mod}{constants\_mod}}, \textcolor{keywordtype}{only}: rk, ik}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00689}00689         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00690}00690         \textcolor{keywordtype}{integer(IK)}, \textcolor{keywordtype}{intent(in)} :: nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00691}00691 \textcolor{keywordtype}{        real}(rk)   , \textcolor{keywordtype}{intent(in)} :: posdefmat(nd,nd)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00692}00692 \textcolor{keywordtype}{        real}(rk)                :: choleskylower(nd,nd)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00693}00693 \textcolor{keywordtype}{        real}(rk)                :: choleskydiago(nd)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00694}00694 \textcolor{keywordtype}{        real}(rk)                :: sqrtdetposdefmat}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00695}00695         \textcolor{keywordtype}{integer(IK)}             :: i,j}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00696}00696         \textcolor{keywordflow}{do} j=1,nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00697}00697             \textcolor{keywordflow}{do} i=1,j}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00698}00698                 choleskylower(i,j) = posdefmat(i,j)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00699}00699 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00700}00700 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00701}00701         \textcolor{keyword}{call }\mbox{\hyperlink{namespacematrix__mod_a36785a7834c11cfd985f34441c06af66}{getcholeskyfactor}}(nd, choleskylower, choleskydiago)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00702}00702         \textcolor{keywordflow}{if} (choleskydiago(1)<0.\_rk) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00703}00703             sqrtdetposdefmat = -\/1.\_rk}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00704}00704             \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00705}00705 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00706}00706         sqrtdetposdefmat = product(choleskydiago)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00707}00707     \textcolor{keyword}{end function }\mbox{\hyperlink{namespacematrix__mod_a869c72bec5850343289680a09254d847}{getsqrtdetposdefmat}}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00708}00708 }
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00709}00709 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00710}00710 }
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00722}\mbox{\hyperlink{namespacematrix__mod_a5cd2528603954515769766dc47b6c0da}{00722}}     \textcolor{keywordtype}{pure} \textcolor{keyword}{subroutine }\mbox{\hyperlink{namespacematrix__mod_a5cd2528603954515769766dc47b6c0da}{getlogsqrtdetposdefmat}}(nd,PosDefMat,logSqrtDetPosDefMat,failed)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00723}00723 \textcolor{preprocessor}{\#if INTEL\_COMPILER\_ENABLED \&\& defined DLL\_ENABLED \&\& (OS\_IS\_WINDOWS || defined OS\_IS\_DARWIN)}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00724}00724 \textcolor{preprocessor}{}        \textcolor{comment}{!DEC\$ ATTRIBUTES DLLEXPORT :: getLogSqrtDetPosDefMat}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00725}00725 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00726}00726 \textcolor{preprocessor}{}        \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceconstants__mod}{constants\_mod}}, \textcolor{keywordtype}{only}: rk, ik}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00727}00727         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00728}00728         \textcolor{keywordtype}{integer(IK)}, \textcolor{keywordtype}{intent(in)}     :: nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00729}00729 \textcolor{keywordtype}{        real}(rk)   , \textcolor{keywordtype}{intent(inout)}  :: posdefmat(nd,nd) \textcolor{comment}{! Upper triangle + diagonal is input matrix, lower is output.}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00730}00730 \textcolor{keywordtype}{        real}(rk)   , \textcolor{keywordtype}{intent(out)}    :: logsqrtdetposdefmat}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00731}00731         \textcolor{keywordtype}{logical}    , \textcolor{keywordtype}{intent(out)}    :: failed}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00732}00732 \textcolor{keywordtype}{        real}(rk)                    :: diagonal(nd)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00733}00733 \textcolor{keywordtype}{        real}(rk)                    :: summ}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00734}00734         \textcolor{keywordtype}{integer(IK)}                 :: i}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00735}00735         failed = .false.}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00736}00736         \textcolor{keywordflow}{do} i=1,nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00737}00737             summ = posdefmat(i,i) -\/ dot\_product(posdefmat(i,1:i-\/1),posdefmat(i,1:i-\/1))}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00738}00738             \textcolor{keywordflow}{if} (summ <= 0.\_rk) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00739}00739                 failed = .true.}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00740}00740                 \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00741}00741 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00742}00742             diagonal(i) = sqrt(summ)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00743}00743             posdefmat(i+1:nd,i) = ( posdefmat(i,i+1:nd) -\/ matmul(posdefmat(i+1:nd,1:i-\/1),posdefmat(i,1:i-\/1)) ) / diagonal(i)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00744}00744 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00745}00745         logsqrtdetposdefmat = sum(log(diagonal))}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00746}00746     \textcolor{keyword}{end subroutine }\mbox{\hyperlink{namespacematrix__mod_a5cd2528603954515769766dc47b6c0da}{getlogsqrtdetposdefmat}}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00747}00747 }
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00748}00748 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00749}00749 }
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00765}\mbox{\hyperlink{namespacematrix__mod_a4457ce676fff3d9e4089018b06ca00fe}{00765}}     \textcolor{keywordtype}{pure} \textcolor{keyword}{logical }\textcolor{keyword}{function }\mbox{\hyperlink{namespacematrix__mod_a4457ce676fff3d9e4089018b06ca00fe}{isposdef}}(nd,Matrix)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00766}00766 \textcolor{preprocessor}{\#if INTEL\_COMPILER\_ENABLED \&\& defined DLL\_ENABLED \&\& (OS\_IS\_WINDOWS || defined OS\_IS\_DARWIN)}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00767}00767 \textcolor{preprocessor}{}        \textcolor{comment}{!DEC\$ ATTRIBUTES DLLEXPORT :: isPosDef}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00768}00768 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00769}00769 \textcolor{preprocessor}{}        \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceconstants__mod}{constants\_mod}}, \textcolor{keywordtype}{only}: rk, ik}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00770}00770         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00771}00771         \textcolor{keywordtype}{integer(IK)}, \textcolor{keywordtype}{intent(in)} :: nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00772}00772 \textcolor{keywordtype}{        real}(rk)   , \textcolor{keywordtype}{intent(in)} :: matrix(nd,nd)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00773}00773 \textcolor{keywordtype}{        real}(rk)                :: array(nd,nd),p(nd)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00774}00774 \textcolor{keywordtype}{        real}(rk)                :: dummysum}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00775}00775         \textcolor{keywordtype}{integer(IK)}             :: i,j,k}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00776}00776         \mbox{\hyperlink{namespacematrix__mod_a4457ce676fff3d9e4089018b06ca00fe}{isposdef}} = .true.}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00777}00777         \textcolor{keywordflow}{do} i = 1, nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00778}00778             \textcolor{keywordflow}{do} j = i, nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00779}00779                 dummysum = matrix(i,j)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00780}00780                 \textcolor{keywordflow}{do} k = i-\/1,1,-\/1}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00781}00781                     dummysum = dummysum -\/ array(i,k) * array(j,k)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00782}00782 \textcolor{keywordflow}{                end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00783}00783                 \textcolor{keywordflow}{if}(i==j)\textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00784}00784                     \textcolor{keywordflow}{if}(dummysum<=0.\_rk) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00785}00785                         \mbox{\hyperlink{namespacematrix__mod_a4457ce676fff3d9e4089018b06ca00fe}{isposdef}} = .false.}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00786}00786                         \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00787}00787 \textcolor{keywordflow}{                    end if}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00788}00788                     p(i) = sqrt(dummysum)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00789}00789                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00790}00790                     array(j,i)=dummysum/p(i)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00791}00791 \textcolor{keywordflow}{                endif}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00792}00792 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00793}00793 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00794}00794     \textcolor{keyword}{end function }\mbox{\hyperlink{namespacematrix__mod_a4457ce676fff3d9e4089018b06ca00fe}{isposdef}}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00795}00795 }
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00796}00796 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00797}00797 }
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00809}\mbox{\hyperlink{namespacematrix__mod_a7ecd812425b1fbacb8c04183ffba8b71}{00809}}     \textcolor{keywordtype}{pure} \textcolor{keyword}{function }\mbox{\hyperlink{namespacematrix__mod_a7ecd812425b1fbacb8c04183ffba8b71}{getouterprod}}(Vector1,Vector2) \textcolor{keyword}{result}(OuterProd)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00810}00810 \textcolor{preprocessor}{\#if INTEL\_COMPILER\_ENABLED \&\& defined DLL\_ENABLED \&\& (OS\_IS\_WINDOWS || defined OS\_IS\_DARWIN)}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00811}00811 \textcolor{preprocessor}{}        \textcolor{comment}{!DEC\$ ATTRIBUTES DLLEXPORT :: getOuterProd}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00812}00812 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00813}00813 \textcolor{preprocessor}{}        \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceconstants__mod}{constants\_mod}}, \textcolor{keywordtype}{only}: rk, ik}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00814}00814 \textcolor{keywordtype}{        real}(rk), \textcolor{keywordtype}{intent(in)} :: vector1(:),vector2(:)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00815}00815 \textcolor{keywordtype}{        real}(rk)             :: outerprod(size(vector1), size(vector2))}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00816}00816         outerprod = spread(vector1,dim=2,ncopies=\textcolor{keyword}{size}(vector2)) * spread(vector2,dim=1,ncopies=\textcolor{keyword}{size}(vector1))}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00817}00817     \textcolor{keyword}{end function }\mbox{\hyperlink{namespacematrix__mod_a7ecd812425b1fbacb8c04183ffba8b71}{getouterprod}}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00818}00818 }
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00819}00819 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00820}00820 }
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00855}\mbox{\hyperlink{namespacematrix__mod_a73f946edb5219bbf949954e9c567af3a}{00855}}     \textcolor{keywordtype}{pure} \textcolor{keyword}{function }\mbox{\hyperlink{test__sortPosDefMat_8f90_a98a32a7ba212598f2137faeb7c83053b}{sortposdefmat}}(rank,PosDefMatUpper,lenColIndx,ColIndx,ColIndxMap) \textcolor{keyword}{result}(SortedPosDefMatUpper)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00856}00856 \textcolor{preprocessor}{\#if INTEL\_COMPILER\_ENABLED \&\& defined DLL\_ENABLED \&\& (OS\_IS\_WINDOWS || defined OS\_IS\_DARWIN)}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00857}00857 \textcolor{preprocessor}{}        \textcolor{comment}{!DEC\$ ATTRIBUTES DLLEXPORT :: sortPosDefMat}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00858}00858 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00859}00859 \textcolor{preprocessor}{}        \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceconstants__mod}{constants\_mod}}, \textcolor{keywordtype}{only}: rk, ik}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00860}00860         \textcolor{keywordtype}{integer(IK)}, \textcolor{keywordtype}{intent(in)} :: rank, lencolindx, colindx(lencolindx), colindxmap(lencolindx)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00861}00861 \textcolor{keywordtype}{        real}(rk), \textcolor{keywordtype}{intent(in)}    :: posdefmatupper(rank,rank)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00862}00862 \textcolor{keywordtype}{        real}(rk)                :: sortedposdefmatupper(rank,rank)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00863}00863         \textcolor{keywordtype}{integer(IK)}             :: irow, icol, irownew, icolnew, i}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00864}00864         loopindx: \textcolor{keywordflow}{do} i = 1, lencolindx}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00865}00865             \textcolor{keywordflow}{do} icol = 1, rank}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00866}00866                 icolnew = icol}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00867}00867                 \textcolor{keywordflow}{if} (icolnew==colindx(i)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00868}00868                     icolnew = colindxmap(i)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00869}00869                 \textcolor{keywordflow}{elseif} (icolnew==colindxmap(i)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00870}00870                     icolnew = colindx(i)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00871}00871 \textcolor{keywordflow}{                end if}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00872}00872                 \textcolor{keywordflow}{do} irow = 1, icol}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00873}00873                     irownew = irow}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00874}00874                     \textcolor{keywordflow}{if} (irownew==colindx(i)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00875}00875                         irownew = colindxmap(i)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00876}00876                     \textcolor{keywordflow}{elseif} (irownew==colindxmap(i)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00877}00877                         irownew = colindx(i)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00878}00878 \textcolor{keywordflow}{                    end if}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00879}00879                     \textcolor{keywordflow}{if} (irownew>icolnew) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00880}00880                         sortedposdefmatupper(irow,icol) = posdefmatupper(icolnew,irownew)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00881}00881                     \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00882}00882                         sortedposdefmatupper(irow,icol) = posdefmatupper(irownew,icolnew)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00883}00883 \textcolor{keywordflow}{                    end if}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00884}00884 \textcolor{keywordflow}{                end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00885}00885 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00886}00886 \textcolor{keywordflow}{        end do} loopindx}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00887}00887     \textcolor{keyword}{end function }\mbox{\hyperlink{test__sortPosDefMat_8f90_a98a32a7ba212598f2137faeb7c83053b}{sortposdefmat}}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00888}00888 }
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00889}00889 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00890}00890 }
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00899}\mbox{\hyperlink{namespacematrix__mod_aaa2f76d9a5c874ca4fbb4a949dd1ff11}{00899}}     \textcolor{keywordtype}{pure} \textcolor{keyword}{subroutine }\mbox{\hyperlink{namespacematrix__mod_aaa2f76d9a5c874ca4fbb4a949dd1ff11}{symmetrizeuppersquarematrix}}(nd,UpperSquareMatrix)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00900}00900 \textcolor{preprocessor}{\#if INTEL\_COMPILER\_ENABLED \&\& defined DLL\_ENABLED \&\& (OS\_IS\_WINDOWS || defined OS\_IS\_DARWIN)}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00901}00901 \textcolor{preprocessor}{}        \textcolor{comment}{!DEC\$ ATTRIBUTES DLLEXPORT :: symmetrizeUpperSquareMatrix}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00902}00902 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00903}00903 \textcolor{preprocessor}{}        \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceconstants__mod}{constants\_mod}}, \textcolor{keywordtype}{only}: rk, ik}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00904}00904         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00905}00905         \textcolor{keywordtype}{integer(IK)} , \textcolor{keywordtype}{intent(in)}    :: nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00906}00906 \textcolor{keywordtype}{        real}(rk)    , \textcolor{keywordtype}{intent(inout)} :: uppersquarematrix(nd,nd)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00907}00907         \textcolor{keywordtype}{integer(IK)}                 :: i, j}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00908}00908         \textcolor{keywordflow}{do} j = 1, nd}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00909}00909             \textcolor{keywordflow}{do} i = 1,j-\/1}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00910}00910                 uppersquarematrix(j,i) = uppersquarematrix(i,j)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00911}00911 \textcolor{keywordflow}{            end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00912}00912 \textcolor{keywordflow}{        end do}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00913}00913     \textcolor{keyword}{end subroutine }\mbox{\hyperlink{namespacematrix__mod_aaa2f76d9a5c874ca4fbb4a949dd1ff11}{symmetrizeuppersquarematrix}}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00914}00914 }
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00915}00915 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00916}00916 }
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00942}\mbox{\hyperlink{namespacematrix__mod_a63aed0b5f6d5289f3f7183cffb1435cd}{00942}}     \textcolor{keywordtype}{pure} \textcolor{keyword}{subroutine }\mbox{\hyperlink{namespacematrix__mod_a63aed0b5f6d5289f3f7183cffb1435cd}{getregrescoef}}(rankPDM,rankS11,rankS22,PosDefMat,RegresCoefMat,SchurComplement)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00943}00943 \textcolor{preprocessor}{\#if INTEL\_COMPILER\_ENABLED \&\& defined DLL\_ENABLED \&\& (OS\_IS\_WINDOWS || defined OS\_IS\_DARWIN)}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00944}00944 \textcolor{preprocessor}{}        \textcolor{comment}{!DEC\$ ATTRIBUTES DLLEXPORT :: getRegresCoef}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00945}00945 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00946}00946 \textcolor{preprocessor}{}        \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceconstants__mod}{constants\_mod}}, \textcolor{keywordtype}{only}: rk, ik \textcolor{comment}{! LCOV\_EXCL\_LINE}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00947}00947         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00948}00948         \textcolor{keywordtype}{integer(IK)}, \textcolor{keywordtype}{intent(in)}             :: rankpdm, ranks11, ranks22}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00949}00949 \textcolor{keywordtype}{        real}(rk), \textcolor{keywordtype}{intent(in)}                :: posdefmat(rankpdm,rankpdm)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00950}00950 \textcolor{keywordtype}{        real}(rk), \textcolor{keywordtype}{intent(out)}               :: regrescoefmat(ranks11,ranks22)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00951}00951 \textcolor{keywordtype}{        real}(rk), \textcolor{keywordtype}{intent(out)}, \textcolor{keywordtype}{optional}     :: schurcomplement(ranks11,ranks11)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00952}00952 \textcolor{keywordtype}{        real}(rk)                            :: invs22(ranks22,ranks22), s22(ranks22,ranks22)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00953}00953         \textcolor{keywordtype}{integer(IK)}                         :: starts22}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00954}00954         starts22 = ranks11 + 1}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00955}00955         s22 = posdefmat(starts22:rankpdm,starts22:rankpdm)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00956}00956         \textcolor{keywordflow}{if} (ranks22==1) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00957}00957             invs22(1,1) = 1.\_rk/s22(1,1)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00958}00958         \textcolor{keywordflow}{else}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00959}00959             invs22 = \mbox{\hyperlink{namespacematrix__mod_a541fac75a210dc71c90db6a780a7b43f}{getinvposdefmat}}(ranks22,s22)}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00960}00960 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00961}00961         \textcolor{keywordflow}{if} (invs22(1,1)<0.\_rk) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00962}00962             regrescoefmat(1,1) = -\/1.\_rk}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00963}00963             \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00964}00964 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00965}00965         regrescoefmat = matmul( posdefmat(1:ranks11,starts22:rankpdm) , invs22 )}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00966}00966         \textcolor{keywordflow}{if} (\textcolor{keyword}{present}(schurcomplement)) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00967}00967             schurcomplement = posdefmat(1:ranks11,1:ranks11) -\/ matmul( regrescoefmat , posdefmat(starts22:rankpdm,1:ranks11) )}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00968}00968 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00969}00969     \textcolor{keyword}{end subroutine }\mbox{\hyperlink{namespacematrix__mod_a63aed0b5f6d5289f3f7183cffb1435cd}{getregrescoef}}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00970}00970 }
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00971}00971 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00972}00972 }
\DoxyCodeLine{\Hypertarget{Matrix__mod_8f90_source_l00973}00973 \textcolor{keyword}{end module }\mbox{\hyperlink{namespacematrix__mod}{matrix\_mod}} ! lcov\_excl\_line}

\end{DoxyCode}
