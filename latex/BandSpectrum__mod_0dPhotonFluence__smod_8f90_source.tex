\hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source}{}\doxysection{Band\+Spectrum\+\_\+mod@Photon\+Fluence\+\_\+smod.\+f90}
\label{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source}\index{D:/Dropbox/Projects/20180101\_ParaMonte/git/src/kernel/BandSpectrum\_mod"@PhotonFluence\_smod.f90@{D:/Dropbox/Projects/20180101\_ParaMonte/git/src/kernel/BandSpectrum\_mod"@PhotonFluence\_smod.f90}}
\mbox{\hyperlink{BandSpectrum__mod_0dPhotonFluence__smod_8f90}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00001}00001 submodule(\mbox{\hyperlink{namespacebandspectrum__mod}{bandspectrum\_mod}}) photonfluence\_smod}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00002}00002 }
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00003}00003     \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00004}00004 }
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00005}00005 \textcolor{keywordtype}{    real}(RK)                        :: mv\_alpha}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00006}00006 \textcolor{keywordtype}{    real}(RK)                        :: mv\_alphaPlusTwoOverEpk}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00007}00007 }
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00008}00008 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00009}00009 }
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00010}00010 \textcolor{keyword}{contains}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00011}00011 }
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00012}00012 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00013}00013 }
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00025}00025     \textcolor{keyword}{module} subroutine getphotonfluence(lowerlim,upperlim,epk,alpha,beta,tolerance,photonfluence,err)}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00026}00026 \textcolor{preprocessor}{\#if INTEL\_COMPILER\_ENABLED \&\& defined DLL\_ENABLED \&\& (OS\_IS\_WINDOWS || defined OS\_IS\_DARWIN)}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00027}00027 \textcolor{preprocessor}{}        \textcolor{comment}{!DEC\$ ATTRIBUTES DLLEXPORT :: getPhotonFluence}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00028}00028 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00029}00029 \textcolor{preprocessor}{}       \textcolor{comment}{!use Integration\_mod, only: doQuadRombClosed}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00030}00030         \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceconstants__mod}{constants\_mod}}, \textcolor{keywordtype}{only}: ik, rk, \mbox{\hyperlink{namespaceconstants__mod_a64b4b857693e2b7445ef2d93ef0a28a7}{huge\_rk}}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00031}00031         \textcolor{keywordtype}{use }\mbox{\hyperlink{namespacequadpackspr__mod}{quadpackspr\_mod}}, \textcolor{keywordtype}{only}: \mbox{\hyperlink{namespacequadpackspr__mod_a3d622c5dfbd29a96e658c3b2968f409c}{qag}}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00032}00032         \textcolor{keywordtype}{use }\mbox{\hyperlink{namespaceerr__mod}{err\_mod}}, \textcolor{keywordtype}{only}: \mbox{\hyperlink{structerr__mod_1_1err__type}{err\_type}}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00033}00033         \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00034}00034 \textcolor{keywordtype}{        real}(RK), \textcolor{keywordtype}{intent(in)}            :: lowerLim, upperLim, epk, alpha, beta, tolerance}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00035}00035 \textcolor{keywordtype}{        real}(RK), \textcolor{keywordtype}{intent(out)}           :: photonFluence}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00036}00036         \textcolor{keywordtype}{type}(Err\_type), \textcolor{keywordtype}{intent(out)}     :: Err}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00037}00037         \textcolor{keywordtype}{character(*)}, \textcolor{keywordtype}{parameter}         :: PROCEDURE\_NAME = \textcolor{stringliteral}{"{}@getPhotonFluence()"{}}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00038}00038 \textcolor{keywordtype}{        real}(RK)                        :: ebrk, alphaPlusTwo}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00039}00039 \textcolor{keywordtype}{        real}(RK)                        :: thisUpperLim, betaPlusOne}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00040}00040 \textcolor{keywordtype}{        real}(RK)                        :: alphaMinusBeta, coef}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00041}00041 \textcolor{keywordtype}{        real}(RK)                        :: abserr}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00042}00042         \textcolor{keywordtype}{integer(IK)}                     :: neval}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00043}00043         \textcolor{keywordtype}{integer(IK)}                     :: ierr}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00044}00044        \textcolor{comment}{!real(RK)                        :: alphaPlusOne, logGammaAlphaPlusOne}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00045}00045 }
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00046}00046         err\%occurred = .false.}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00047}00047 }
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00048}00048         \textcolor{keywordflow}{if} (lowerlim>=upperlim) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00049}00049             photonfluence = 0.\_rk}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00050}00050             \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00051}00051 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00052}00052 }
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00053}00053         \textcolor{comment}{! check if the photon indices are consistent with the mathematical rules}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00054}00054         \textcolor{keywordflow}{if} (alpha<beta .or. alpha<-\/2.\_rk) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00055}00055             photonfluence = -\/\mbox{\hyperlink{namespaceconstants__mod_a64b4b857693e2b7445ef2d93ef0a28a7}{huge\_rk}}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00056}00056             err\%occurred = .true.}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00057}00057             err\%msg = \mbox{\hyperlink{namespaceconstants__mod_a7facbdd6f237b77f9c08c94fbe98e847}{module\_name}} // procedure\_name // .or.\textcolor{stringliteral}{"{}: Error occurred: alpha<beta  alpha<-\/2.\_RK"{}}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00058}00058             \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00059}00059 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00060}00060 }
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00061}00061         \textcolor{comment}{! integrate the spectrum}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00062}00062         alphaplustwo = alpha + 2.\_rk}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00063}00063         alphaminusbeta = alpha -\/ beta}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00064}00064         ebrk = epk*alphaminusbeta/alphaplustwo}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00065}00065 }
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00066}00066         \textcolor{keywordflow}{if} (lowerlim>ebrk) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00067}00067 }
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00068}00068             \textcolor{comment}{! there is only the high energy component in the photonFluence}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00069}00069             betaplusone = beta + 1.\_rk}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00070}00070             coef = ebrk**alphaminusbeta * exp(-\/alphaminusbeta);}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00071}00071             photonfluence = coef * ( upperlim**betaplusone -\/ lowerlim**betaplusone ) / betaplusone}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00072}00072             \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00073}00073 }
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00074}00074         \textcolor{keywordflow}{elseif} (lowerlim<ebrk) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00075}00075 }
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00076}00076             mv\_alpha = alpha}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00077}00077 }
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00078}00078             mv\_alphaplustwooverepk = alphaplustwo / epk}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00079}00079             thisupperlim = min(upperlim,ebrk)}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00080}00080             \textcolor{comment}{!alphaPlusOne = alpha + 1.\_RK}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00081}00081             \textcolor{comment}{!if (alpha>-\/1.\_RK) then}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00082}00082             \textcolor{comment}{!    logGammaAlphaPlusOne = log\_gamma( alphaPlusOne )}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00083}00083             \textcolor{comment}{!    ! use the analytical approach to compute the photonFluence:}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00084}00084             \textcolor{comment}{!    ! https://www.wolframalpha.com/input/?i=integrate+x\%5Ea+*+exp(-\/b*x)}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00085}00085             \textcolor{comment}{!    photonFluence = getUpperGamma( exponent = alphaPlusOne \&}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00086}00086             \textcolor{comment}{!                            , logGammaExponent = logGammaAlphaPlusOne \&}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00087}00087             \textcolor{comment}{!                            , lowerLim = mv\_alphaPlusTwoOverEpk * lowerLim \&}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00088}00088             \textcolor{comment}{!                            , tolerance = tolerance \&}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00089}00089             \textcolor{comment}{!                            ) \&}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00090}00090             \textcolor{comment}{!             -\/ getUpperGamma( exponent = alphaPlusOne \&}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00091}00091             \textcolor{comment}{!                            , logGammaExponent = logGammaAlphaPlusOne \&}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00092}00092             \textcolor{comment}{!                            , lowerLim = mv\_alphaPlusTwoOverEpk * thisUpperLim \&}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00093}00093             \textcolor{comment}{!                            , tolerance = tolerance \&}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00094}00094             \textcolor{comment}{!                            )}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00095}00095             \textcolor{comment}{!    photonFluence = photonFluence / mv\_alphaPlusTwoOverEpk**alphaPlusOne}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00096}00096             \textcolor{comment}{!else}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00097}00097                 \textcolor{comment}{! use brute-\/force integration}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00098}00098                 \textcolor{keyword}{call }\mbox{\hyperlink{namespacequadpackspr__mod_a3d622c5dfbd29a96e658c3b2968f409c}{qag}}( f             = getbandcomplowphoton  \&}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00099}00099                         , a             = lowerlim              \&}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00100}00100                         , b             = thisupperlim          \&}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00101}00101                         , epsabs        = 0.\_rk                 \&}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00102}00102                         , epsrel        = tolerance             \&}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00103}00103                         , key           = 1\_ik                  \&}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00104}00104                         , result        = photonfluence         \&}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00105}00105                         , abserr        = abserr                \&}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00106}00106                         , neval         = neval                 \&}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00107}00107                         , ier           = ierr                  \&}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00108}00108                         )}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00109}00109                 \textcolor{comment}{!write(*,*) neval}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00110}00110                 \textcolor{comment}{!call doQuadRombClosed   ( getFunc       = getBandCompLowPhoton \&}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00111}00111                 \textcolor{comment}{!                        , xmin          = lowerLim             \&}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00112}00112                 \textcolor{comment}{!                        , xmax          = thisUpperLim         \&}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00113}00113                 \textcolor{comment}{!                        , tolerance     = 1.e-\/7\_RK             \&}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00114}00114                 \textcolor{comment}{!                        , nRefinement   = 10\_IK                \&}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00115}00115                 \textcolor{comment}{!                        , photonFluence = photonFluence        \&}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00116}00116                 \textcolor{comment}{!                        , ierr          = ierr                 \&}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00117}00117                 \textcolor{comment}{!                        )}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00118}00118                 \textcolor{keywordflow}{if} (ierr/=0\_ik) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00119}00119                 \textcolor{comment}{! LCOV\_EXCL\_START}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00120}00120                     photonfluence = -\/\mbox{\hyperlink{namespaceconstants__mod_a64b4b857693e2b7445ef2d93ef0a28a7}{huge\_rk}}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00121}00121                     err\%occurred = .true.}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00122}00122                     err\%stat = ierr}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00123}00123                     err\%msg = \mbox{\hyperlink{namespaceconstants__mod_a7facbdd6f237b77f9c08c94fbe98e847}{module\_name}} // procedure\_name // \textcolor{stringliteral}{"{}: Error occurred at QuadPack routine. Check the error code to identify the root cause."{}}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00124}00124                     \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00125}00125                 \textcolor{comment}{! LCOV\_EXCL\_STOP}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00126}00126 \textcolor{keywordflow}{                end if}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00127}00127             \textcolor{comment}{!end if}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00128}00128 }
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00129}00129             \textcolor{keywordflow}{if} (upperlim>ebrk) \textcolor{keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00130}00130                 \textcolor{comment}{! add the remaining part of the photonFluence from the high-\/energy component}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00131}00131                 betaplusone = beta + 1.\_rk}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00132}00132                 alphaminusbeta = alpha -\/ beta}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00133}00133                 coef = ebrk**alphaminusbeta * exp(-\/alphaminusbeta);}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00134}00134                 photonfluence = photonfluence + coef * ( upperlim**betaplusone -\/ ebrk**betaplusone ) / betaplusone}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00135}00135                 \textcolor{keywordflow}{return}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00136}00136 \textcolor{keywordflow}{            end if}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00137}00137 }
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00138}00138 \textcolor{keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00139}00139 }
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00140}00140     \textcolor{keyword}{end subroutine }getphotonfluence}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00141}00141 }
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00142}00142 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00143}00143 }
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00144}00144     \textcolor{keywordtype}{pure} \textcolor{keyword}{function }getbandcomplowphoton(energy) \textcolor{keyword}{result}(bandCompLow)}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00145}00145 \textcolor{preprocessor}{\#if INTEL\_COMPILER\_ENABLED \&\& defined DLL\_ENABLED \&\& (OS\_IS\_WINDOWS || defined OS\_IS\_DARWIN)}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00146}00146 \textcolor{preprocessor}{}        \textcolor{comment}{!DEC\$ ATTRIBUTES DLLEXPORT :: getBandCompLowPhoton}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00147}00147 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00148}00148 \textcolor{preprocessor}{}        \textcolor{keywordtype}{implicit none}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00149}00149 \textcolor{keywordtype}{        real}(RK), \textcolor{keywordtype}{intent(in)}    :: energy}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00150}00150 \textcolor{keywordtype}{        real}(RK)                :: bandCompLow}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00151}00151         bandcomplow = energy**mv\_alpha * exp(-\/mv\_alphaplustwooverepk*energy)}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00152}00152     \textcolor{keyword}{end function }getbandcomplowphoton}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00153}00153 }
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00154}00154 \textcolor{comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00155}00155 }
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00156}00156 \textcolor{keyword}{end }submodule photonfluence\_smod ! lcov\_excl\_line}

\end{DoxyCode}
