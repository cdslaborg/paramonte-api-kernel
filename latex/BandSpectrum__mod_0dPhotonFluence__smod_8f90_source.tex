\hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source}{}\doxysection{Band\+Spectrum\+\_\+mod@Photon\+Fluence\+\_\+smod.\+f90}
\label{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source}\index{/home/amir/git/paramonte/src/kernel/BandSpectrum\_mod"@PhotonFluence\_smod.f90@{/home/amir/git/paramonte/src/kernel/BandSpectrum\_mod"@PhotonFluence\_smod.f90}}
\mbox{\hyperlink{BandSpectrum__mod_0dPhotonFluence__smod_8f90}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00001}00001 submodule(\mbox{\hyperlink{namespaceBandSpectrum__mod}{BandSpectrum\_mod}}) PhotonFluence\_smod}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00002}00002 }
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00003}00003     \textcolor{fortran_statement}{implicit none}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00004}00004 }
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00005}00005 \textcolor{fortran_statement}{    real}(RK)                        :: mv\_alpha}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00006}00006 \textcolor{fortran_statement}{    real}(RK)                        :: mv\_alphaPlusTwoOverEpk}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00007}00007 }
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00008}00008 \textcolor{fortran_comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00009}00009 }
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00010}00010 \textcolor{fortran_statement}{contains}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00011}00011 }
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00012}00012 \textcolor{fortran_comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00013}00013 }
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00025}00025     \textcolor{fortran_prefix}{module subroutine }getPhotonFluence(lowerLim,upperLim,epk,alpha,beta,tolerance,photonFluence,Err)}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00026}00026 \textcolor{preprocessor}{\#if INTEL\_COMPILER\_ENABLED \&\& DLL\_ENABLED \&\& (WINDOWS\_ENABLED || DARWIN\_ENABLED)}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00027}00027 \textcolor{preprocessor}{}\textcolor{fortran_directive_intel}{        !DEC\$ ATTRIBUTES DLLEXPORT }:: getPhotonFluence}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00028}00028 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00029}00029 \textcolor{preprocessor}{}       \textcolor{fortran_comment}{!use Integration\_mod, only: doQuadRombClosed}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00030}00030         \textcolor{fortran_statement}{use }\mbox{\hyperlink{namespaceConstants__mod}{Constants\_mod}}, \textcolor{fortran_statement}{only}: \mbox{\hyperlink{namespaceConstants__mod_a2bf4d6767c9954d3a495d10ab6b538d6}{IK}}, \mbox{\hyperlink{namespaceConstants__mod_a2d9d57f0148a7016d900f471e5f28069}{RK}}, \mbox{\hyperlink{namespaceConstants__mod_a2a237aad212d8b56b0000553021996f6}{HUGE\_RK}}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00031}00031         \textcolor{fortran_statement}{use }\mbox{\hyperlink{namespaceQuadPackRK32__mod}{QuadPackRK32\_mod}}, \textcolor{fortran_statement}{only}: \mbox{\hyperlink{namespaceQuadPackRK32__mod_a2f44b737c589c08c405a5313d709eca6}{qag}}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00032}00032         \textcolor{fortran_statement}{use }\mbox{\hyperlink{namespaceErr__mod}{Err\_mod}}, \textcolor{fortran_statement}{only}: \mbox{\hyperlink{structErr__mod_1_1Err__type}{Err\_type}}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00033}00033         \textcolor{fortran_statement}{implicit none}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00034}00034 \textcolor{fortran_statement}{        real}(RK),\textcolor{fortran_attribute}{ intent(in)}            :: lowerLim, upperLim, epk, alpha, beta, tolerance}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00035}00035 \textcolor{fortran_statement}{        real}(RK),\textcolor{fortran_attribute}{ intent(out)}           :: photonFluence}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00036}00036         \textcolor{fortran_statement}{type}(Err\_type),\textcolor{fortran_attribute}{ intent(out)}     :: Err}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00037}00037         \textcolor{fortran_statement}{character}(\textcolor{fortran_operator_symbols}{*}),\textcolor{fortran_attribute}{ parameter}         :: PROCEDURE\_NAME\textcolor{fortran_operator_symbols}{ = }\textcolor{fortran_string}{"{}@getPhotonFluence()"{}}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00038}00038 \textcolor{fortran_statement}{        real}(RK)                        :: ebrk, alphaPlusTwo}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00039}00039 \textcolor{fortran_statement}{        real}(RK)                        :: thisUpperLim, betaPlusOne}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00040}00040 \textcolor{fortran_statement}{        real}(RK)                        :: alphaMinusBeta, coef}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00041}00041 \textcolor{fortran_statement}{        real}(RK)                        :: abserr}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00042}00042         \textcolor{fortran_statement}{integer}(IK)                     :: neval}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00043}00043         \textcolor{fortran_statement}{integer}(IK)                     :: ierr}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00044}00044        \textcolor{fortran_comment}{!real(RK)                        :: alphaPlusOne, logGammaAlphaPlusOne}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00045}00045 }
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00046}00046         Err\textcolor{fortran_operator_symbols}{\%}occurred\textcolor{fortran_operator_symbols}{ = }\textcolor{fortran_named_const}{.false.}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00047}00047 }
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00048}00048         \textcolor{fortran_keywordflow}{if} (lowerLim\textcolor{fortran_operator_symbols}{>}\textcolor{fortran_operator_symbols}{=}upperLim) \textcolor{fortran_keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00049}00049             photonFluence\textcolor{fortran_operator_symbols}{ = }\textcolor{fortran_numeric_literal}{0.\_RK}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00050}00050 \textcolor{fortran_statement}{            return}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00051}00051 \textcolor{fortran_keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00052}00052 }
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00053}00053         \textcolor{fortran_comment}{! check if the photon indices are consistent with the mathematical rules}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00054}00054         \textcolor{fortran_keywordflow}{if} (alpha\textcolor{fortran_operator_symbols}{<}beta \textcolor{fortran_operator_logical}{.or.} alpha\textcolor{fortran_operator_symbols}{<}\textcolor{fortran_operator_symbols}{-\/}\textcolor{fortran_numeric_literal}{2.\_RK}) \textcolor{fortran_keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00055}00055             photonFluence\textcolor{fortran_operator_symbols}{ = }\textcolor{fortran_operator_symbols}{-\/}\mbox{\hyperlink{namespaceConstants__mod_a2a237aad212d8b56b0000553021996f6}{HUGE\_RK}}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00056}00056             Err\textcolor{fortran_operator_symbols}{\%}occurred\textcolor{fortran_operator_symbols}{ = }\textcolor{fortran_named_const}{.true.}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00057}00057             Err\textcolor{fortran_operator_symbols}{\%}msg\textcolor{fortran_operator_symbols}{ = }\mbox{\hyperlink{namespaceConstants__mod_ade87ed33b235f099b65904dc21cbe01e}{MODULE\_NAME}}\textcolor{fortran_operator_symbols}{ /}\textcolor{fortran_operator_symbols}{/ }PROCEDURE\_NAME\textcolor{fortran_operator_symbols}{ /}\textcolor{fortran_operator_symbols}{/ }\textcolor{fortran_operator_logical}{.or.}\textcolor{fortran_string}{"{}: Error occurred: alpha<beta  alpha<-\/2.\_RK"{}}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00058}00058 \textcolor{fortran_statement}{            return}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00059}00059 \textcolor{fortran_keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00060}00060 }
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00061}00061         \textcolor{fortran_comment}{! integrate the spectrum}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00062}00062         alphaPlusTwo\textcolor{fortran_operator_symbols}{ = }alpha\textcolor{fortran_operator_symbols}{ + }\textcolor{fortran_numeric_literal}{2.\_RK}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00063}00063         alphaMinusBeta\textcolor{fortran_operator_symbols}{ = }alpha\textcolor{fortran_operator_symbols}{ -\/ }beta}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00064}00064         ebrk\textcolor{fortran_operator_symbols}{ = }epk\textcolor{fortran_operator_symbols}{*}alphaMinusBeta\textcolor{fortran_operator_symbols}{/}alphaPlusTwo}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00065}00065 }
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00066}00066         \textcolor{fortran_keywordflow}{if} (lowerLim\textcolor{fortran_operator_symbols}{>}ebrk) \textcolor{fortran_keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00067}00067 }
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00068}00068             \textcolor{fortran_comment}{! there is only the high energy component in the photonFluence}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00069}00069             betaPlusOne\textcolor{fortran_operator_symbols}{ = }beta\textcolor{fortran_operator_symbols}{ + }\textcolor{fortran_numeric_literal}{1.\_RK}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00070}00070             coef\textcolor{fortran_operator_symbols}{ = }ebrk\textcolor{fortran_operator_symbols}{*}\textcolor{fortran_operator_symbols}{*}alphaMinusBeta\textcolor{fortran_operator_symbols}{ * }\textcolor{fortran_function}{exp}(\textcolor{fortran_operator_symbols}{-\/}alphaMinusBeta);}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00071}00071             photonFluence\textcolor{fortran_operator_symbols}{ = }coef\textcolor{fortran_operator_symbols}{ * }( upperLim\textcolor{fortran_operator_symbols}{*}\textcolor{fortran_operator_symbols}{*}betaPlusOne\textcolor{fortran_operator_symbols}{ -\/ }lowerLim\textcolor{fortran_operator_symbols}{*}\textcolor{fortran_operator_symbols}{*}betaPlusOne )\textcolor{fortran_operator_symbols}{ / }betaPlusOne}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00072}00072 \textcolor{fortran_statement}{            return}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00073}00073 }
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00074}00074         \textcolor{fortran_keywordflow}{elseif} (lowerLim\textcolor{fortran_operator_symbols}{<}ebrk) \textcolor{fortran_keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00075}00075 }
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00076}00076             mv\_alpha\textcolor{fortran_operator_symbols}{ = }alpha}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00077}00077 }
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00078}00078             mv\_alphaPlusTwoOverEpk\textcolor{fortran_operator_symbols}{ = }alphaPlusTwo\textcolor{fortran_operator_symbols}{ / }epk}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00079}00079             thisUpperLim\textcolor{fortran_operator_symbols}{ = }\textcolor{fortran_function}{min}(upperLim,ebrk)}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00080}00080             \textcolor{fortran_comment}{!alphaPlusOne = alpha + 1.\_RK}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00081}00081             \textcolor{fortran_comment}{!if (alpha>-\/1.\_RK) then}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00082}00082             \textcolor{fortran_comment}{!    logGammaAlphaPlusOne = log\_gamma( alphaPlusOne )}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00083}00083             \textcolor{fortran_comment}{!    ! use the analytical approach to compute the photonFluence:}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00084}00084             \textcolor{fortran_comment}{!    ! https://www.wolframalpha.com/input/?i=integrate+x\%5Ea+*+exp(-\/b*x)}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00085}00085             \textcolor{fortran_comment}{!    photonFluence = getUpperGamma( exponent = alphaPlusOne \&}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00086}00086             \textcolor{fortran_comment}{!                            , logGammaExponent = logGammaAlphaPlusOne \&}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00087}00087             \textcolor{fortran_comment}{!                            , lowerLim = mv\_alphaPlusTwoOverEpk * lowerLim \&}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00088}00088             \textcolor{fortran_comment}{!                            , tolerance = tolerance \&}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00089}00089             \textcolor{fortran_comment}{!                            ) \&}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00090}00090             \textcolor{fortran_comment}{!             -\/ getUpperGamma( exponent = alphaPlusOne \&}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00091}00091             \textcolor{fortran_comment}{!                            , logGammaExponent = logGammaAlphaPlusOne \&}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00092}00092             \textcolor{fortran_comment}{!                            , lowerLim = mv\_alphaPlusTwoOverEpk * thisUpperLim \&}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00093}00093             \textcolor{fortran_comment}{!                            , tolerance = tolerance \&}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00094}00094             \textcolor{fortran_comment}{!                            )}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00095}00095             \textcolor{fortran_comment}{!    photonFluence = photonFluence / mv\_alphaPlusTwoOverEpk**alphaPlusOne}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00096}00096             \textcolor{fortran_comment}{!else}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00097}00097                 \textcolor{fortran_comment}{! use brute-\/force integration}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00098}00098 \textcolor{fortran_statement}{                call} \mbox{\hyperlink{namespaceQuadPackRK32__mod_a2f44b737c589c08c405a5313d709eca6}{qag}}( f\textcolor{fortran_operator_symbols}{             = }getBandCompLowPhoton\textcolor{fortran_operator_symbols}{  \&}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00099}00099                         , a\textcolor{fortran_operator_symbols}{             = }lowerLim\textcolor{fortran_operator_symbols}{              \&}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00100}00100                         , b\textcolor{fortran_operator_symbols}{             = }thisUpperLim\textcolor{fortran_operator_symbols}{          \&}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00101}00101                         , epsabs\textcolor{fortran_operator_symbols}{        = }\textcolor{fortran_numeric_literal}{0.\_RK}\textcolor{fortran_operator_symbols}{                 \&}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00102}00102                         , epsrel\textcolor{fortran_operator_symbols}{        = }tolerance\textcolor{fortran_operator_symbols}{             \&}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00103}00103                         , key\textcolor{fortran_operator_symbols}{           = }\textcolor{fortran_numeric_literal}{1\_IK}\textcolor{fortran_operator_symbols}{                  \&}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00104}00104                         ,\textcolor{fortran_statement}{ result}\textcolor{fortran_operator_symbols}{        = }photonFluence\textcolor{fortran_operator_symbols}{         \&}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00105}00105                         , abserr\textcolor{fortran_operator_symbols}{        = }abserr\textcolor{fortran_operator_symbols}{                \&}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00106}00106                         , neval\textcolor{fortran_operator_symbols}{         = }neval\textcolor{fortran_operator_symbols}{                 \&}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00107}00107                         , ier\textcolor{fortran_operator_symbols}{           = }ierr\textcolor{fortran_operator_symbols}{                  \&}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00108}00108                         )}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00109}00109                 \textcolor{fortran_comment}{!write(*,*) neval}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00110}00110                 \textcolor{fortran_comment}{!call doQuadRombClosed   ( getFunc       = getBandCompLowPhoton \&}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00111}00111                 \textcolor{fortran_comment}{!                        , xmin          = lowerLim             \&}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00112}00112                 \textcolor{fortran_comment}{!                        , xmax          = thisUpperLim         \&}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00113}00113                 \textcolor{fortran_comment}{!                        , tolerance     = 1.e-\/7\_RK             \&}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00114}00114                 \textcolor{fortran_comment}{!                        , nRefinement   = 10\_IK                \&}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00115}00115                 \textcolor{fortran_comment}{!                        , photonFluence = photonFluence        \&}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00116}00116                 \textcolor{fortran_comment}{!                        , ierr          = ierr                 \&}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00117}00117                 \textcolor{fortran_comment}{!                        )}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00118}00118                 \textcolor{fortran_keywordflow}{if} (ierr\textcolor{fortran_operator_symbols}{/}\textcolor{fortran_operator_symbols}{=}\textcolor{fortran_numeric_literal}{0\_IK}) \textcolor{fortran_keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00119}00119                 \textcolor{fortran_comment}{! LCOV\_EXCL\_START}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00120}00120                     photonFluence\textcolor{fortran_operator_symbols}{ = }\textcolor{fortran_operator_symbols}{-\/}\mbox{\hyperlink{namespaceConstants__mod_a2a237aad212d8b56b0000553021996f6}{HUGE\_RK}}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00121}00121                     Err\textcolor{fortran_operator_symbols}{\%}occurred\textcolor{fortran_operator_symbols}{ = }\textcolor{fortran_named_const}{.true.}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00122}00122                     Err\textcolor{fortran_operator_symbols}{\%}stat\textcolor{fortran_operator_symbols}{ = }ierr}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00123}00123                     Err\textcolor{fortran_operator_symbols}{\%}msg\textcolor{fortran_operator_symbols}{ = }\mbox{\hyperlink{namespaceConstants__mod_ade87ed33b235f099b65904dc21cbe01e}{MODULE\_NAME}}\textcolor{fortran_operator_symbols}{ /}\textcolor{fortran_operator_symbols}{/ }PROCEDURE\_NAME\textcolor{fortran_operator_symbols}{ /}\textcolor{fortran_operator_symbols}{/ }\textcolor{fortran_string}{"{}: Error occurred at QuadPack routine. Check the error code to identify the root cause."{}}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00124}00124 \textcolor{fortran_statement}{                    return}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00125}00125                 \textcolor{fortran_comment}{! LCOV\_EXCL\_STOP}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00126}00126 \textcolor{fortran_keywordflow}{                end if}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00127}00127             \textcolor{fortran_comment}{!end if}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00128}00128 }
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00129}00129             \textcolor{fortran_keywordflow}{if} (upperLim\textcolor{fortran_operator_symbols}{>}ebrk) \textcolor{fortran_keywordflow}{then}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00130}00130                 \textcolor{fortran_comment}{! add the remaining part of the photonFluence from the high-\/energy component}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00131}00131                 betaPlusOne\textcolor{fortran_operator_symbols}{ = }beta\textcolor{fortran_operator_symbols}{ + }\textcolor{fortran_numeric_literal}{1.\_RK}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00132}00132                 alphaMinusBeta\textcolor{fortran_operator_symbols}{ = }alpha\textcolor{fortran_operator_symbols}{ -\/ }beta}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00133}00133                 coef\textcolor{fortran_operator_symbols}{ = }ebrk\textcolor{fortran_operator_symbols}{*}\textcolor{fortran_operator_symbols}{*}alphaMinusBeta\textcolor{fortran_operator_symbols}{ * }\textcolor{fortran_function}{exp}(\textcolor{fortran_operator_symbols}{-\/}alphaMinusBeta);}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00134}00134                 photonFluence\textcolor{fortran_operator_symbols}{ = }photonFluence\textcolor{fortran_operator_symbols}{ + }coef\textcolor{fortran_operator_symbols}{ * }( upperLim\textcolor{fortran_operator_symbols}{*}\textcolor{fortran_operator_symbols}{*}betaPlusOne\textcolor{fortran_operator_symbols}{ -\/ }ebrk\textcolor{fortran_operator_symbols}{*}\textcolor{fortran_operator_symbols}{*}betaPlusOne )\textcolor{fortran_operator_symbols}{ / }betaPlusOne}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00135}00135 \textcolor{fortran_statement}{                return}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00136}00136 \textcolor{fortran_keywordflow}{            end if}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00137}00137 }
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00138}00138 \textcolor{fortran_keywordflow}{        end if}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00139}00139 }
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00140}00140     \textcolor{fortran_statement}{end subroutine }getPhotonFluence}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00141}00141 }
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00142}00142 \textcolor{fortran_comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00143}00143 }
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00144}00144 \textcolor{fortran_attribute}{    pure}\textcolor{fortran_statement}{ function} getBandCompLowPhoton(energy)\textcolor{fortran_statement}{ result}(bandCompLow)}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00145}00145 \textcolor{preprocessor}{\#if INTEL\_COMPILER\_ENABLED \&\& DLL\_ENABLED \&\& (WINDOWS\_ENABLED || DARWIN\_ENABLED)}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00146}00146 \textcolor{preprocessor}{}\textcolor{fortran_directive_intel}{        !DEC\$ ATTRIBUTES DLLEXPORT }:: getBandCompLowPhoton}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00147}00147 \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00148}00148 \textcolor{preprocessor}{}        \textcolor{fortran_statement}{implicit none}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00149}00149 \textcolor{fortran_statement}{        real}(RK),\textcolor{fortran_attribute}{ intent(in)}    :: energy}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00150}00150 \textcolor{fortran_statement}{        real}(RK)                :: bandCompLow}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00151}00151         bandCompLow\textcolor{fortran_operator_symbols}{ = }energy\textcolor{fortran_operator_symbols}{*}\textcolor{fortran_operator_symbols}{*}mv\_alpha\textcolor{fortran_operator_symbols}{ * }\textcolor{fortran_function}{exp}(\textcolor{fortran_operator_symbols}{-\/}mv\_alphaPlusTwoOverEpk\textcolor{fortran_operator_symbols}{*}energy)}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00152}00152     \textcolor{fortran_statement}{end function }getBandCompLowPhoton}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00153}00153 }
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00154}00154 \textcolor{fortran_comment}{!\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%\%}}
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00155}00155 }
\DoxyCodeLine{\Hypertarget{BandSpectrum__mod_0dPhotonFluence__smod_8f90_source_l00156}00156 \textcolor{fortran_statement}{end submodule} PhotonFluence\_smod ! LCOV\_EXCL\_LINE}

\end{DoxyCode}
