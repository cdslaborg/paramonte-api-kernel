\hypertarget{namespacematrix__mod}{}\doxysection{matrix\+\_\+mod Module Reference}
\label{namespacematrix__mod}\index{matrix\_mod@{matrix\_mod}}


This module contains mathematical procedures.  


\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
pure real(rk) function, dimension(n, m) \mbox{\hyperlink{namespacematrix__mod_a4c64c8131a142c7d91e6490c407a5d7a}{geteye}} (n, m, diag)
\begin{DoxyCompactList}\small\item\em Return the an eye matrix of rank (nd, md). \end{DoxyCompactList}\item 
pure subroutine \mbox{\hyperlink{namespacematrix__mod_a36785a7834c11cfd985f34441c06af66}{getcholeskyfactor}} (nd, Pos\+Def\+Mat, Diagonal)
\begin{DoxyCompactList}\small\item\em Return the Cholesky factorization of the input positive-\/definite matrix. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacematrix__mod_a393c400caa093b0ac68a0ff1cb0fd897}{solvelinearposdefsystem}} (nd, Pos\+Def\+Mat, Diagonal, Intercept, Input\+Solution)
\begin{DoxyCompactList}\small\item\em Solve the linear equation system of the form\+: $ \texttt{PosDefMat} \times \texttt{InputSolution} = \texttt{Intercept} $. \end{DoxyCompactList}\item 
pure subroutine \mbox{\hyperlink{namespacematrix__mod_a390563b2761c2e0cca18a38562bacf1c}{getinvposdefmatsqrtdet}} (nd, Mat\+Inv\+Mat, sqrt\+Det\+Inv\+Pos\+Def\+Mat)
\begin{DoxyCompactList}\small\item\em Return the inverse matrix of a symmetric-\/positive-\/definite input matrix, which is given in the upper triangle of {\ttfamily Mat\+Inv\+Mat}. On output {\ttfamily Mat\+Inv\+Mat} is completely overwritten by in the inverse of the matrix. Also, return the square root of determinant of the inverse matrix. \end{DoxyCompactList}\item 
pure real(rk) function, dimension(nd, nd) \mbox{\hyperlink{namespacematrix__mod_a6ce4c18b0f3d6884eea067863454bf01}{getinvmatfromcholfac}} (nd, Cholesky\+Lower, Diagonal)
\begin{DoxyCompactList}\small\item\em Return the inverse matrix of a symmetric-\/positive-\/definite matrix, whose Cholesky Lower triangle is given in the lower part of {\ttfamily Cholesky\+Lower} and and its diagonal elements in {\ttfamily Diagonal}. \end{DoxyCompactList}\item 
pure real(rk) function, dimension(nd, nd) \mbox{\hyperlink{namespacematrix__mod_a541fac75a210dc71c90db6a780a7b43f}{getinvposdefmat}} (nd, Pos\+Def\+Mat)
\begin{DoxyCompactList}\small\item\em Return the inverse matrix of an input symmetric-\/positive-\/definite matrix {\ttfamily Pos\+Def\+Mat}. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacematrix__mod_a1921f30635922255128477323ca5ce09}{getinvmatdet}} (nd, Matrix\+LU, Inverse\+Matrix, det\+Inv\+Mat)
\begin{DoxyCompactList}\small\item\em Return the inverse matrix {\ttfamily Inverse\+Matrix} of a {\ttfamily nd$\ast$nd} input matrix {\ttfamily Matrix\+LU}, and its determinant, using {\ttfamily LU} decomposition. \end{DoxyCompactList}\item 
real(rk) function, dimension(nd, nd) \mbox{\hyperlink{namespacematrix__mod_a1d61a8419f2d94806039bb0d08a47a9e}{getinvmat}} (nd, Matrix)
\begin{DoxyCompactList}\small\item\em Return the inverse matrix {\ttfamily Inverse\+Matrix} of a {\ttfamily nd$\ast$nd} input matrix {\ttfamily Matrix}, and its determinant, using {\ttfamily LU} decomposition. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacematrix__mod_a54dd076c547a8b6e1f81b3244887e874}{solvelinearsystem}} (nd, LU, Permutation, Input\+Solution)
\begin{DoxyCompactList}\small\item\em Solve the set of {\ttfamily nd} linear equations {\ttfamily Matrix $\ast$ X = Input\+Solution}. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacematrix__mod_af380500b6eb16435797ee030edfd563a}{getlu}} (nd, Matrix\+LU, Permutation, parity)
\begin{DoxyCompactList}\small\item\em Return the LU decomposition of the input matrix {\ttfamily Matrix\+L\+U(nd,nd)}. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacematrix__mod_aff8808812389fce984da322f8c2c07f0}{multiplymatrix}} (A, rowsA, colsA, B, rowsB, colsB, C)
\begin{DoxyCompactList}\small\item\em Return the product of two matrices. The product of two matrices is defined by {\ttfamily c(i,j) = a(i,1)$\ast$b(1,j) + a(i,2)$\ast$b(2,j) + ... + a(i,n)$\ast$b(n,j)}. \end{DoxyCompactList}\item 
real(rk) function \mbox{\hyperlink{namespacematrix__mod_a99644ca2cc3b30be2f7363418803b020}{getdeterminant}} (nd, Matrix)
\begin{DoxyCompactList}\small\item\em Return the determinant of a given {\ttfamily nd $\ast$ nd} matrix via LU factorization. \end{DoxyCompactList}\item 
real(rk) function \mbox{\hyperlink{namespacematrix__mod_a869c72bec5850343289680a09254d847}{getsqrtdetposdefmat}} (nd, Pos\+Def\+Mat)
\begin{DoxyCompactList}\small\item\em Return the square root of the determinant of a given positive-\/definite {\ttfamily nd $\ast$ nd} matrix {\ttfamily Pos\+Def\+Mat} using Cholesky factorization. \end{DoxyCompactList}\item 
pure subroutine \mbox{\hyperlink{namespacematrix__mod_a5cd2528603954515769766dc47b6c0da}{getlogsqrtdetposdefmat}} (nd, Pos\+Def\+Mat, log\+Sqrt\+Det\+Pos\+Def\+Mat, failed)
\begin{DoxyCompactList}\small\item\em Return the natural logarithm of the square root of the determinant of a given positive-\/definite {\ttfamily nd $\ast$ nd} matrix {\ttfamily Pos\+Def\+Mat} using Cholesky factorization. \end{DoxyCompactList}\item 
pure logical function \mbox{\hyperlink{namespacematrix__mod_a4457ce676fff3d9e4089018b06ca00fe}{isposdef}} (nd, Matrix)
\begin{DoxyCompactList}\small\item\em Return {\ttfamily .false.} value for {\ttfamily is\+Pos\+Def}, if the Cholesky decomposition of the input matrix fails (i.\+e. matrix is not positive definite), otherwise return {\ttfamily .true.}. \end{DoxyCompactList}\item 
pure real(rk) function, dimension(size(vector1), size(vector2)) \mbox{\hyperlink{namespacematrix__mod_a7ecd812425b1fbacb8c04183ffba8b71}{getouterprod}} (Vector1, Vector2)
\begin{DoxyCompactList}\small\item\em Return the outer product of the two input matrices. \end{DoxyCompactList}\item 
pure real(rk) function, dimension(rank, rank) \mbox{\hyperlink{namespacematrix__mod_a73f946edb5219bbf949954e9c567af3a}{sortposdefmat}} (rank, Pos\+Def\+Mat\+Upper, len\+Col\+Indx, Col\+Indx, Col\+Indx\+Map)
\begin{DoxyCompactList}\small\item\em Return an ordered matrix of the input matrix by rearranging the columns corresponding to {\ttfamily Col\+Indx} to into the corresponding columns in {\ttfamily Col\+Indx\+Map}, while keeping the rest of the matrix structure intact, such that if it is positive-\/definite, it remains positive-\/definite. For example,. \end{DoxyCompactList}\item 
pure subroutine \mbox{\hyperlink{namespacematrix__mod_aaa2f76d9a5c874ca4fbb4a949dd1ff11}{symmetrizeuppersquarematrix}} (nd, Upper\+Square\+Matrix)
\begin{DoxyCompactList}\small\item\em Symmetrize an input upper-\/triangular matrix by copying the upper to the lower triangle. \end{DoxyCompactList}\item 
pure subroutine \mbox{\hyperlink{namespacematrix__mod_a63aed0b5f6d5289f3f7183cffb1435cd}{getregrescoef}} (rank\+P\+DM, rank\+S11, rank\+S22, Pos\+Def\+Mat, Regres\+Coef\+Mat, Schur\+Complement)
\begin{DoxyCompactList}\small\item\em Return the the Regression Coefficient Matrix, whose dimension is {\ttfamily rank\+S11} by {\ttfamily rank\+S22}, as well as optionally the Schur complement of the {\ttfamily S22} block of rank {\ttfamily rank\+S22} of the input matrix {\ttfamily Pos\+Def\+Mat} of rank {\ttfamily rank\+P\+DM}. For example, if,. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
character($\ast$), parameter \mbox{\hyperlink{namespacematrix__mod_a88f13a51a9eadeda90dcade7949a6b8b}{module\+\_\+name}} = \char`\"{}@Matrix\+\_\+mod\char`\"{}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
This module contains mathematical procedures. 

\begin{DoxyAuthor}{Author}
Amir Shahmoradi 
\end{DoxyAuthor}


\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacematrix__mod_a36785a7834c11cfd985f34441c06af66}\label{namespacematrix__mod_a36785a7834c11cfd985f34441c06af66}} 
\index{matrix\_mod@{matrix\_mod}!getcholeskyfactor@{getcholeskyfactor}}
\index{getcholeskyfactor@{getcholeskyfactor}!matrix\_mod@{matrix\_mod}}
\doxysubsubsection{\texorpdfstring{getcholeskyfactor()}{getcholeskyfactor()}}
{\footnotesize\ttfamily pure subroutine matrix\+\_\+mod\+::getcholeskyfactor (\begin{DoxyParamCaption}\item[{integer(ik), intent(in)}]{nd,  }\item[{real(rk), dimension(nd,nd), intent(inout)}]{Pos\+Def\+Mat,  }\item[{real(rk), dimension(nd), intent(out)}]{Diagonal }\end{DoxyParamCaption})}



Return the Cholesky factorization of the input positive-\/definite matrix. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em nd} & \+: The size of the input square matrix -\/ {\ttfamily nd} by {\ttfamily nd}. \\
\hline
\mbox{\texttt{ in,out}}  & {\em Pos\+Def\+Mat} & \+: The input square matrix. \\
\hline
\mbox{\texttt{ out}}  & {\em Diagonal} & \+: The Diagonal elements of the Cholesky factorization.\\
\hline
\end{DoxyParams}
\begin{DoxyRemark}{Remarks}
If {\ttfamily nd = 1}, {\ttfamily Pos\+Def\+Mat} will not be touched, only {\ttfamily sqrt(\+Pos\+Def\+Mat)} will be output to {\ttfamily Diagonal}.
\end{DoxyRemark}
\begin{DoxyWarning}{Warning}
If Cholesky factorization fails, {\ttfamily Diagonal(1)} will be set to {\ttfamily -\/1} to indicate error on return.
\end{DoxyWarning}
Returns in the lower triangle of {\ttfamily Pos\+Def\+Mat}, the Cholesky factorization L of $\texttt{PosDefMat} = L.L^T$. On input, the upper upper triangle of {\ttfamily Pos\+Def\+Mat} should be given, which remains intact on output. 

Definition at line 107 of file Matrix\+\_\+mod.\+f90.

\mbox{\Hypertarget{namespacematrix__mod_a99644ca2cc3b30be2f7363418803b020}\label{namespacematrix__mod_a99644ca2cc3b30be2f7363418803b020}} 
\index{matrix\_mod@{matrix\_mod}!getdeterminant@{getdeterminant}}
\index{getdeterminant@{getdeterminant}!matrix\_mod@{matrix\_mod}}
\doxysubsubsection{\texorpdfstring{getdeterminant()}{getdeterminant()}}
{\footnotesize\ttfamily real(rk) function matrix\+\_\+mod\+::getdeterminant (\begin{DoxyParamCaption}\item[{integer(ik), intent(in)}]{nd,  }\item[{real(rk), dimension(nd,nd), intent(in)}]{Matrix }\end{DoxyParamCaption})}



Return the determinant of a given {\ttfamily nd $\ast$ nd} matrix via LU factorization. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em nd} & \+: The size of the square matrix -\/ {\ttfamily nd} by {\ttfamily nd}. \\
\hline
\mbox{\texttt{ in}}  & {\em Matrix} & \+: The input matrix.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
{\ttfamily determinant} \+: The determinant of the matrix.
\end{DoxyReturn}
\begin{DoxyAuthor}{Author}
Amir Shahmoradi, Oct 18, 2009, 4\+:10 PM, M\+TU 
\end{DoxyAuthor}


Definition at line 648 of file Matrix\+\_\+mod.\+f90.

\mbox{\Hypertarget{namespacematrix__mod_a4c64c8131a142c7d91e6490c407a5d7a}\label{namespacematrix__mod_a4c64c8131a142c7d91e6490c407a5d7a}} 
\index{matrix\_mod@{matrix\_mod}!geteye@{geteye}}
\index{geteye@{geteye}!matrix\_mod@{matrix\_mod}}
\doxysubsubsection{\texorpdfstring{geteye()}{geteye()}}
{\footnotesize\ttfamily pure real(rk) function, dimension(n,m) matrix\+\_\+mod\+::geteye (\begin{DoxyParamCaption}\item[{integer(ik), intent(in)}]{n,  }\item[{integer(ik), intent(in)}]{m,  }\item[{real(rk), intent(in), optional}]{diag }\end{DoxyParamCaption})}



Return the an eye matrix of rank (nd, md). 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em n} & \+: The number of rows of the eye matrix. \\
\hline
\mbox{\texttt{ in}}  & {\em m} & \+: The number of columns of the eye matrix. \\
\hline
\mbox{\texttt{ in}}  & {\em diag} & \+: The value to appear on the diagonal elements of the output eye matrix ({\bfseries{optional}}, default = {\ttfamily 1.}).\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
{\ttfamily eye} \+: A matrix of rank n $\ast$ m whose diagonal elements are set to the input {\ttfamily diag} value or, if not provided, to {\ttfamily 1.}. 
\end{DoxyReturn}


Definition at line 67 of file Matrix\+\_\+mod.\+f90.

\mbox{\Hypertarget{namespacematrix__mod_a1d61a8419f2d94806039bb0d08a47a9e}\label{namespacematrix__mod_a1d61a8419f2d94806039bb0d08a47a9e}} 
\index{matrix\_mod@{matrix\_mod}!getinvmat@{getinvmat}}
\index{getinvmat@{getinvmat}!matrix\_mod@{matrix\_mod}}
\doxysubsubsection{\texorpdfstring{getinvmat()}{getinvmat()}}
{\footnotesize\ttfamily real(rk) function, dimension(nd,nd) matrix\+\_\+mod\+::getinvmat (\begin{DoxyParamCaption}\item[{integer(ik), intent(in)}]{nd,  }\item[{real(rk), dimension(nd,nd), intent(in)}]{Matrix }\end{DoxyParamCaption})}



Return the inverse matrix {\ttfamily Inverse\+Matrix} of a {\ttfamily nd$\ast$nd} input matrix {\ttfamily Matrix}, and its determinant, using {\ttfamily LU} decomposition. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em nd} & \+: The size of the square matrix and its {\ttfamily LU} decomposition -\/ {\ttfamily nd} by {\ttfamily nd}. \\
\hline
\mbox{\texttt{ in,out}}  & {\em Matrix} & \+: The target symmetric-\/positive-\/definite matrix.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
{\ttfamily Inverse\+Matrix} \+: The full inverse matrix.
\end{DoxyReturn}
\begin{DoxyRemark}{Remarks}
This routine has the same functionality as the subroutine \mbox{\hyperlink{namespacematrix__mod_a1921f30635922255128477323ca5ce09}{get\+Inv\+Mat\+Det()}}, but returns the result as a function output. According to the timing tests, {\ttfamily compare\+\_\+\+Inv\+Mat\+Routines\+\_\+1()}, this function version appears to be 15-\/30\% faster than the subroutine equivalent \mbox{\hyperlink{namespacematrix__mod_a1921f30635922255128477323ca5ce09}{get\+Inv\+Mat\+Det()}}.
\end{DoxyRemark}
\begin{DoxyAuthor}{Author}
Amir Shahmoradi, Apr 8, 2017, 1\+:54 PM, M\+TU 
\end{DoxyAuthor}


Definition at line 425 of file Matrix\+\_\+mod.\+f90.

\mbox{\Hypertarget{namespacematrix__mod_a1921f30635922255128477323ca5ce09}\label{namespacematrix__mod_a1921f30635922255128477323ca5ce09}} 
\index{matrix\_mod@{matrix\_mod}!getinvmatdet@{getinvmatdet}}
\index{getinvmatdet@{getinvmatdet}!matrix\_mod@{matrix\_mod}}
\doxysubsubsection{\texorpdfstring{getinvmatdet()}{getinvmatdet()}}
{\footnotesize\ttfamily subroutine matrix\+\_\+mod\+::getinvmatdet (\begin{DoxyParamCaption}\item[{integer(ik), intent(in)}]{nd,  }\item[{real(rk), dimension(nd,nd), intent(inout)}]{Matrix\+LU,  }\item[{real(rk), dimension(nd,nd), intent(out)}]{Inverse\+Matrix,  }\item[{real(rk), intent(out)}]{det\+Inv\+Mat }\end{DoxyParamCaption})}



Return the inverse matrix {\ttfamily Inverse\+Matrix} of a {\ttfamily nd$\ast$nd} input matrix {\ttfamily Matrix\+LU}, and its determinant, using {\ttfamily LU} decomposition. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em nd} & \+: The size of the square matrix and its {\ttfamily LU} decomposition -\/ {\ttfamily nd} by {\ttfamily nd}. \\
\hline
\mbox{\texttt{ in,out}}  & {\em Matrix\+LU} & \+: The target symmetric-\/positive-\/definite matrix. On input it is the matrix, on output it is the LU decomposition. \\
\hline
\mbox{\texttt{ out}}  & {\em Inverse\+Matrix} & \+: The input symmetric-\/positive-\/definite matrix. \\
\hline
\mbox{\texttt{ out}}  & {\em det\+Inv\+Mat} & \+: The determinant of the inverse of the symmetric-\/positive-\/definite matrix.\\
\hline
\end{DoxyParams}
\begin{DoxyWarning}{Warning}
Do not call this routine when {\ttfamily nd = 1}. For {\ttfamily nd = 1}\+: {\ttfamily Inverse\+Matrix = det\+Inv\+Mat = 1.\+\_\+\+RK / Inverse\+Matrix}.
\end{DoxyWarning}
\begin{DoxyRemark}{Remarks}
This routine has the same functionality as the function \mbox{\hyperlink{namespacematrix__mod_a1d61a8419f2d94806039bb0d08a47a9e}{get\+Inv\+Mat()}}, but returns the result as a function output. According to the timing tests, {\ttfamily compare\+\_\+\+Inv\+Mat\+Routines\+\_\+1()}, the function version of this code \mbox{\hyperlink{namespacematrix__mod_a1d61a8419f2d94806039bb0d08a47a9e}{get\+Inv\+Mat()}} appears to be 15-\/30\% faster than this subroutine version.
\end{DoxyRemark}
\begin{DoxyAuthor}{Author}
Amir Shahmoradi, Oct 18, 2009, 1\+:54 AM, M\+TU 
\end{DoxyAuthor}


Definition at line 381 of file Matrix\+\_\+mod.\+f90.

\mbox{\Hypertarget{namespacematrix__mod_a6ce4c18b0f3d6884eea067863454bf01}\label{namespacematrix__mod_a6ce4c18b0f3d6884eea067863454bf01}} 
\index{matrix\_mod@{matrix\_mod}!getinvmatfromcholfac@{getinvmatfromcholfac}}
\index{getinvmatfromcholfac@{getinvmatfromcholfac}!matrix\_mod@{matrix\_mod}}
\doxysubsubsection{\texorpdfstring{getinvmatfromcholfac()}{getinvmatfromcholfac()}}
{\footnotesize\ttfamily pure real(rk) function, dimension(nd,nd) matrix\+\_\+mod\+::getinvmatfromcholfac (\begin{DoxyParamCaption}\item[{integer(ik), intent(in)}]{nd,  }\item[{real(rk), dimension(nd,nd), intent(in)}]{Cholesky\+Lower,  }\item[{real(rk), dimension(nd), intent(in)}]{Diagonal }\end{DoxyParamCaption})}



Return the inverse matrix of a symmetric-\/positive-\/definite matrix, whose Cholesky Lower triangle is given in the lower part of {\ttfamily Cholesky\+Lower} and and its diagonal elements in {\ttfamily Diagonal}. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em nd} & \+: The size of the input square matrix -\/ {\ttfamily nd} by {\ttfamily nd}. \\
\hline
\mbox{\texttt{ in}}  & {\em Cholesky\+Lower} & \+: The Cholesky factorization of the matrix. \\
\hline
\mbox{\texttt{ in}}  & {\em Diagonal} & \+: The diagonal elements of the Cholesky factorization of the matrix.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
{\ttfamily Inv\+Mat\+From\+Chol\+Fac} \+: The full inverse matrix.
\end{DoxyReturn}
\begin{DoxyWarning}{Warning}
Do not call this routine when {\ttfamily nd = 1}. For {\ttfamily nd = 1}\+: {\ttfamily Inv\+Mat\+From\+Chol\+Fac = 1.\+\_\+\+RK / Diagonal(1)$^\wedge$2}.
\end{DoxyWarning}
\begin{DoxyAuthor}{Author}
Amir Shahmoradi, Apr 21, 2017, 1\+:54 AM, I\+C\+ES, UT Austin 
\end{DoxyAuthor}


Definition at line 247 of file Matrix\+\_\+mod.\+f90.

\mbox{\Hypertarget{namespacematrix__mod_a541fac75a210dc71c90db6a780a7b43f}\label{namespacematrix__mod_a541fac75a210dc71c90db6a780a7b43f}} 
\index{matrix\_mod@{matrix\_mod}!getinvposdefmat@{getinvposdefmat}}
\index{getinvposdefmat@{getinvposdefmat}!matrix\_mod@{matrix\_mod}}
\doxysubsubsection{\texorpdfstring{getinvposdefmat()}{getinvposdefmat()}}
{\footnotesize\ttfamily pure real(rk) function, dimension(nd,nd) matrix\+\_\+mod\+::getinvposdefmat (\begin{DoxyParamCaption}\item[{integer(ik), intent(in)}]{nd,  }\item[{real(rk), dimension(nd,nd), intent(in)}]{Pos\+Def\+Mat }\end{DoxyParamCaption})}



Return the inverse matrix of an input symmetric-\/positive-\/definite matrix {\ttfamily Pos\+Def\+Mat}. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em nd} & \+: The size of the input square matrix -\/ {\ttfamily nd} by {\ttfamily nd}. \\
\hline
\mbox{\texttt{ in}}  & {\em Pos\+Def\+Mat} & \+: The input symmetric-\/positive-\/definite matrix.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
{\ttfamily Inv\+Pos\+Def\+Mat} \+: The full inverse matrix.
\end{DoxyReturn}
\begin{DoxyWarning}{Warning}
If the input matrix is not positive definite, the function will return with {\ttfamily Inv\+Pos\+Def\+Mat(1,1) = -\/1.\+\_\+\+RK} to indicate the occurrence of an error. This is done to preserve the purity of the function.

Do not call this routine when {\ttfamily nd = 1}. For {\ttfamily nd = 1}\+: {\ttfamily Inv\+Pos\+Def\+Mat = 1.\+\_\+\+RK / Inv\+Pos\+Def\+Mat}.
\end{DoxyWarning}
\begin{DoxyRemark}{Remarks}
On input, only the upper half of {\ttfamily Pos\+Def\+Mat} needs to be given.

This routine has the same functionality as the subroutine \mbox{\hyperlink{namespacematrix__mod_a390563b2761c2e0cca18a38562bacf1c}{get\+Inv\+Pos\+Def\+Mat\+Sqrt\+Det()}}, but returns the result as a function output. According to the timing tests, {\ttfamily compare\+\_\+\+Inv\+Mat\+Routines\+\_\+1()}, the function version appears to be 15-\/30\% faster than the subroutine version \mbox{\hyperlink{namespacematrix__mod_a390563b2761c2e0cca18a38562bacf1c}{get\+Inv\+Pos\+Def\+Mat\+Sqrt\+Det()}}.
\end{DoxyRemark}
\begin{DoxyAuthor}{Author}
Amir Shahmoradi, Apr 21, 2017, 1\+:54 AM, I\+C\+ES, UT Austin 
\end{DoxyAuthor}


Definition at line 316 of file Matrix\+\_\+mod.\+f90.

\mbox{\Hypertarget{namespacematrix__mod_a390563b2761c2e0cca18a38562bacf1c}\label{namespacematrix__mod_a390563b2761c2e0cca18a38562bacf1c}} 
\index{matrix\_mod@{matrix\_mod}!getinvposdefmatsqrtdet@{getinvposdefmatsqrtdet}}
\index{getinvposdefmatsqrtdet@{getinvposdefmatsqrtdet}!matrix\_mod@{matrix\_mod}}
\doxysubsubsection{\texorpdfstring{getinvposdefmatsqrtdet()}{getinvposdefmatsqrtdet()}}
{\footnotesize\ttfamily pure subroutine matrix\+\_\+mod\+::getinvposdefmatsqrtdet (\begin{DoxyParamCaption}\item[{integer(ik), intent(in)}]{nd,  }\item[{real(rk), dimension(nd,nd), intent(inout)}]{Mat\+Inv\+Mat,  }\item[{real(rk), intent(out)}]{sqrt\+Det\+Inv\+Pos\+Def\+Mat }\end{DoxyParamCaption})}



Return the inverse matrix of a symmetric-\/positive-\/definite input matrix, which is given in the upper triangle of {\ttfamily Mat\+Inv\+Mat}. On output {\ttfamily Mat\+Inv\+Mat} is completely overwritten by in the inverse of the matrix. Also, return the square root of determinant of the inverse matrix. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em nd} & \+: The size of the input square matrix -\/ {\ttfamily nd} by {\ttfamily nd}. \\
\hline
\mbox{\texttt{ in,out}}  & {\em Mat\+Inv\+Mat} & \+: The input square matrix. On input, the upper half must be covariance matrix. On output, it is completely overwritten by the inverse matrix. \\
\hline
\mbox{\texttt{ out}}  & {\em sqrt\+Det\+Inv\+Pos\+Def\+Mat} & \+: The square root of the determinant of the inverse matrix.\\
\hline
\end{DoxyParams}
\begin{DoxyWarning}{Warning}
Do not call this routine when {\ttfamily nd = 1}. There is no need to call this routine when {\ttfamily nd = 1}.

If the input matrix is not positive-\/definite, the output {\ttfamily sqrt\+Det\+Inv\+Pos\+Def\+Mat} will be set to {\ttfamily -\/1} on return to indicate the occurrence of an error.
\end{DoxyWarning}
\begin{DoxyAuthor}{Author}
Amir Shahmoradi, Apr 21, 2017, 1\+:54 AM, I\+C\+ES, UT Austin 
\end{DoxyAuthor}


Definition at line 182 of file Matrix\+\_\+mod.\+f90.

\mbox{\Hypertarget{namespacematrix__mod_a5cd2528603954515769766dc47b6c0da}\label{namespacematrix__mod_a5cd2528603954515769766dc47b6c0da}} 
\index{matrix\_mod@{matrix\_mod}!getlogsqrtdetposdefmat@{getlogsqrtdetposdefmat}}
\index{getlogsqrtdetposdefmat@{getlogsqrtdetposdefmat}!matrix\_mod@{matrix\_mod}}
\doxysubsubsection{\texorpdfstring{getlogsqrtdetposdefmat()}{getlogsqrtdetposdefmat()}}
{\footnotesize\ttfamily pure subroutine matrix\+\_\+mod\+::getlogsqrtdetposdefmat (\begin{DoxyParamCaption}\item[{integer(ik), intent(in)}]{nd,  }\item[{real(rk), dimension(nd,nd), intent(inout)}]{Pos\+Def\+Mat,  }\item[{real(rk), intent(out)}]{log\+Sqrt\+Det\+Pos\+Def\+Mat,  }\item[{logical, intent(out)}]{failed }\end{DoxyParamCaption})}



Return the natural logarithm of the square root of the determinant of a given positive-\/definite {\ttfamily nd $\ast$ nd} matrix {\ttfamily Pos\+Def\+Mat} using Cholesky factorization. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em nd} & \+: The size of the square matrix -\/ {\ttfamily nd} by {\ttfamily nd}. \\
\hline
\mbox{\texttt{ in,out}}  & {\em Pos\+Def\+Mat} & \+: The input matrix. On input, the upper triangle should be given, which remains intact on output. \\
\hline
\mbox{\texttt{ out}}  & {\em log\+Sqrt\+Det\+Pos\+Def\+Mat} & \+: The natural logarithm of the square root of the determinant of {\ttfamily Pos\+Def\+Mat}. \\
\hline
\mbox{\texttt{ out}}  & {\em failed} & \+: A logical value. If {\ttfamily .true.}, the determinant computation has failed.\\
\hline
\end{DoxyParams}
\begin{DoxyAuthor}{Author}
Amir Shahmoradi, Apr 21, 2017, 4\+:10 PM, I\+C\+ES, UT 
\end{DoxyAuthor}


Definition at line 719 of file Matrix\+\_\+mod.\+f90.

\mbox{\Hypertarget{namespacematrix__mod_af380500b6eb16435797ee030edfd563a}\label{namespacematrix__mod_af380500b6eb16435797ee030edfd563a}} 
\index{matrix\_mod@{matrix\_mod}!getlu@{getlu}}
\index{getlu@{getlu}!matrix\_mod@{matrix\_mod}}
\doxysubsubsection{\texorpdfstring{getlu()}{getlu()}}
{\footnotesize\ttfamily subroutine matrix\+\_\+mod\+::getlu (\begin{DoxyParamCaption}\item[{integer(ik), intent(in)}]{nd,  }\item[{real(rk), dimension(nd,nd), intent(inout)}]{Matrix\+LU,  }\item[{integer(ik), dimension(nd), intent(out)}]{Permutation,  }\item[{real(rk), intent(out)}]{parity }\end{DoxyParamCaption})}



Return the LU decomposition of the input matrix {\ttfamily Matrix\+L\+U(nd,nd)}. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em nd} & \+: The size of the square matrix and its {\ttfamily LU} decomposition -\/ {\ttfamily nd} by {\ttfamily nd}. \\
\hline
\mbox{\texttt{ in,out}}  & {\em Matrix\+LU} & \+: The input matrix. On output, it is completely overwritten by its LU decomposition. \\
\hline
\mbox{\texttt{ out}}  & {\em Permutation} & \+: An output vector of length {\ttfamily nd} that records the row permutation effected by the partial pivoting. \\
\hline
\mbox{\texttt{ out}}  & {\em Parity} & \+: An output real as {\ttfamily +-\/1} depending on whether the number of row interchanges was even or odd, respectively.\\
\hline
\end{DoxyParams}
\begin{DoxyRemark}{Remarks}
This routine is used in combination with \mbox{\hyperlink{namespacematrix__mod_a54dd076c547a8b6e1f81b3244887e874}{solve\+Linear\+System}} to solve linear equations or invert a matrix.
\end{DoxyRemark}
\begin{DoxyAuthor}{Author}
Amir Shahmoradi, Apr 21, 2017, 1\+:43 PM, I\+C\+ES, UT Austin 
\end{DoxyAuthor}


Definition at line 512 of file Matrix\+\_\+mod.\+f90.

\mbox{\Hypertarget{namespacematrix__mod_a7ecd812425b1fbacb8c04183ffba8b71}\label{namespacematrix__mod_a7ecd812425b1fbacb8c04183ffba8b71}} 
\index{matrix\_mod@{matrix\_mod}!getouterprod@{getouterprod}}
\index{getouterprod@{getouterprod}!matrix\_mod@{matrix\_mod}}
\doxysubsubsection{\texorpdfstring{getouterprod()}{getouterprod()}}
{\footnotesize\ttfamily pure real(rk) function, dimension(size(vector1), size(vector2)) matrix\+\_\+mod\+::getouterprod (\begin{DoxyParamCaption}\item[{real(rk), dimension(\+:), intent(in)}]{Vector1,  }\item[{real(rk), dimension(\+:), intent(in)}]{Vector2 }\end{DoxyParamCaption})}



Return the outer product of the two input matrices. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em Vector1} & \+: The first input vector. \\
\hline
\mbox{\texttt{ in}}  & {\em Vector2} & \+: The second input vector.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
{\ttfamily Outer\+Prod} \+: A matrix of size {\ttfamily ( size(\+Vector1), size(\+Vector2) )}.
\end{DoxyReturn}
\begin{DoxyAuthor}{Author}
Amir Shahmoradi, Apr 21, 2017, 4\+:10 PM, I\+C\+ES, UT 
\end{DoxyAuthor}


Definition at line 806 of file Matrix\+\_\+mod.\+f90.

\mbox{\Hypertarget{namespacematrix__mod_a63aed0b5f6d5289f3f7183cffb1435cd}\label{namespacematrix__mod_a63aed0b5f6d5289f3f7183cffb1435cd}} 
\index{matrix\_mod@{matrix\_mod}!getregrescoef@{getregrescoef}}
\index{getregrescoef@{getregrescoef}!matrix\_mod@{matrix\_mod}}
\doxysubsubsection{\texorpdfstring{getregrescoef()}{getregrescoef()}}
{\footnotesize\ttfamily pure subroutine matrix\+\_\+mod\+::getregrescoef (\begin{DoxyParamCaption}\item[{integer(ik), intent(in)}]{rank\+P\+DM,  }\item[{integer(ik), intent(in)}]{rank\+S11,  }\item[{integer(ik), intent(in)}]{rank\+S22,  }\item[{real(rk), dimension(rankpdm,rankpdm), intent(in)}]{Pos\+Def\+Mat,  }\item[{real(rk), dimension(ranks11,ranks22), intent(out)}]{Regres\+Coef\+Mat,  }\item[{real(rk), dimension(ranks11,ranks11), intent(out), optional}]{Schur\+Complement }\end{DoxyParamCaption})}



Return the the Regression Coefficient Matrix, whose dimension is {\ttfamily rank\+S11} by {\ttfamily rank\+S22}, as well as optionally the Schur complement of the {\ttfamily S22} block of rank {\ttfamily rank\+S22} of the input matrix {\ttfamily Pos\+Def\+Mat} of rank {\ttfamily rank\+P\+DM}. For example, if,. 

\begin{equation} \texttt{PosDefMat} = \begin{pmatrix} S11 & S12 \\ S21 & S22 \end{pmatrix} \end{equation} then, the Regression Coefficient Matrix given {\ttfamily S22} is\+: $ S12 \times S22^{-1} $, whose rank is {\ttfamily rank\+S11} by {\ttfamily rank\+S22}. The Schur complement of {\ttfamily S22} is\+: \begin{equation} \texttt{SchurComplement} = S11 - S12 \times S22^{-1} \times S21 ~, \end{equation} whose rank is {\ttfamily rank\+S11} by {\ttfamily rank\+S11}.

\begin{DoxyWarning}{Warning}
On input, the full matrix Pos\+Def\+Mat must be given.
\end{DoxyWarning}
\begin{DoxyRemark}{Remarks}
For clarity, note that {\ttfamily rank\+S11 + rank\+S22 = rank\+P\+DM}.
\end{DoxyRemark}
\begin{DoxyAuthor}{Author}
Amir Shahmoradi, Apr 21, 2017, 4\+:10 PM, I\+C\+ES, UT 
\end{DoxyAuthor}


Definition at line 939 of file Matrix\+\_\+mod.\+f90.

\mbox{\Hypertarget{namespacematrix__mod_a869c72bec5850343289680a09254d847}\label{namespacematrix__mod_a869c72bec5850343289680a09254d847}} 
\index{matrix\_mod@{matrix\_mod}!getsqrtdetposdefmat@{getsqrtdetposdefmat}}
\index{getsqrtdetposdefmat@{getsqrtdetposdefmat}!matrix\_mod@{matrix\_mod}}
\doxysubsubsection{\texorpdfstring{getsqrtdetposdefmat()}{getsqrtdetposdefmat()}}
{\footnotesize\ttfamily real(rk) function matrix\+\_\+mod\+::getsqrtdetposdefmat (\begin{DoxyParamCaption}\item[{integer(ik), intent(in)}]{nd,  }\item[{real(rk), dimension(nd,nd), intent(in)}]{Pos\+Def\+Mat }\end{DoxyParamCaption})}



Return the square root of the determinant of a given positive-\/definite {\ttfamily nd $\ast$ nd} matrix {\ttfamily Pos\+Def\+Mat} using Cholesky factorization. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em nd} & \+: The size of the square matrix -\/ {\ttfamily nd} by {\ttfamily nd}. \\
\hline
\mbox{\texttt{ in}}  & {\em Pos\+Def\+Mat} & \+: The input matrix.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
{\ttfamily sqrt\+Det\+Pos\+Def\+Mat} \+: The square root of the determinant of the matrix.
\end{DoxyReturn}
\begin{DoxyWarning}{Warning}
If the input matrix is not positive definite, then {\ttfamily sqrt\+Det\+Pos\+Def\+Mat = -\/1.\+\_\+\+RK} upon return.
\end{DoxyWarning}
\begin{DoxyAuthor}{Author}
Amir Shahmoradi, Apr 21, 2017, 4\+:10 PM, I\+C\+ES, UT 
\end{DoxyAuthor}


Definition at line 682 of file Matrix\+\_\+mod.\+f90.

\mbox{\Hypertarget{namespacematrix__mod_a4457ce676fff3d9e4089018b06ca00fe}\label{namespacematrix__mod_a4457ce676fff3d9e4089018b06ca00fe}} 
\index{matrix\_mod@{matrix\_mod}!isposdef@{isposdef}}
\index{isposdef@{isposdef}!matrix\_mod@{matrix\_mod}}
\doxysubsubsection{\texorpdfstring{isposdef()}{isposdef()}}
{\footnotesize\ttfamily pure logical function matrix\+\_\+mod\+::isposdef (\begin{DoxyParamCaption}\item[{integer(ik), intent(in)}]{nd,  }\item[{real(rk), dimension(nd,nd), intent(in)}]{Matrix }\end{DoxyParamCaption})}



Return {\ttfamily .false.} value for {\ttfamily is\+Pos\+Def}, if the Cholesky decomposition of the input matrix fails (i.\+e. matrix is not positive definite), otherwise return {\ttfamily .true.}. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em nd} & \+: The size of the square matrix -\/ {\ttfamily nd} by {\ttfamily nd}. \\
\hline
\mbox{\texttt{ in,out}}  & {\em Matrix} & \+: The input matrix. Note that only the upper triangle of the matrix is used.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
{\ttfamily is\+Pos\+Def} \+: A logical value indicating whether the input matrix is positive-\/definite.
\end{DoxyReturn}
\begin{DoxyWarning}{Warning}
Do not call this routine when {\ttfamily nd = 1}. In such a case, if {\ttfamily Matrix(1,1) $<$= 0}, then the matrix is not positive-\/definite.
\end{DoxyWarning}
\begin{DoxyAuthor}{Author}
Amir Shahmoradi, Apr 21, 2017, 4\+:10 PM, I\+C\+ES, UT 
\end{DoxyAuthor}


Definition at line 762 of file Matrix\+\_\+mod.\+f90.

\mbox{\Hypertarget{namespacematrix__mod_aff8808812389fce984da322f8c2c07f0}\label{namespacematrix__mod_aff8808812389fce984da322f8c2c07f0}} 
\index{matrix\_mod@{matrix\_mod}!multiplymatrix@{multiplymatrix}}
\index{multiplymatrix@{multiplymatrix}!matrix\_mod@{matrix\_mod}}
\doxysubsubsection{\texorpdfstring{multiplymatrix()}{multiplymatrix()}}
{\footnotesize\ttfamily subroutine matrix\+\_\+mod\+::multiplymatrix (\begin{DoxyParamCaption}\item[{real(rk), dimension(rowsa,colsa), intent(in)}]{A,  }\item[{integer(ik), intent(in)}]{rowsA,  }\item[{integer(ik), intent(in)}]{colsA,  }\item[{real(rk), dimension(rowsb,colsb), intent(in)}]{B,  }\item[{integer(ik), intent(in)}]{rowsB,  }\item[{integer(ik), intent(in)}]{colsB,  }\item[{real(rk), dimension(rowsa,colsb), intent(out)}]{C }\end{DoxyParamCaption})}



Return the product of two matrices. The product of two matrices is defined by {\ttfamily c(i,j) = a(i,1)$\ast$b(1,j) + a(i,2)$\ast$b(2,j) + ... + a(i,n)$\ast$b(n,j)}. 

\begin{DoxyRemark}{Remarks}
There is not reason to use this routine as the Fortran intrinsic already provides an optimized implementation of matrix multiplication via {\ttfamily matmul()}. It is present here only for archival and legacy reasons.
\end{DoxyRemark}
\begin{DoxyAuthor}{Author}
Amir Shahmoradi, Oct 20, 2009, 10\+:56 PM, M\+TU 
\end{DoxyAuthor}


Definition at line 596 of file Matrix\+\_\+mod.\+f90.

\mbox{\Hypertarget{namespacematrix__mod_a393c400caa093b0ac68a0ff1cb0fd897}\label{namespacematrix__mod_a393c400caa093b0ac68a0ff1cb0fd897}} 
\index{matrix\_mod@{matrix\_mod}!solvelinearposdefsystem@{solvelinearposdefsystem}}
\index{solvelinearposdefsystem@{solvelinearposdefsystem}!matrix\_mod@{matrix\_mod}}
\doxysubsubsection{\texorpdfstring{solvelinearposdefsystem()}{solvelinearposdefsystem()}}
{\footnotesize\ttfamily subroutine matrix\+\_\+mod\+::solvelinearposdefsystem (\begin{DoxyParamCaption}\item[{integer(ik), intent(in)}]{nd,  }\item[{real(rk), dimension(nd,nd), intent(in)}]{Pos\+Def\+Mat,  }\item[{real(rk), dimension(nd), intent(in)}]{Diagonal,  }\item[{real(rk), dimension(nd), intent(in)}]{Intercept,  }\item[{real(rk), dimension(nd), intent(inout)}]{Input\+Solution }\end{DoxyParamCaption})}



Solve the linear equation system of the form\+: $ \texttt{PosDefMat} \times \texttt{InputSolution} = \texttt{Intercept} $. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em nd} & \+: The size of the input square matrix -\/ {\ttfamily nd} by {\ttfamily nd}. \\
\hline
\mbox{\texttt{ in}}  & {\em Pos\+Def\+Mat} & \+: The input square matrix. \\
\hline
\mbox{\texttt{ in}}  & {\em Diagonal} & \+: The Diagonal elements of the Cholesky factorization. \\
\hline
\mbox{\texttt{ in}}  & {\em Intercept} & \+: The intercept. \\
\hline
\mbox{\texttt{ in,out}}  & {\em Input\+Solution} & \+: The input right-\/hand-\/side which becomes the solution on return.\\
\hline
\end{DoxyParams}
\begin{DoxyRemark}{Remarks}
{\ttfamily Pos\+Def\+Mat} and {\ttfamily Diagonal} are the output of subroutine \mbox{\hyperlink{namespacematrix__mod_a36785a7834c11cfd985f34441c06af66}{get\+Cholesky\+Factor}} (i.\+g., only the lower triangle of {\ttfamily Pos\+Def\+Mat} is used). 
\end{DoxyRemark}


Definition at line 143 of file Matrix\+\_\+mod.\+f90.

\mbox{\Hypertarget{namespacematrix__mod_a54dd076c547a8b6e1f81b3244887e874}\label{namespacematrix__mod_a54dd076c547a8b6e1f81b3244887e874}} 
\index{matrix\_mod@{matrix\_mod}!solvelinearsystem@{solvelinearsystem}}
\index{solvelinearsystem@{solvelinearsystem}!matrix\_mod@{matrix\_mod}}
\doxysubsubsection{\texorpdfstring{solvelinearsystem()}{solvelinearsystem()}}
{\footnotesize\ttfamily subroutine matrix\+\_\+mod\+::solvelinearsystem (\begin{DoxyParamCaption}\item[{integer(ik), intent(in)}]{nd,  }\item[{real(rk), dimension(nd,nd), intent(in)}]{LU,  }\item[{integer(ik), dimension(nd), intent(in)}]{Permutation,  }\item[{real(rk), dimension(nd), intent(inout)}]{Input\+Solution }\end{DoxyParamCaption})}



Solve the set of {\ttfamily nd} linear equations {\ttfamily Matrix $\ast$ X = Input\+Solution}. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em nd} & \+: The size of the square matrix and its {\ttfamily LU} decomposition -\/ {\ttfamily nd} by {\ttfamily nd}. \\
\hline
\mbox{\texttt{ in}}  & {\em LU} & \+: The LU factorization of the matrix, determined by the routine \mbox{\hyperlink{namespacematrix__mod_af380500b6eb16435797ee030edfd563a}{get\+LU()}}. \\
\hline
\mbox{\texttt{ in}}  & {\em Permutation} & \+: The permutation vector returned by \mbox{\hyperlink{namespacematrix__mod_af380500b6eb16435797ee030edfd563a}{get\+LU()}}. \\
\hline
\mbox{\texttt{ in,out}}  & {\em Input\+Solution} & \+: The right-\/hand-\/side vector of length {\ttfamily nd}. On output, it is completely overwritten by the solution to the system.\\
\hline
\end{DoxyParams}
\begin{DoxyRemark}{Remarks}
The input {\ttfamily nd}, {\ttfamily LU}, and {\ttfamily Permutation} parameters are not modified by this routine and, can be left in place for successive calls with different right-\/hand sides {\ttfamily Input\+Solution}.

This routine takes into account the possibility that {\ttfamily Input\+Solution} will begin with many zero elements, and is therefore efficient for matrix inversion.
\end{DoxyRemark}
\begin{DoxyAuthor}{Author}
Amir Shahmoradi, Apr 8, 2017, 1\+:54 PM, M\+TU 
\end{DoxyAuthor}


Definition at line 470 of file Matrix\+\_\+mod.\+f90.

\mbox{\Hypertarget{namespacematrix__mod_a73f946edb5219bbf949954e9c567af3a}\label{namespacematrix__mod_a73f946edb5219bbf949954e9c567af3a}} 
\index{matrix\_mod@{matrix\_mod}!sortposdefmat@{sortposdefmat}}
\index{sortposdefmat@{sortposdefmat}!matrix\_mod@{matrix\_mod}}
\doxysubsubsection{\texorpdfstring{sortposdefmat()}{sortposdefmat()}}
{\footnotesize\ttfamily pure real(rk) function, dimension(rank,rank) matrix\+\_\+mod\+::sortposdefmat (\begin{DoxyParamCaption}\item[{integer(ik), intent(in)}]{rank,  }\item[{real(rk), dimension(rank,rank), intent(in)}]{Pos\+Def\+Mat\+Upper,  }\item[{integer(ik), intent(in)}]{len\+Col\+Indx,  }\item[{integer(ik), dimension(lencolindx), intent(in)}]{Col\+Indx,  }\item[{integer(ik), dimension(lencolindx), intent(in)}]{Col\+Indx\+Map }\end{DoxyParamCaption})}



Return an ordered matrix of the input matrix by rearranging the columns corresponding to {\ttfamily Col\+Indx} to into the corresponding columns in {\ttfamily Col\+Indx\+Map}, while keeping the rest of the matrix structure intact, such that if it is positive-\/definite, it remains positive-\/definite. For example,. 


\begin{DoxyCode}{0}
\DoxyCodeLine{11.0    12.0    13.0    14.0    15.0}
\DoxyCodeLine{ 0.0    22.0    23.0    24.0    25.0}
\DoxyCodeLine{ 0.0     0.0    33.0    34.0    35.0}
\DoxyCodeLine{ 0.0     0.0     0.0    44.0    45.0}
\DoxyCodeLine{ 0.0 *******     0.0     0.0    55.0}
\end{DoxyCode}


goes to the following by a {\ttfamily Col\+Indx=\mbox{[}4\mbox{]}}, {\ttfamily Col\+Indx\+Map=\mbox{[}5\mbox{]}}, 
\begin{DoxyCode}{0}
\DoxyCodeLine{11.0    12.0    13.0    15.0    14.0}
\DoxyCodeLine{ 0.0    22.0    23.0    25.0    24.0}
\DoxyCodeLine{ 0.0     0.0    33.0    35.0    34.0}
\DoxyCodeLine{ 0.0     0.0     0.0    55.0    45.0}
\DoxyCodeLine{ 0.0     0.0     0.0     0.0    44.0}
\end{DoxyCode}



\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em rank} & \+: The number of columns (or rows) of the input square matrix {\ttfamily Pos\+Def\+Mat\+Upper}. \\
\hline
\mbox{\texttt{ in}}  & {\em Pos\+Def\+Mat\+Upper} & \+: The input matrix. \\
\hline
\mbox{\texttt{ in}}  & {\em len\+Col\+Indx} & \+: The length of the input {\ttfamily Col\+Indx} vector. \\
\hline
\mbox{\texttt{ in}}  & {\em Col\+Indx} & \+: An input array of indices indicating the order by which the columns in the input matrix must be rearranged. \\
\hline
\mbox{\texttt{ in}}  & {\em Col\+Indx\+Map} & \+: An input array of length {\ttfamily len\+Col\+Indxs} that indicated the new column index of the corresponding column indices in {\ttfamily Col\+Indx}.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
{\ttfamily Sorted\+Pos\+Def\+Mat\+Upper} \+: An ordered matrix of size {\ttfamily ( rank, rank )}.
\end{DoxyReturn}
\begin{DoxyAuthor}{Author}
Amir Shahmoradi, Apr 21, 2017, 4\+:10 PM, I\+C\+ES, UT 
\end{DoxyAuthor}


Definition at line 852 of file Matrix\+\_\+mod.\+f90.

\mbox{\Hypertarget{namespacematrix__mod_aaa2f76d9a5c874ca4fbb4a949dd1ff11}\label{namespacematrix__mod_aaa2f76d9a5c874ca4fbb4a949dd1ff11}} 
\index{matrix\_mod@{matrix\_mod}!symmetrizeuppersquarematrix@{symmetrizeuppersquarematrix}}
\index{symmetrizeuppersquarematrix@{symmetrizeuppersquarematrix}!matrix\_mod@{matrix\_mod}}
\doxysubsubsection{\texorpdfstring{symmetrizeuppersquarematrix()}{symmetrizeuppersquarematrix()}}
{\footnotesize\ttfamily pure subroutine matrix\+\_\+mod\+::symmetrizeuppersquarematrix (\begin{DoxyParamCaption}\item[{integer(ik), intent(in)}]{nd,  }\item[{real(rk), dimension(nd,nd), intent(inout)}]{Upper\+Square\+Matrix }\end{DoxyParamCaption})}



Symmetrize an input upper-\/triangular matrix by copying the upper to the lower triangle. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em nd} & \+: The size of the input matrix {\ttfamily Pos\+Def\+Mat\+Upper}. \\
\hline
\mbox{\texttt{ in,out}}  & {\em Upper\+Square\+Matrix} & \+: The input upper, and output full matrix. On output, the matrix is symmetrized.\\
\hline
\end{DoxyParams}
\begin{DoxyAuthor}{Author}
Amir Shahmoradi, Apr 21, 2017, 4\+:10 PM, I\+C\+ES, UT 
\end{DoxyAuthor}


Definition at line 896 of file Matrix\+\_\+mod.\+f90.



\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{namespacematrix__mod_a88f13a51a9eadeda90dcade7949a6b8b}\label{namespacematrix__mod_a88f13a51a9eadeda90dcade7949a6b8b}} 
\index{matrix\_mod@{matrix\_mod}!module\_name@{module\_name}}
\index{module\_name@{module\_name}!matrix\_mod@{matrix\_mod}}
\doxysubsubsection{\texorpdfstring{module\_name}{module\_name}}
{\footnotesize\ttfamily character($\ast$), parameter matrix\+\_\+mod\+::module\+\_\+name = \char`\"{}@Matrix\+\_\+mod\char`\"{}}



Definition at line 50 of file Matrix\+\_\+mod.\+f90.

