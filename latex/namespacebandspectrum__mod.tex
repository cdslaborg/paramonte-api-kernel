\hypertarget{namespacebandspectrum__mod}{}\doxysection{bandspectrum\+\_\+mod Module Reference}
\label{namespacebandspectrum__mod}\index{bandspectrum\_mod@{bandspectrum\_mod}}


This module contains the procedures for computing the various Band Spectrum properties of G\+R\+Bs. See Eqn. A6 of \href{https://www.cdslab.org/pubs/2015_Shahmoradi_I.pdf}{\texttt{ Shahmoradi and Nemiroff, 2015, M\+N\+R\+AS, 451\+:4645-\/4662}}.  


\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
pure real(rk) function \mbox{\hyperlink{namespacebandspectrum__mod_a72b64605c7495f257a19a2c48006f6d6}{getebreak}} (epk, alpha, beta)
\begin{DoxyCompactList}\small\item\em Return {\ttfamily epk$\ast$(alpha-\/beta)/(alpha+2)}, which is the normalization factor in the exponent of the first component of the Band model. \end{DoxyCompactList}\item 
pure subroutine \mbox{\hyperlink{namespacebandspectrum__mod_a5a8d7bb9f2f6bb5af3b381437f840ee0}{getbandparam}} (epk, alpha, beta, ebrk, coef, alpha\+Plus\+Two)
\begin{DoxyCompactList}\small\item\em Compute the break energy {\ttfamily ebrk} of the Band model, as well as the coefficient by which the high energy component of the Band model must be multiplied in order to get a smooth function (assuming the normalization coefficient of the lower energy component is unity). \end{DoxyCompactList}\item 
pure real(rk) function \mbox{\hyperlink{namespacebandspectrum__mod_aa8f4ef1b8ec4a0cf208d5f96f5709311}{getphotonflux}} (energy, epk, alpha, beta, ebrk, coef, alpha\+Plus\+Two)
\begin{DoxyCompactList}\small\item\em Compute the differential photon flux according to the Band differential spectrum at the given input {\ttfamily energy} value. \end{DoxyCompactList}\item 
pure real(rk) function \mbox{\hyperlink{namespacebandspectrum__mod_aaba1737b69a7b15b4adb923f975a5a1e}{getphotonfluxlower}} (energy, alpha, alpha\+Plus\+Two\+Over\+Epk)
\begin{DoxyCompactList}\small\item\em Compute the differential photon flux according to the lower component of the Band spectrum at the given input {\ttfamily energy} value. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacebandspectrum__mod_a47615db63c34be04069b7d8f8a753b5f}{getphotonfluencefromenergyfluence}} (energy\+Fluence, lower\+Lim, upper\+Lim, epk, alpha, beta, tolerance, photon\+Fluence, Err, lower\+Lim\+New, upper\+Lim\+New)
\begin{DoxyCompactList}\small\item\em Convert an {\bfseries{input energy fluence}} in {\ttfamily \mbox{[}lower\+Lim, upper\+Lim\mbox{]}} energy window, all in units of keV (or A\+LL in some other units), {\bfseries{to photon fluence}}, within the same energy range, or if {\ttfamily \mbox{[}lower\+Lim\+New, upper\+Lim\+New\mbox{]}} is provided, then in that range. The input {\ttfamily tolerance} is passed to integrators as a measure of the desired accuracy for the computation of {\ttfamily photon\+Fluence}. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
character($\ast$), parameter \mbox{\hyperlink{namespacebandspectrum__mod_ad94e59bb9883d6a1147fdf1981c331fd}{module\+\_\+name}} = \char`\"{}@Band\+Spectrum\+\_\+mod\char`\"{}
\item 
real(rk), parameter \mbox{\hyperlink{namespacebandspectrum__mod_a9faee13d16d0bc8a08e98f1cd62a029d}{amplitude\+\_\+default}} = 1.\+\_\+\+RK
\item 
real(rk), parameter \mbox{\hyperlink{namespacebandspectrum__mod_a888ed586b66fa684f7cdb13962feed89}{alpha\+\_\+default}} = -\/1.\+1\+\_\+\+RK
\item 
real(rk), parameter \mbox{\hyperlink{namespacebandspectrum__mod_a459c91c73f9a6d2d5f5f2c73a9ce7263}{beta\+\_\+default}} = -\/2.\+3\+\_\+\+RK
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
This module contains the procedures for computing the various Band Spectrum properties of G\+R\+Bs. See Eqn. A6 of \href{https://www.cdslab.org/pubs/2015_Shahmoradi_I.pdf}{\texttt{ Shahmoradi and Nemiroff, 2015, M\+N\+R\+AS, 451\+:4645-\/4662}}. 

\begin{DoxyAuthor}{Author}
Amir Shahmoradi, Tuesday April 30, 2019, 12\+:58 PM, S\+E\+IR, U\+TA 
\end{DoxyAuthor}


\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacebandspectrum__mod_a5a8d7bb9f2f6bb5af3b381437f840ee0}\label{namespacebandspectrum__mod_a5a8d7bb9f2f6bb5af3b381437f840ee0}} 
\index{bandspectrum\_mod@{bandspectrum\_mod}!getbandparam@{getbandparam}}
\index{getbandparam@{getbandparam}!bandspectrum\_mod@{bandspectrum\_mod}}
\doxysubsubsection{\texorpdfstring{getbandparam()}{getbandparam()}}
{\footnotesize\ttfamily pure subroutine bandspectrum\+\_\+mod\+::getbandparam (\begin{DoxyParamCaption}\item[{real(rk), intent(in)}]{epk,  }\item[{real(rk), intent(in)}]{alpha,  }\item[{real(rk), intent(in)}]{beta,  }\item[{real(rk), intent(out)}]{ebrk,  }\item[{real(rk), intent(out)}]{coef,  }\item[{real(rk), intent(out)}]{alpha\+Plus\+Two }\end{DoxyParamCaption})}



Compute the break energy {\ttfamily ebrk} of the Band model, as well as the coefficient by which the high energy component of the Band model must be multiplied in order to get a smooth function (assuming the normalization coefficient of the lower energy component is unity). 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em epk} & \+: The spectral peak energy in units of \mbox{[}keV\mbox{]}. \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & \+: The lower spectral exponent of the Band model. \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & \+: The upper spectral exponent of the Band model. \\
\hline
\mbox{\texttt{ out}}  & {\em ebrk} & \+: The spectral break energy in units of \mbox{[}keV\mbox{]}. \\
\hline
\mbox{\texttt{ out}}  & {\em coef} & \+: The spectral continuity coefficient. \\
\hline
\mbox{\texttt{ out}}  & {\em alpha\+Plus\+Two} & \+: The lower spectral exponent of the Band model plus two. \\
\hline
\end{DoxyParams}


Definition at line 138 of file Band\+Spectrum\+\_\+mod.\+f90.

\mbox{\Hypertarget{namespacebandspectrum__mod_a72b64605c7495f257a19a2c48006f6d6}\label{namespacebandspectrum__mod_a72b64605c7495f257a19a2c48006f6d6}} 
\index{bandspectrum\_mod@{bandspectrum\_mod}!getebreak@{getebreak}}
\index{getebreak@{getebreak}!bandspectrum\_mod@{bandspectrum\_mod}}
\doxysubsubsection{\texorpdfstring{getebreak()}{getebreak()}}
{\footnotesize\ttfamily pure real(rk) function bandspectrum\+\_\+mod\+::getebreak (\begin{DoxyParamCaption}\item[{real(rk), intent(in)}]{epk,  }\item[{real(rk), intent(in), optional}]{alpha,  }\item[{real(rk), intent(in), optional}]{beta }\end{DoxyParamCaption})}



Return {\ttfamily epk$\ast$(alpha-\/beta)/(alpha+2)}, which is the normalization factor in the exponent of the first component of the Band model. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em epk} & \+: The spectral peak energy in units of \mbox{[}keV\mbox{]}. \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & \+: The lower spectral exponent of the Band model. \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & \+: The upper spectral exponent of the Band model.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
{\ttfamily ebrk} \+: The spectral break energy in units of \mbox{[}keV\mbox{]}. 
\end{DoxyReturn}


Definition at line 113 of file Band\+Spectrum\+\_\+mod.\+f90.

\mbox{\Hypertarget{namespacebandspectrum__mod_a47615db63c34be04069b7d8f8a753b5f}\label{namespacebandspectrum__mod_a47615db63c34be04069b7d8f8a753b5f}} 
\index{bandspectrum\_mod@{bandspectrum\_mod}!getphotonfluencefromenergyfluence@{getphotonfluencefromenergyfluence}}
\index{getphotonfluencefromenergyfluence@{getphotonfluencefromenergyfluence}!bandspectrum\_mod@{bandspectrum\_mod}}
\doxysubsubsection{\texorpdfstring{getphotonfluencefromenergyfluence()}{getphotonfluencefromenergyfluence()}}
{\footnotesize\ttfamily subroutine bandspectrum\+\_\+mod\+::getphotonfluencefromenergyfluence (\begin{DoxyParamCaption}\item[{real(rk), intent(in)}]{energy\+Fluence,  }\item[{real(rk), intent(in)}]{lower\+Lim,  }\item[{real(rk), intent(in)}]{upper\+Lim,  }\item[{real(rk), intent(in)}]{epk,  }\item[{real(rk), intent(in)}]{alpha,  }\item[{real(rk), intent(in)}]{beta,  }\item[{real(rk), intent(in)}]{tolerance,  }\item[{real(rk), intent(out)}]{photon\+Fluence,  }\item[{type(\mbox{\hyperlink{structerr__mod_1_1err__type}{err\+\_\+type}}), intent(out)}]{Err,  }\item[{real(rk), intent(in), optional}]{lower\+Lim\+New,  }\item[{real(rk), intent(in), optional}]{upper\+Lim\+New }\end{DoxyParamCaption})}



Convert an {\bfseries{input energy fluence}} in {\ttfamily \mbox{[}lower\+Lim, upper\+Lim\mbox{]}} energy window, all in units of keV (or A\+LL in some other units), {\bfseries{to photon fluence}}, within the same energy range, or if {\ttfamily \mbox{[}lower\+Lim\+New, upper\+Lim\+New\mbox{]}} is provided, then in that range. The input {\ttfamily tolerance} is passed to integrators as a measure of the desired accuracy for the computation of {\ttfamily photon\+Fluence}. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em energy\+Fluence} & \+: The input energy fluence (in units of \mbox{[}keV\mbox{]}) to be converted to the output photon fluence. \\
\hline
\mbox{\texttt{ in}}  & {\em lower\+Lim} & \+: The lower limit energy (in units of \mbox{[}keV\mbox{]}) of the integration. \\
\hline
\mbox{\texttt{ in}}  & {\em upper\+Lim} & \+: The upper limit energy (in units of \mbox{[}keV\mbox{]}) of the integration. \\
\hline
\mbox{\texttt{ in}}  & {\em epk} & \+: The spectral peak energy in units of \mbox{[}keV\mbox{]}. \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & \+: The lower spectral exponent of the Band model. \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & \+: The upper spectral exponent of the Band model. \\
\hline
\mbox{\texttt{ in}}  & {\em tolerance} & \+: The relative accuracy tolerance of the integration. \\
\hline
\mbox{\texttt{ out}}  & {\em photon\+Fluence} & \+: The output fluence in units of photon counts. \\
\hline
\mbox{\texttt{ out}}  & {\em Err} & \+: An object of class \mbox{\hyperlink{structerr__mod_1_1err__type}{Err\+\_\+type}} containing error-\/handling information. \\
\hline
\mbox{\texttt{ in}}  & {\em lower\+Lim\+New} & \+: The lower limit of energy windows (in keV) to be used for the computation of {\ttfamily photon\+Fluence} ({\bfseries{optional}}). \\
\hline
\mbox{\texttt{ in}}  & {\em upper\+Lim\+New} & \+: The upper limit of energy windows (in keV) to be used for the computation of {\ttfamily photon\+Fluence} ({\bfseries{optional}}).\\
\hline
\end{DoxyParams}
\begin{DoxyRemark}{Remarks}
If the optional {\ttfamily \mbox{[}lower\+Lim\+New, upper\+Lim\+New\mbox{]}} are provided, each will replace the corresponding input {\ttfamily \mbox{[}lower\+Lim, upper\+Lim\mbox{]}} in the computation of the output {\ttfamily photon\+Fluence}. 
\end{DoxyRemark}


Definition at line 511 of file Band\+Spectrum\+\_\+mod.\+f90.

\mbox{\Hypertarget{namespacebandspectrum__mod_aa8f4ef1b8ec4a0cf208d5f96f5709311}\label{namespacebandspectrum__mod_aa8f4ef1b8ec4a0cf208d5f96f5709311}} 
\index{bandspectrum\_mod@{bandspectrum\_mod}!getphotonflux@{getphotonflux}}
\index{getphotonflux@{getphotonflux}!bandspectrum\_mod@{bandspectrum\_mod}}
\doxysubsubsection{\texorpdfstring{getphotonflux()}{getphotonflux()}}
{\footnotesize\ttfamily pure real(rk) function bandspectrum\+\_\+mod\+::getphotonflux (\begin{DoxyParamCaption}\item[{real(rk), intent(in)}]{energy,  }\item[{real(rk), intent(in)}]{epk,  }\item[{real(rk), intent(in)}]{alpha,  }\item[{real(rk), intent(in)}]{beta,  }\item[{real(rk), intent(in)}]{ebrk,  }\item[{real(rk), intent(in)}]{coef,  }\item[{real(rk), intent(in)}]{alpha\+Plus\+Two }\end{DoxyParamCaption})}



Compute the differential photon flux according to the Band differential spectrum at the given input {\ttfamily energy} value. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em energy} & \+: The energy (in units of \mbox{[}keV\mbox{]}) at which the differential photon flux must be computed. \\
\hline
\mbox{\texttt{ in}}  & {\em epk} & \+: The spectral peak energy in units of \mbox{[}keV\mbox{]}. \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & \+: The lower spectral exponent of the Band model. \\
\hline
\mbox{\texttt{ in}}  & {\em beta} & \+: The upper spectral exponent of the Band model. \\
\hline
\mbox{\texttt{ in}}  & {\em ebrk} & \+: The spectral break energy in units of \mbox{[}keV\mbox{]}. \\
\hline
\mbox{\texttt{ in}}  & {\em coef} & \+: The spectral continuity coefficient. \\
\hline
\mbox{\texttt{ in}}  & {\em alpha\+Plus\+Two} & \+: The lower spectral exponent of the Band model plus two.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
{\ttfamily photon\+Flux} \+: The energy flux in units of photon counts.
\end{DoxyReturn}
\begin{DoxyWarning}{Warning}
A negative huge output value is used to signal error has occurred. Under normal conditions, the output is always positive.

The input energy values {\ttfamily energy}, {\ttfamily epk}, {\ttfamily ebrk}, must all have the same units. It is expected that the input energy is in units of keV, although it does not affect the accuracy of the results. 
\end{DoxyWarning}


Definition at line 175 of file Band\+Spectrum\+\_\+mod.\+f90.

\mbox{\Hypertarget{namespacebandspectrum__mod_aaba1737b69a7b15b4adb923f975a5a1e}\label{namespacebandspectrum__mod_aaba1737b69a7b15b4adb923f975a5a1e}} 
\index{bandspectrum\_mod@{bandspectrum\_mod}!getphotonfluxlower@{getphotonfluxlower}}
\index{getphotonfluxlower@{getphotonfluxlower}!bandspectrum\_mod@{bandspectrum\_mod}}
\doxysubsubsection{\texorpdfstring{getphotonfluxlower()}{getphotonfluxlower()}}
{\footnotesize\ttfamily pure real(rk) function bandspectrum\+\_\+mod\+::getphotonfluxlower (\begin{DoxyParamCaption}\item[{real(rk), intent(in)}]{energy,  }\item[{real(rk), intent(in)}]{alpha,  }\item[{real(rk), intent(in)}]{alpha\+Plus\+Two\+Over\+Epk }\end{DoxyParamCaption})}



Compute the differential photon flux according to the lower component of the Band spectrum at the given input {\ttfamily energy} value. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em energy} & \+: The energy (in units of \mbox{[}keV\mbox{]}) at which the differential photon flux must be computed. \\
\hline
\mbox{\texttt{ in}}  & {\em alpha} & \+: The lower spectral exponent of the Band model. \\
\hline
\mbox{\texttt{ in}}  & {\em alpha\+Plus\+Two\+Over\+Epk} & \+: The lower spectral exponent of the Band model plus two.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
{\ttfamily photon\+Flux\+Lower} \+: The energy flux in units of photon counts.
\end{DoxyReturn}
\begin{DoxyWarning}{Warning}
The input {\ttfamily energy} values must be less than {\ttfamily ebrk}. 
\end{DoxyWarning}


Definition at line 210 of file Band\+Spectrum\+\_\+mod.\+f90.



\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{namespacebandspectrum__mod_a888ed586b66fa684f7cdb13962feed89}\label{namespacebandspectrum__mod_a888ed586b66fa684f7cdb13962feed89}} 
\index{bandspectrum\_mod@{bandspectrum\_mod}!alpha\_default@{alpha\_default}}
\index{alpha\_default@{alpha\_default}!bandspectrum\_mod@{bandspectrum\_mod}}
\doxysubsubsection{\texorpdfstring{alpha\_default}{alpha\_default}}
{\footnotesize\ttfamily real(rk), parameter bandspectrum\+\_\+mod\+::alpha\+\_\+default = -\/1.\+1\+\_\+\+RK}



Definition at line 59 of file Band\+Spectrum\+\_\+mod.\+f90.

\mbox{\Hypertarget{namespacebandspectrum__mod_a9faee13d16d0bc8a08e98f1cd62a029d}\label{namespacebandspectrum__mod_a9faee13d16d0bc8a08e98f1cd62a029d}} 
\index{bandspectrum\_mod@{bandspectrum\_mod}!amplitude\_default@{amplitude\_default}}
\index{amplitude\_default@{amplitude\_default}!bandspectrum\_mod@{bandspectrum\_mod}}
\doxysubsubsection{\texorpdfstring{amplitude\_default}{amplitude\_default}}
{\footnotesize\ttfamily real(rk), parameter bandspectrum\+\_\+mod\+::amplitude\+\_\+default = 1.\+\_\+\+RK}



Definition at line 58 of file Band\+Spectrum\+\_\+mod.\+f90.

\mbox{\Hypertarget{namespacebandspectrum__mod_a459c91c73f9a6d2d5f5f2c73a9ce7263}\label{namespacebandspectrum__mod_a459c91c73f9a6d2d5f5f2c73a9ce7263}} 
\index{bandspectrum\_mod@{bandspectrum\_mod}!beta\_default@{beta\_default}}
\index{beta\_default@{beta\_default}!bandspectrum\_mod@{bandspectrum\_mod}}
\doxysubsubsection{\texorpdfstring{beta\_default}{beta\_default}}
{\footnotesize\ttfamily real(rk), parameter bandspectrum\+\_\+mod\+::beta\+\_\+default = -\/2.\+3\+\_\+\+RK}



Definition at line 60 of file Band\+Spectrum\+\_\+mod.\+f90.

\mbox{\Hypertarget{namespacebandspectrum__mod_ad94e59bb9883d6a1147fdf1981c331fd}\label{namespacebandspectrum__mod_ad94e59bb9883d6a1147fdf1981c331fd}} 
\index{bandspectrum\_mod@{bandspectrum\_mod}!module\_name@{module\_name}}
\index{module\_name@{module\_name}!bandspectrum\_mod@{bandspectrum\_mod}}
\doxysubsubsection{\texorpdfstring{module\_name}{module\_name}}
{\footnotesize\ttfamily character($\ast$), parameter bandspectrum\+\_\+mod\+::module\+\_\+name = \char`\"{}@Band\+Spectrum\+\_\+mod\char`\"{}}



Definition at line 56 of file Band\+Spectrum\+\_\+mod.\+f90.

